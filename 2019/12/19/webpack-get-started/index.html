<!doctype html><html lang=zh><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Webpack4不求人系列(1)</title>
<meta charset=utf-8><meta content="Web开发 ,Java ,Go ,Node.js ,PHP ,Koa ,MySQL ,Redis ,前端 ,后端 ,数据库" name=keywords><meta name=description content="Webpack是一个现在Javascript应用程序的模块化打包器，在Webpack中JS/CSS/图片等资源都被视为JS模块，简化了编程。当Webpack构建时，会递归形成一个模块依赖关系图，然后将所有的模块打包为一个或多个bundle。
本文内容
简介 常用loader && plugin 传统网站的webpack配置 简介 要系统地学习Webpack，需要先了解Webpack的四个核心概念:"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/2019/12/19/webpack-get-started/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com//index.xml title=每天进步一点点><script async defer data-website-id=52f8f0f9-d93d-466b-8ef5-508aae8c4ed4 src=https://analysis.ddhigh.com/script.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EC3XLVSGKV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EC3XLVSGKV")</script><meta property="og:title" content="Webpack4不求人系列(1)"><meta property="og:description" content="Webpack是一个现在Javascript应用程序的模块化打包器，在Webpack中JS/CSS/图片等资源都被视为JS模块，简化了编程。当Webpack构建时，会递归形成一个模块依赖关系图，然后将所有的模块打包为一个或多个bundle。
本文内容
简介 常用loader && plugin 传统网站的webpack配置 简介 要系统地学习Webpack，需要先了解Webpack的四个核心概念:"><meta property="og:type" content="article"><meta property="og:url" content="https://www.ddhigh.com/2019/12/19/webpack-get-started/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-12-19T12:00:00+00:00"><meta property="article:modified_time" content="2019-12-19T12:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Webpack4不求人系列(1)"><meta name=twitter:description content="Webpack是一个现在Javascript应用程序的模块化打包器，在Webpack中JS/CSS/图片等资源都被视为JS模块，简化了编程。当Webpack构建时，会递归形成一个模块依赖关系图，然后将所有的模块打包为一个或多个bundle。
本文内容
简介 常用loader && plugin 传统网站的webpack配置 简介 要系统地学习Webpack，需要先了解Webpack的四个核心概念:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.ddhigh.com/posts/"},{"@type":"ListItem","position":2,"name":"Webpack4不求人系列(1)","item":"https://www.ddhigh.com/2019/12/19/webpack-get-started/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Webpack4不求人系列(1)","name":"Webpack4不求人系列(1)","description":"Webpack是一个现在Javascript应用程序的模块化打包器，在Webpack中JS/CSS/图片等资源都被视为JS模块，简化了编程。当Webpack构建时，会递归形成一个模块依赖关系图，然后将所有的模块打包为一个或多个bundle。\n本文内容\n简介 常用loader \u0026amp;\u0026amp; plugin 传统网站的webpack配置 简介 要系统地学习Webpack，需要先了解Webpack的四个核心概念:","keywords":["webpack"],"articleBody":" Webpack是一个现在Javascript应用程序的模块化打包器，在Webpack中JS/CSS/图片等资源都被视为JS模块，简化了编程。当Webpack构建时，会递归形成一个模块依赖关系图，然后将所有的模块打包为一个或多个bundle。\n本文内容\n简介 常用loader \u0026\u0026 plugin 传统网站的webpack配置 简介 要系统地学习Webpack，需要先了解Webpack的四个核心概念:\n入口(entry) 输出(output) loader plugin webpack使用Node.js运行，因此所有的Node.js模块都可以使用，比如文件系统、路径等模块。\n对Node.js基础不太了解的读者，可以参考我的Node.js系列\n配置文件webpack.config.js的一般格式为:\nconst path = require('path'); // 导入Node.js的path模块 module.exports = { mode: 'development', // 工作模式 entry: './src/index', // 入口点 output: { // 输出配置 path: path.resolve(__dirname, 'dist'), // 输出文件的目录 filename: 'scripts/[name].[hash:8].js', // 输出JS模块的配置 chunkFilename:'scripts/[name].[chunkhash:8].js', // 公共JS配置 publicPath:'/' // 资源路径前缀，一般会使用CDN地址，这样图片和CSS就会使用CDN的绝对URL }, module:{ rules: [ { test:/\\.(png|gif|jpg)$/, // 图片文件 use:[ { loader:'file-loader', // 使用file-loader加载 options:{ // file-loader使用的加载选项 name:'images/[name].[hash:8].[ext]' // 图片文件打包后的输出路径配置 } } ] } ] }, plugins:[ // 插件配置 new CleanWebpackPlugin() ] }; Webpack自己只管JS模块的输出，也就是output.filename是JS的配置，CSS、图片这些是通过loader来处理输出的\n入口 入口指明了Webpack从哪个模块开始进行构建，Webpack会分析入口模块依赖到的模块(直接或间接)，最终输出到一个被称为bundle的文件中。\n使用entry来配置项目入口。\n单一入口\n最终只会生成1个js文件\nmodule.exports = { entry: './src/index', }; 多个入口\n最终会根据入口数量生成对应的js文件\nmodule.exports = { entry:{ home:'./src/home/index', // 首页JS about:'./src/about/index' // 关于页JS } }; 多个入口一般会在多页面应用中使用，比如传统的新闻网站。\n输出 输出指明了Webpack将bundle输出到哪个目录，以及这些bundle如何命名等，默认的目录为./dist。\nmodule.exports = { output:{ path:path.resolve(__dirname, 'dist'), // 输出路径 filename:'scripts/[name].[hash:8].js', // 输出JS模块的文件名规范 chunkFilename:'scripts/[name].[chunkhash:8].js', // 公共JS的配置 publicPath:'/', // 资源路径前缀，一般会使用CDN地址，这样图片和CSS就会使用CDN的绝对URL } }; path\npath是打包后bundle的输出目录，必须使用绝对路径。所有类型的模块(js/css/图片等)都会输出到该目录中，当然，我们可以通过配置输出模块的名称规则来输出到path下的子目录。比如上例中最终输出的JS目录如下：\n|----dist |---- scripts |---- home.aaaaaaaa.js filename\n入口模块输出的命名规则，在Webpack中，只有js是亲儿子，可以直接被Webpack处理，其他类型的文件(css/images等)需要通过loader来进行转换。\nfilename的常用的命名如下:\n[name].[hash].js [name] 为定义入口模块的名称，比如定义了home的入口点，这里的name最终就是home [hash] 是模块内容的MD5值，一次打包过程中所有模块的hash值是相同的，由于浏览器会按照文件名缓存，因此每次打包都需要指定hash来改变文件名，从而清除缓存。 chunkFilename\n非入口模块输出的命名规则，一般是代码中引入其他依赖，同时使用了optimization.splitChunks配置会抽取该类型的chunk\nhash\nWebpack中常见的hash有hash,contenthash,chunkhash，很容易弄混淆，这里说明一下。\nhash 整个项目公用的hash值，不管修改项目的什么文件，该值都会变化 chunkhash 公共代码模块的hash值，只要不改该chunk下的代码，该值不会变化 contenthash 基于文件内容生成的hash，只要改了文件，对应的hash都会变化 publicPath\n资源的路径前缀，打包之后的资源默认情况下都是相对路径，当更改了部署路径或者需要使用CDN地址时，该选项比较常用。\n比如我们把本地编译过程中产生的所有资源都放到一个CDN路径中，可以这么定义：\npublicPath: 'https://static.ddhigh.com/blog/' 那么最终编译的js,css,image等路径都是绝对链接。\nloader loader用来在import时预处理文件，一般用来将非JS模块转换为JS能支持的模块，比如我们直接import一个css文件会提示错误，此时就需要loader做转换了。\n比如我们使用loader来加载css文件。\nmodule.exports = { module:{ rules:[ { test: /\\.(css)$/, use: ['css-loader'] } ] } }; 配置方式 Webpack中有3种使用loader的方式：\n配置式：在webpack.config.js根据文件类型进行配置，这是推荐的配置 内联：在代码中import时指明loader 命令行：通过cli命令行配置 配置式 module.rules用来配置loader。test用来对加载的**文件名(包括目录)**进行正则匹配，只有当匹配时才会应用对应loader。\n多个loader配置时从右向左进行应用\n配置式Webpack的loader也有好几种形式，有些是为了兼容而添加的，主要使用的方式有以下3种。\nmodule.exports = { module:{ rules:[ { test: /\\.less$/, loader:'css-loader!less-loader', // 多个loader中用感叹号分隔 }, { test:/\\.css/, use:['css-loader'],//数组形式 }, { test:/\\.(png|gif|jpg)$/, use:[ // loader传递参数时建议该方法 { loader: 'file-loader', options:{ // file-loader自己的参数，跟webpack无关 name: 'images/[name].[hash:8].js' } } ] } ] } }; 每个loader的options参数不一定相同，这个需要查看对应loader的官方文档。\nPlugin loader一般用来做模块转换，而插件可以执行更多的任务，包括打包优化、压缩、文件拷贝等等。插件的功能非常强大，可以进行各种各样的任务。\n下面是打包之前清空dist目录的插件配置示例。\nconst { CleanWebpackPlugin } = require('clean-webpack-plugin'); module.exports = { plugins: [ new CleanWebpackPlugin(), ] }; 插件也可以传入选项，一般在实例化时进行传入。\nnew MiniCssPlugin({ filename: 'styles/[name].[contenthash:8].css', chunkFilename: 'styles/[name].[contenthash:8].css' }) 提取公共代码 Webpack4中提取公共代码只需要配置optimization.splitChunks即可。\noptimization: { splitChunks: { cacheGroups: { vendor: { // 名为vendor的chunk name: \"vendor\", test: /[\\\\/]node_modules[\\\\/]/, chunks: 'all', priority: 10 }, styles: { // 名为styles的chunk name: 'styles', test: /\\.css$/, chunks: 'all' } } } }, cacheGroups 缓存组 name chunk的名称 test 加载的模块符合该正则时被打包到该chunk chunks 模块的范围，有initial(初始模块),async(按需加载模块),all(全部模块) 上面的例子中将node_modules中的js打包为vendor，以css结尾的打包为styles\n常用的loader和plugin css-loader 加载css文件\n{ test:/\\.css$/ loader:['css-loader'] } less-loader 加载less文件，一般需要配合css-loader\n{ test:/\\.less$/, loader:['css-loader','less-loader'] } file-loader 将文件拷贝到输出文件夹，并返回相对路径。一般常用在加载图片\n{ test:/\\.(png|gif|jpg)/, use:[ { loader:'file-loader', options:{ name:'images/[name].[hash:8].[ext]' } } ] } babel-loader 转换ES2015+代码到ES5\n{ test:/\\.js$/, exclude: /(node_modules|bower_components)/, // 排除指定的模块 use:[ { loader:'babel-loader', options:{ presets:['@babel/preset-env'] } } ] } ts-loader 转换Typescript到Javascript\n{ test:/\\.ts/, loader:'ts-loader' } html-webpack-plugin 简化HTML的创建，该插件会自动将当前打包的资源(如JS、CSS)自动引用到HTML文件\nconst HtmlWebpackPlugin = require('html-webpack-plugin'); module.exports = { plugins:[ new HtmlWebpackPlugin() ] }; clean-webpack-plugin 打包之前清理dist目录\nconst { CleanWebpackPlugin } = require('clean-webpack-plugin'); module.exports = { plugins:[ new CleanWebpackPlugin() ] }; mini-css-extract-plugin 提取、压缩CSS，需要同时配置loader和plugin\nconst MiniCssPlugin = require('mini-css-extract-plugin'); module.exports = { module:{ rules:[ { test: /\\.less$/, use: [MiniCssPlugin.loader, 'css-loader', 'less-loader'] }, { test: /\\.css$/, use: [MiniCssPlugin.loader, 'css-loader'] }, ] }, plugins:[ new MiniCssPlugin({ filename: 'styles/[name].[contenthash:8].css', chunkFilename: 'styles/[name].[contenthash:8].css' }), ] }; 实战 下面使用Webpack来配置一个传统多页面网站开发的示例。\n目录结构 ├── package.json ├── src │ ├── about\t关于页 │ │ ├── index.html │ │ ├── index.js │ │ └── style.less │ ├── common │ │ └── style.less │ └── home\t首页 │ ├── images │ │ └── logo.png │ ├── index.html │ ├── index.js │ └── style.less ├── webpack.config.js 使用到的npm包 \"clean-webpack-plugin\": \"^3.0.0\", \"css-loader\": \"^3.2.1\", \"exports-loader\": \"^0.7.0\", \"extract-text-webpack-plugin\": \"^4.0.0-beta.0\", \"file-loader\": \"^5.0.2\", \"html-webpack-plugin\": \"^3.2.0\", \"html-withimg-loader\": \"^0.1.16\", \"less\": \"^3.10.3\", \"less-loader\": \"^5.0.0\", \"mini-css-extract-plugin\": \"^0.8.0\", \"normalize.css\": \"^8.0.1\", \"script-loader\": \"^0.7.2\", \"style-loader\": \"^1.0.1\", \"url-loader\": \"^3.0.0\", \"webpack\": \"^4.41.2\", \"webpack-cli\": \"^3.3.10\", \"webpack-dev-server\": \"^3.9.0\", \"zepto\": \"^1.2.0\" 配置入口点 由于是传统多页网站，每个页面都需要单独打包一份JS，因此每个页面需要一个入口。\nentry: { // 入口配置，每个页面一个入口JS home: './src/home/index', // 首页 about: './src/about/index' // 关于页 } 配置输出 本例我们不进行CDN部署，因此输出点配置比较简单。\noutput: { // 输出配置 path: path.resolve(__dirname, 'dist'), // 输出资源目录 filename: 'scripts/[name].[hash:8].js', // 入口点JS命名规则 chunkFilename: 'scripts/[name]:[chunkhash:8].js', // 公共模块命名规则 publicPath: '/' // 资源路径前缀 } 配置开发服务器 本地开发时不需要每次都编译完Webpack再访问，通过webpack-dev-server，我们可以边开发变查看效果，文件会实时编译。\ndevServer: { contentBase: './dist', // 开发服务器配置 hot: true // 热加载 }, 配置loader 本例中没有使用ES6进行编程，但是引用了一个非CommonJS的js模块Zepto，传统用法中在HTML页面引入Zepto就会在window下挂载全局对象Zepto。但是在Webpack开发中不建议使用全局变量，否则模块化的优势将受到影响。\n通过使用exports-loader和script-loader，我们可以将Zepto包装为CommonJS模块进入导入。\nmodule: { rules: [ { test: require.resolve('zepto'), loader: 'exports-loader?window.Zepto!script-loader' // 将window.Zepto包装为CommonJS模块 }, { test: /\\.less$/, use: [MiniCssPlugin.loader, 'css-loader', 'less-loader'] }, { test: /\\.css$/, use: [MiniCssPlugin.loader, 'css-loader'] }, { test: /\\.(png|jpg|gif)$/, use: [ { loader: 'file-loader', options: { name: 'images/[name].[hash:8].[ext]' } } ] }, { test: /\\.(htm|html)$/i, loader: 'html-withimg-loader' } ] }, 配置optimization 主要进行公共模块的打包配置。\noptimization: { splitChunks: { cacheGroups: { vendor: { name: \"vendor\", test: /[\\\\/]node_modules[\\\\/]/, chunks: 'all', priority: 10, // 优先级 }, styles: { name: 'styles', test: /\\.css$/, chunks: 'all' } } } }, 配置plugin plugins: [ new CleanWebpackPlugin(), // 清理发布目录 new HtmlWebpackPlugin({ chunks: ['home', 'vendor', 'styles'], // 声明本页面使用到的模块，有主页，公共JS以及公共CSS filename: 'index.html', // 输出路径，这里直接输出到dist的根目录，也就是dist/index.html template: './src/home/index.html', // HTML模板文件路径 minify: { removeComments: true, // 移除注释 collapseWhitespace: true // 合并空格 } }), new HtmlWebpackPlugin({ chunks: ['about', 'vendor', 'styles'], filename: 'about/index.html', // 输出到dist/about/index.html template: './src/about/index.html', minify: { removeComments: true, collapseWhitespace: true } }), new MiniCssPlugin({ filename: 'styles/[name].[contenthash:8].css', chunkFilename: 'styles/[name].[contenthash:8].css' }), new webpack.NamedModulesPlugin(), // 热加载使用 new webpack.HotModuleReplacementPlugin() // 热加载使用 ] 示例代码 部分示例代码如下:\n// src/about/index.js const $ = require('zepto'); require('normalize.css'); require('../common/style.less'); require('./style.less'); $('#about').on('click', function () { alert('点击了about按钮'); }); 和传统的JS有点不太一样，多了一些css的require，前面说过，webpack把所有资源当做JS模块，因此这是推荐的做法。\n\u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003cmeta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"\u003e \u003ctitle\u003e首页\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cul\u003e \u003cli\u003e\u003ca href=\"/\"\u003e首页\u003c/a\u003e\u003c/li\u003e \u003cli\u003e\u003ca href=\"/about\"\u003e关于\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e \u003cdiv class=\"logo\"\u003e\u003c/div\u003e \u003cbutton id=\"home\"\u003e首页按钮\u003c/button\u003e \u003c/body\u003e \u003c/html\u003e 页面中不再需要编写JS。\n注意：html中使用标签导入图片的编译，目前还没有好的解决办法，可以通过css background的形式进行处理\n开发模式 开发模式下直接启用webpack-dev-server即可，会自动加载工作目录下的webpack.config.js\n// package.json \"scripts\": { \"build\": \"webpack\", \"dev\": \"webpack-dev-server\" } npm run dev 生产模式 生产模式下使用webpack编译，编译完成后输出最终文件。\nnpm run build 输出效果 ├── about │ └── index.html ├── images │ └── logo.b15c113a.png ├── index.html ├── scripts │ ├── about.3fb4aa0f.js │ ├── home.3fb4aa0f.js │ └── vendor:ed5b7d31.js └── styles ├── about.71eb65e9.css ├── home.cd2738e6.css └── vendor.9df34e21.css 项目地址 项目已经托管到github，有需要的读者可以自取。\nhttps://github.com/xialeistudio/webpack-multipage-example\n","wordCount":"817","inLanguage":"zh","datePublished":"2019-12-19T12:00:00Z","dateModified":"2019-12-19T12:00:00Z","author":{"@type":"Person","name":"Lei Xia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ddhigh.com/2019/12/19/webpack-get-started/"},"publisher":{"@type":"Organization","name":"每天进步一点点","logo":{"@type":"ImageObject","url":"https://www.ddhigh.com/favicon.ico"}}}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.d0df733b91ef046970ecd63de7aa626886fd263fd3fb2b8ff28b560e505831f7.css integrity="sha256-0N9zO5HvBGlw7NY956piaIb9Jj/T+yuP8otWDlBYMfc=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css integrity="sha512-ygEyjMC6rqnzJqWGjRTJUPYMEs9JUOm3i7OWUS9CgQ4XkBUvMsgCS1I8JqavidQ2ClHcREB7IbA2mN08+r9Elg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>$darkModeInit.Content|safeJS</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>每天进步一点点
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/>首页</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/books>出版物</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>留言板</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li><li class="navigation-item navigation-language"><a href=https://www.ddhigh.com/en/>EN</a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>Webpack4不求人系列(1)</h1></header><p><small>2019年12月19日&nbsp;· 817 字&nbsp;· 4 分钟</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#简介>简介</a><ul><li><a href=#入口>入口</a></li><li><a href=#输出>输出</a></li><li><a href=#loader>loader</a></li><li><a href=#plugin>Plugin</a></li></ul></li><li><a href=#提取公共代码>提取公共代码</a></li><li><a href=#常用的loader和plugin>常用的loader和plugin</a><ul><li><a href=#css-loader>css-loader</a></li><li><a href=#less-loader>less-loader</a></li><li><a href=#file-loader>file-loader</a></li><li><a href=#babel-loader>babel-loader</a></li><li><a href=#ts-loader>ts-loader</a></li><li><a href=#html-webpack-plugin>html-webpack-plugin</a></li><li><a href=#clean-webpack-plugin>clean-webpack-plugin</a></li><li><a href=#mini-css-extract-plugin>mini-css-extract-plugin</a></li></ul></li><li><a href=#实战>实战</a><ul><li><a href=#目录结构>目录结构</a></li><li><a href=#使用到的npm包>使用到的npm包</a></li><li><a href=#配置入口点>配置入口点</a></li><li><a href=#配置输出>配置输出</a></li><li><a href=#配置开发服务器>配置开发服务器</a></li><li><a href=#配置loader>配置loader</a></li><li><a href=#配置optimization>配置optimization</a></li><li><a href=#配置plugin>配置plugin</a></li><li><a href=#示例代码>示例代码</a></li><li><a href=#开发模式>开发模式</a></li><li><a href=#生产模式>生产模式</a></li><li><a href=#输出效果>输出效果</a></li><li><a href=#项目地址>项目地址</a></li></ul></li></ul></nav></div><section class=blog-content><blockquote><p>Webpack是一个现在Javascript应用程序的模块化打包器，在Webpack中JS/CSS/图片等资源都被视为JS模块，简化了编程。当Webpack构建时，会递归形成一个模块依赖关系图，然后将所有的模块打包为一个或多个bundle。</p></blockquote><p><img alt=img src=https://static.ddhigh.com/blog/2019-12-19-024407.jpg></p><p>本文内容</p><ol><li>简介</li><li>常用loader && plugin</li><li>传统网站的webpack配置</li></ol><h2 id=简介>简介</h2><p>要系统地学习Webpack，需要先了解Webpack的四个<strong>核心概念</strong>:</p><ul><li>入口(entry)</li><li>输出(output)</li><li>loader</li><li>plugin</li></ul><p>webpack使用Node.js运行，因此所有的Node.js模块都可以使用，比如文件系统、路径等模块。</p><p>对Node.js基础不太了解的读者，可以参考我的<a href=https://www.ddhigh.com/2019/07/25/nodejs-guide-next-step.html>Node.js系列</a></p><p>配置文件<code>webpack.config.js</code>的一般格式为:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>path</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;path&#39;</span>); <span style=color:#75715e>// 导入Node.js的path模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;development&#39;</span>, <span style=color:#75715e>// 工作模式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/index&#39;</span>, <span style=color:#75715e>// 入口点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 输出配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;dist&#39;</span>), <span style=color:#75715e>// 输出文件的目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;scripts/[name].[hash:8].js&#39;</span>, <span style=color:#75715e>// 输出JS模块的配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>chunkFilename</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;scripts/[name].[chunkhash:8].js&#39;</span>, <span style=color:#75715e>// 公共JS配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>publicPath</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#75715e>// 资源路径前缀，一般会使用CDN地址，这样图片和CSS就会使用CDN的绝对URL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.(png|gif|jpg)$/</span>, <span style=color:#75715e>// 图片文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;file-loader&#39;</span>, <span style=color:#75715e>// 使用file-loader加载
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span>{ <span style=color:#75715e>// file-loader使用的加载选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;images/[name].[hash:8].[ext]&#39;</span> <span style=color:#75715e>// 图片文件打包后的输出路径配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[ <span style=color:#75715e>// 插件配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CleanWebpackPlugin</span>()
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><blockquote><p>Webpack自己只管JS模块的输出，也就是output.filename是JS的配置，CSS、图片这些是通过loader来处理输出的</p></blockquote><h3 id=入口>入口</h3><p>入口指明了Webpack从哪个模块开始进行构建，Webpack会分析入口模块依赖到的模块(直接或间接)，最终输出到一个被称为<em>bundle</em>的文件中。</p><blockquote><p>使用<strong>entry</strong>来配置项目入口。</p></blockquote><p><strong>单一入口</strong></p><p>最终只会生成1个js文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/index&#39;</span>,
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p><strong>多个入口</strong></p><p>最终会根据入口数量生成对应的js文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>  	<span style=color:#a6e22e>home</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;./src/home/index&#39;</span>, <span style=color:#75715e>// 首页JS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>about</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;./src/about/index&#39;</span> <span style=color:#75715e>// 关于页JS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>多个入口一般会在多页面应用中使用，比如传统的新闻网站。</p><h3 id=输出>输出</h3><p>输出指明了Webpack将bundle输出到哪个目录，以及这些bundle如何命名等，默认的目录为<code>./dist</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span><span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;dist&#39;</span>), <span style=color:#75715e>// 输出路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;scripts/[name].[hash:8].js&#39;</span>, <span style=color:#75715e>// 输出JS模块的文件名规范
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>chunkFilename</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;scripts/[name].[chunkhash:8].js&#39;</span>, <span style=color:#75715e>// 公共JS的配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>publicPath</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;/&#39;</span>, <span style=color:#75715e>// 资源路径前缀，一般会使用CDN地址，这样图片和CSS就会使用CDN的绝对URL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p><strong>path</strong></p><p>path是打包后bundle的输出目录，<strong>必须使用绝对路径</strong>。所有类型的模块(js/css/图片等)都会输出到该目录中，当然，我们可以通过配置输出模块的名称规则来输出到path下的子目录。比如上例中最终输出的JS目录如下：</p><pre tabindex=0><code>|----dist
		 |---- scripts
		 			 |---- home.aaaaaaaa.js
</code></pre><p><strong>filename</strong></p><p><strong>入口模块</strong>输出的命名规则，在Webpack中，只有js是亲儿子，可以直接被Webpack处理，其他类型的文件(css/images等)需要通过loader来进行转换。</p><p>filename的常用的命名如下:</p><pre tabindex=0><code>[name].[hash].js
</code></pre><ul><li>[name] 为定义入口模块的名称，比如定义了home的入口点，这里的name最终就是home</li><li>[hash] 是模块内容的MD5值，一次打包过程中所有模块的hash值是相同的，由于浏览器会按照文件名缓存，因此每次打包都需要指定hash来改变文件名，从而清除缓存。</li></ul><p><strong>chunkFilename</strong></p><p><strong>非入口模块</strong>输出的命名规则，一般是代码中引入其他依赖，同时使用了optimization.splitChunks配置会抽取该类型的chunk</p><p><strong>hash</strong></p><p>Webpack中常见的hash有<code>hash</code>,<code>contenthash</code>,<code>chunkhash</code>，很容易弄混淆，这里说明一下。</p><ul><li>hash 整个项目公用的hash值，不管修改项目的什么文件，该值都会变化</li><li>chunkhash 公共代码模块的hash值，只要不改该chunk下的代码，该值不会变化</li><li>contenthash 基于文件内容生成的hash，只要改了文件，对应的hash都会变化</li></ul><p><strong>publicPath</strong></p><p>资源的路径前缀，打包之后的资源默认情况下都是相对路径，当更改了部署路径或者需要使用CDN地址时，该选项比较常用。</p><p>比如我们把本地编译过程中产生的所有资源都放到一个CDN路径中，可以这么定义：</p><pre tabindex=0><code>publicPath: &#39;https://static.ddhigh.com/blog/&#39;
</code></pre><p>那么最终编译的js,css,image等路径都是绝对链接。</p><h3 id=loader>loader</h3><p>loader用来在import时预处理文件，一般用来将非JS模块转换为JS能支持的模块，比如我们直接import一个css文件会提示错误，此时就需要loader做转换了。</p><p>比如我们使用loader来加载css文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.(css)$/</span>,
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;css-loader&#39;</span>]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h4 id=配置方式>配置方式</h4><p>Webpack中有<strong>3</strong>种使用loader的方式：</p><ol><li>配置式：在webpack.config.js根据文件类型进行配置，这是推荐的配置</li><li>内联：在代码中import时指明loader</li><li>命令行：通过cli命令行配置</li></ol><h4 id=配置式>配置式</h4><p><strong>module.rules</strong>用来配置loader。<strong>test</strong>用来对加载的**文件名(包括目录)**进行正则匹配，只有当匹配时才会应用对应loader。</p><blockquote><p>多个loader配置时从右向左进行应用</p></blockquote><p>配置式Webpack的loader也有好几种形式，有些是为了兼容而添加的，主要使用的方式有以下3种。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.less$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;css-loader!less-loader&#39;</span>, <span style=color:#75715e>// 多个loader中用感叹号分隔
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.css/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;css-loader&#39;</span>],<span style=color:#75715e>//数组形式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.(png|gif|jpg)$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[ <span style=color:#75715e>// loader传递参数时建议该方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;file-loader&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span>{ <span style=color:#75715e>// file-loader自己的参数，跟webpack无关
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;images/[name].[hash:8].js&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><blockquote><p>每个loader的options参数不一定相同，这个需要查看对应loader的官方文档。</p></blockquote><h3 id=plugin>Plugin</h3><p>loader一般用来做模块转换，而插件可以执行更多的任务，包括打包优化、压缩、文件拷贝等等。插件的功能非常强大，可以进行各种各样的任务。</p><p>下面是打包之前清空dist目录的插件配置示例。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>CleanWebpackPlugin</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;clean-webpack-plugin&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CleanWebpackPlugin</span>(),
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>插件也可以传入选项，一般在实例化时进行传入。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MiniCssPlugin</span>({
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;styles/[name].[contenthash:8].css&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>chunkFilename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;styles/[name].[contenthash:8].css&#39;</span>
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h2 id=提取公共代码>提取公共代码</h2><p>Webpack4中提取公共代码只需要配置optimization.splitChunks即可。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>optimization</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>splitChunks</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>  	<span style=color:#a6e22e>cacheGroups</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    	<span style=color:#a6e22e>vendor</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 名为vendor的chunk
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      	<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;vendor&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/[\\/]node_modules[\\/]/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>chunks</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;all&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>priority</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      	<span style=color:#a6e22e>styles</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 名为styles的chunk
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;styles&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.css$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>chunks</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;all&#39;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>},
</span></span></code></pre></div><ul><li>cacheGroups 缓存组</li><li>name chunk的名称</li><li>test 加载的模块符合该正则时被打包到该chunk</li><li>chunks 模块的范围，有initial(初始模块),async(按需加载模块),all(全部模块)</li></ul><p>上面的例子中将node_modules中的js打包为vendor，以css结尾的打包为styles</p><h2 id=常用的loader和plugin>常用的loader和plugin</h2><h3 id=css-loader>css-loader</h3><blockquote><p>加载css文件</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.css$/</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;css-loader&#39;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=less-loader>less-loader</h3><blockquote><p>加载less文件，一般需要配合css-loader</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.less$/</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;css-loader&#39;</span>,<span style=color:#e6db74>&#39;less-loader&#39;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=file-loader>file-loader</h3><blockquote><p>将文件拷贝到输出文件夹，并返回相对路径。一般常用在加载图片</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.(png|gif|jpg)/</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>  	{
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;file-loader&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;images/[name].[hash:8].[ext]&#39;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }    
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=babel-loader>babel-loader</h3><blockquote><p>转换ES2015+代码到ES5</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.js$/</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exclude</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/(node_modules|bower_components)/</span>, <span style=color:#75715e>// 排除指定的模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;babel-loader&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>presets</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;@babel/preset-env&#39;</span>]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=ts-loader>ts-loader</h3><blockquote><p>转换Typescript到Javascript</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.ts/</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;ts-loader&#39;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=html-webpack-plugin>html-webpack-plugin</h3><blockquote><p>简化HTML的创建，该插件会自动将当前打包的资源(如JS、CSS)自动引用到HTML文件</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>HtmlWebpackPlugin</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;html-webpack-plugin&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span>  {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>HtmlWebpackPlugin</span>()
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h3 id=clean-webpack-plugin>clean-webpack-plugin</h3><blockquote><p>打包之前清理dist目录</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>CleanWebpackPlugin</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;clean-webpack-plugin&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span>  {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CleanWebpackPlugin</span>()
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h3 id=mini-css-extract-plugin>mini-css-extract-plugin</h3><blockquote><p>提取、压缩CSS，需要同时配置loader和plugin</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>MiniCssPlugin</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;mini-css-extract-plugin&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span>  {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.less$/</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>MiniCssPlugin</span>.<span style=color:#a6e22e>loader</span>, <span style=color:#e6db74>&#39;css-loader&#39;</span>, <span style=color:#e6db74>&#39;less-loader&#39;</span>]
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.css$/</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>MiniCssPlugin</span>.<span style=color:#a6e22e>loader</span>, <span style=color:#e6db74>&#39;css-loader&#39;</span>]
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MiniCssPlugin</span>({
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;styles/[name].[contenthash:8].css&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>chunkFilename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;styles/[name].[contenthash:8].css&#39;</span>
</span></span><span style=display:flex><span>    }),
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=实战>实战</h2><p>下面使用Webpack来配置一个传统多页面网站开发的示例。</p><h3 id=目录结构>目录结构</h3><pre tabindex=0><code>├── package.json
├── src
│   ├── about						关于页
│   │   ├── index.html
│   │   ├── index.js
│   │   └── style.less
│   ├── common
│   │   └── style.less
│   └── home						首页
│       ├── images
│       │   └── logo.png
│       ├── index.html
│       ├── index.js
│       └── style.less
├── webpack.config.js
</code></pre><h3 id=使用到的npm包>使用到的npm包</h3><pre tabindex=0><code>&#34;clean-webpack-plugin&#34;: &#34;^3.0.0&#34;,
&#34;css-loader&#34;: &#34;^3.2.1&#34;,
&#34;exports-loader&#34;: &#34;^0.7.0&#34;,
&#34;extract-text-webpack-plugin&#34;: &#34;^4.0.0-beta.0&#34;,
&#34;file-loader&#34;: &#34;^5.0.2&#34;,
&#34;html-webpack-plugin&#34;: &#34;^3.2.0&#34;,
&#34;html-withimg-loader&#34;: &#34;^0.1.16&#34;,
&#34;less&#34;: &#34;^3.10.3&#34;,
&#34;less-loader&#34;: &#34;^5.0.0&#34;,
&#34;mini-css-extract-plugin&#34;: &#34;^0.8.0&#34;,
&#34;normalize.css&#34;: &#34;^8.0.1&#34;,
&#34;script-loader&#34;: &#34;^0.7.2&#34;,
&#34;style-loader&#34;: &#34;^1.0.1&#34;,
&#34;url-loader&#34;: &#34;^3.0.0&#34;,
&#34;webpack&#34;: &#34;^4.41.2&#34;,
&#34;webpack-cli&#34;: &#34;^3.3.10&#34;,
&#34;webpack-dev-server&#34;: &#34;^3.9.0&#34;,
&#34;zepto&#34;: &#34;^1.2.0&#34;
</code></pre><h3 id=配置入口点>配置入口点</h3><p>由于是传统多页网站，每个页面都需要单独打包一份JS，因此<strong>每个页面需要一个入口</strong>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 入口配置，每个页面一个入口JS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>home</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/home/index&#39;</span>, <span style=color:#75715e>// 首页
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>about</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/about/index&#39;</span> <span style=color:#75715e>// 关于页
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h3 id=配置输出>配置输出</h3><p>本例我们不进行CDN部署，因此输出点配置比较简单。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 输出配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;dist&#39;</span>), <span style=color:#75715e>// 输出资源目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;scripts/[name].[hash:8].js&#39;</span>, <span style=color:#75715e>// 入口点JS命名规则
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>chunkFilename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;scripts/[name]:[chunkhash:8].js&#39;</span>, <span style=color:#75715e>// 公共模块命名规则 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>publicPath</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#75715e>// 资源路径前缀
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h3 id=配置开发服务器>配置开发服务器</h3><p>本地开发时不需要每次都编译完Webpack再访问，通过webpack-dev-server，我们可以边开发变查看效果，文件会实时编译。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>devServer</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>contentBase</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./dist&#39;</span>, <span style=color:#75715e>// 开发服务器配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>hot</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span> <span style=color:#75715e>// 热加载
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>},
</span></span></code></pre></div><h3 id=配置loader>配置loader</h3><p>本例中没有使用ES6进行编程，但是引用了一个非CommonJS的js模块<code>Zepto</code>，传统用法中在HTML页面引入Zepto就会在window下挂载全局对象Zepto。但是在Webpack开发中不建议使用全局变量，否则模块化的优势将受到影响。</p><p>通过使用exports-loader和script-loader，我们可以将Zepto包装为CommonJS模块进入导入。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#e6db74>&#39;zepto&#39;</span>),
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;exports-loader?window.Zepto!script-loader&#39;</span> <span style=color:#75715e>// 将window.Zepto包装为CommonJS模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            },
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.less$/</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>MiniCssPlugin</span>.<span style=color:#a6e22e>loader</span>, <span style=color:#e6db74>&#39;css-loader&#39;</span>, <span style=color:#e6db74>&#39;less-loader&#39;</span>]
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.css$/</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>MiniCssPlugin</span>.<span style=color:#a6e22e>loader</span>, <span style=color:#e6db74>&#39;css-loader&#39;</span>]
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.(png|jpg|gif)$/</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;file-loader&#39;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                            <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;images/[name].[hash:8].[ext]&#39;</span>
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.(htm|html)$/i</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;html-withimg-loader&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>    },
</span></span></code></pre></div><h3 id=配置optimization>配置optimization</h3><p>主要进行公共模块的打包配置。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>optimization</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>splitChunks</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>cacheGroups</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>vendor</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;vendor&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/[\\/]node_modules[\\/]/</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>chunks</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;all&#39;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>priority</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#75715e>// 优先级
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                },
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>styles</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;styles&#39;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.css$/</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>chunks</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;all&#39;</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span></code></pre></div><h3 id=配置plugin>配置plugin</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CleanWebpackPlugin</span>(), <span style=color:#75715e>// 清理发布目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>HtmlWebpackPlugin</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>chunks</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;home&#39;</span>, <span style=color:#e6db74>&#39;vendor&#39;</span>, <span style=color:#e6db74>&#39;styles&#39;</span>], <span style=color:#75715e>// 声明本页面使用到的模块，有主页，公共JS以及公共CSS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;index.html&#39;</span>, <span style=color:#75715e>// 输出路径，这里直接输出到dist的根目录，也就是dist/index.html
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>template</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/home/index.html&#39;</span>, <span style=color:#75715e>// HTML模板文件路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>minify</span><span style=color:#f92672>:</span> { 
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>removeComments</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 移除注释
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>collapseWhitespace</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span> <span style=color:#75715e>// 合并空格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>        }),
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>HtmlWebpackPlugin</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>chunks</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;about&#39;</span>, <span style=color:#e6db74>&#39;vendor&#39;</span>, <span style=color:#e6db74>&#39;styles&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;about/index.html&#39;</span>, <span style=color:#75715e>// 输出到dist/about/index.html
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>template</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/about/index.html&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>minify</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>removeComments</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>collapseWhitespace</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }),
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MiniCssPlugin</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;styles/[name].[contenthash:8].css&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>chunkFilename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;styles/[name].[contenthash:8].css&#39;</span>
</span></span><span style=display:flex><span>        }),
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>webpack</span>.<span style=color:#a6e22e>NamedModulesPlugin</span>(), <span style=color:#75715e>// 热加载使用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>webpack</span>.<span style=color:#a6e22e>HotModuleReplacementPlugin</span>() <span style=color:#75715e>// 热加载使用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ]
</span></span></code></pre></div><h3 id=示例代码>示例代码</h3><p>部分示例代码如下:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// src/about/index.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>$</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;zepto&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;normalize.css&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;../common/style.less&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./style.less&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#about&#39;</span>).<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;click&#39;</span>, <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#39;点击了about按钮&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>和传统的JS有点不太一样，多了一些css的require，前面说过，webpack把所有资源当做JS模块，因此这是推荐的做法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--首页--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>http-equiv</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;X-UA-Compatible&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ie=edge&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>title</span>&gt;首页&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>ul</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>li</span>&gt;&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/&#34;</span>&gt;首页&lt;/<span style=color:#f92672>a</span>&gt;&lt;/<span style=color:#f92672>li</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>li</span>&gt;&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/about&#34;</span>&gt;关于&lt;/<span style=color:#f92672>a</span>&gt;&lt;/<span style=color:#f92672>li</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>ul</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;logo&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;home&#34;</span>&gt;首页按钮&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><p>页面中不再需要编写JS。</p><blockquote><p>注意：html中使用标签导入图片的编译，目前还没有好的解决办法，可以通过css background的形式进行处理</p></blockquote><h3 id=开发模式>开发模式</h3><p>开发模式下直接启用webpack-dev-server即可，会自动加载工作目录下的webpack.config.js</p><pre tabindex=0><code>// package.json
&#34;scripts&#34;: {
    &#34;build&#34;: &#34;webpack&#34;,
    &#34;dev&#34;: &#34;webpack-dev-server&#34;
}
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm run dev
</span></span></code></pre></div><h3 id=生产模式>生产模式</h3><p>生产模式下使用webpack编译，编译完成后输出最终文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm run build
</span></span></code></pre></div><h3 id=输出效果>输出效果</h3><pre tabindex=0><code>├── about
│   └── index.html
├── images
│   └── logo.b15c113a.png
├── index.html
├── scripts
│   ├── about.3fb4aa0f.js
│   ├── home.3fb4aa0f.js
│   └── vendor:ed5b7d31.js
└── styles
    ├── about.71eb65e9.css
    ├── home.cd2738e6.css
    └── vendor.9df34e21.css
</code></pre><h3 id=项目地址>项目地址</h3><p>项目已经托管到github，有需要的读者可以自取。</p><p><a href=https://github.com/xialeistudio/webpack-multipage-example target=_blank rel=noopener>https://github.com/xialeistudio/webpack-multipage-example</a></p><p><img alt=0.jpeg src=https://static.ddhigh.com/blog/2019-10-22-102654.jpg></p><div class=blog-footer><div class=social-share></div><div class=copyright><ul><li style=margin-bottom:.5em>本文作者: <a href=https://ddhigh.com/ target=_blank style=color:#000;text-decoration:none>xialeistudio</a></li><li style=margin-bottom:.5em>本文链接: <a href=https://www.ddhigh.com/2019/12/19/webpack-get-started/ target=_blank style=color:#000;text-decoration:none>Webpack4不求人系列(1)</a></li><li>版权声明: <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank style=color:#000;text-decoration:none>「署名-非商业性使用-相同方式共享 4.0 国际」</a></li></ul></div><div style=margin-top:2rem><img src=/img/mp.png alt=qrcode></div></div></section><div class=paginator><a class=prev href=https://www.ddhigh.com/2019/12/30/javascript-event/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>Javascript事件系统</span></a>
<a class=next href=https://www.ddhigh.com/2019/11/14/mysql-char-varchar-max-length/><span>MySQL中的CHAR和VARCHAR到底支持多长?</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","xialeistudio/discussion"),s.setAttribute("data-repo-id","R_kgDOKurTRA"),s.setAttribute("data-category","General"),s.setAttribute("data-category-id","DIC_kwDOKurTRM4CbCJt"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","en"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></div><footer class=footer><p>&copy; 2014 - 2024 <a href=https://www.ddhigh.com/>每天进步一点点</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script><script src=https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js integrity="sha512-9DNXrSjk17bU9MUbRp3IjwcWe46V8FaGA062PFbryPUAEQVRbz4jiZP6FW0AdbqEGtMYBDWnul3eiGBMJOQajA==" crossorigin=anonymous referrerpolicy=no-referrer></script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>