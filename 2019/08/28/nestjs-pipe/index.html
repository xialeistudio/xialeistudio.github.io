<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>NestJs学习之旅(8)——管道</title>
<meta charset=utf-8><meta name=description content="Ladder@本文是NestJs学习之旅的第八篇，讲解管道。
管道 熟悉Linux命令的伙伴应该对“管道运算符”不陌生。
ls -la | grep demo &ldquo;|&rdquo; 就是管道运算符，它把左边命令的输出作为输入传递给右边的命令，支持级联，如此一来，便可以通过管道运算符进行复杂命令的交替运算。
NestJs中的管道有着类似的功能，也可以级联处理数据。NestJs管道通过**@Injectable()装饰器装饰，需要实现PipeTransform**接口。
NestJs中管道的主要职责如下：
数据转换 将输入数据转换为所需的输出 数据验证 接收客户端提交的参数，如果通过验证则继续传递，如果验证未通过则提示错误 执行顺序 在前面的文章中我们讨论了中间件、控制器、路由守卫，结合本问讨论的管道，可能有些读者会对这些组件的执行顺序提出疑问：这些东西执行的顺序到底是怎样的？
执行顺序也不用找资料，自己在这些组件执行时加上日志即可，我得出的结论如下：
客户端请求 -> 中间件 -> 路由守卫 -> 管道 -> 控制器方法
开发管道 数据转换类的管道就不详细解释了：
给你一个value和元数据，你的return值就是转换后的值。
NestJs内置了ValidationPipe、ParseIntPipe和ParseUUIDPipe。为了更好地理解它们的工作原理，我们以ValidationPipe（验证器管道）为例来演示管道的使用。
PipeTransform 这是管道必须实现的接口，该接口定义如下：
export interface PipeTransform<T = any, R = any> { transform(value: T, metadata: ArgumentMetadata): R; } value 输入参数，T为输入参数类型 metadata  value的元数据，包括参数来源，参数类型等等 输出参数，R为输出参数类型 ArgumentMetadata 用来描述当前处理value的元数据接口，接口定义如下：
export interface ArgumentMetadata { readonly type: 'body' | 'query' | 'param' | 'custom'; readonly metatype?"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/2019/08/28/nestjs-pipe/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com//index.xml title="Lei Xia"><script async defer data-website-id=865c8529-0729-4cf5-88a9-448616abbcbb src=https://umami-beta-peach.vercel.app/xialeistudio></script><meta property="og:title" content="NestJs学习之旅(8)——管道"><meta property="og:description" content="本文是NestJs学习之旅的第八篇，讲解管道。
管道 熟悉Linux命令的伙伴应该对“管道运算符”不陌生。
ls -la | grep demo &ldquo;|&rdquo; 就是管道运算符，它把左边命令的输出作为输入传递给右边的命令，支持级联，如此一来，便可以通过管道运算符进行复杂命令的交替运算。
NestJs中的管道有着类似的功能，也可以级联处理数据。NestJs管道通过**@Injectable()装饰器装饰，需要实现PipeTransform**接口。
NestJs中管道的主要职责如下：
数据转换 将输入数据转换为所需的输出 数据验证 接收客户端提交的参数，如果通过验证则继续传递，如果验证未通过则提示错误 执行顺序 在前面的文章中我们讨论了中间件、控制器、路由守卫，结合本问讨论的管道，可能有些读者会对这些组件的执行顺序提出疑问：这些东西执行的顺序到底是怎样的？
执行顺序也不用找资料，自己在这些组件执行时加上日志即可，我得出的结论如下：
客户端请求 -> 中间件 -> 路由守卫 -> 管道 -> 控制器方法
开发管道 数据转换类的管道就不详细解释了：
给你一个value和元数据，你的return值就是转换后的值。
NestJs内置了ValidationPipe、ParseIntPipe和ParseUUIDPipe。为了更好地理解它们的工作原理，我们以ValidationPipe（验证器管道）为例来演示管道的使用。
PipeTransform 这是管道必须实现的接口，该接口定义如下：
export interface PipeTransform<T = any, R = any> { transform(value: T, metadata: ArgumentMetadata): R; } value 输入参数，T为输入参数类型 metadata  value的元数据，包括参数来源，参数类型等等 输出参数，R为输出参数类型 ArgumentMetadata 用来描述当前处理value的元数据接口，接口定义如下：
export interface ArgumentMetadata { readonly type: 'body' | 'query' | 'param' | 'custom'; readonly metatype?"><meta property="og:type" content="article"><meta property="og:url" content="https://www.ddhigh.com/2019/08/28/nestjs-pipe/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-08-28T14:47:48+00:00"><meta property="article:modified_time" content="2019-08-28T14:47:48+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="NestJs学习之旅(8)——管道"><meta name=twitter:description content="本文是NestJs学习之旅的第八篇，讲解管道。
管道 熟悉Linux命令的伙伴应该对“管道运算符”不陌生。
ls -la | grep demo &ldquo;|&rdquo; 就是管道运算符，它把左边命令的输出作为输入传递给右边的命令，支持级联，如此一来，便可以通过管道运算符进行复杂命令的交替运算。
NestJs中的管道有着类似的功能，也可以级联处理数据。NestJs管道通过**@Injectable()装饰器装饰，需要实现PipeTransform**接口。
NestJs中管道的主要职责如下：
数据转换 将输入数据转换为所需的输出 数据验证 接收客户端提交的参数，如果通过验证则继续传递，如果验证未通过则提示错误 执行顺序 在前面的文章中我们讨论了中间件、控制器、路由守卫，结合本问讨论的管道，可能有些读者会对这些组件的执行顺序提出疑问：这些东西执行的顺序到底是怎样的？
执行顺序也不用找资料，自己在这些组件执行时加上日志即可，我得出的结论如下：
客户端请求 -> 中间件 -> 路由守卫 -> 管道 -> 控制器方法
开发管道 数据转换类的管道就不详细解释了：
给你一个value和元数据，你的return值就是转换后的值。
NestJs内置了ValidationPipe、ParseIntPipe和ParseUUIDPipe。为了更好地理解它们的工作原理，我们以ValidationPipe（验证器管道）为例来演示管道的使用。
PipeTransform 这是管道必须实现的接口，该接口定义如下：
export interface PipeTransform<T = any, R = any> { transform(value: T, metadata: ArgumentMetadata): R; } value 输入参数，T为输入参数类型 metadata  value的元数据，包括参数来源，参数类型等等 输出参数，R为输出参数类型 ArgumentMetadata 用来描述当前处理value的元数据接口，接口定义如下：
export interface ArgumentMetadata { readonly type: 'body' | 'query' | 'param' | 'custom'; readonly metatype?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.ddhigh.com/posts/"},{"@type":"ListItem","position":2,"name":"NestJs学习之旅(8)——管道","item":"https://www.ddhigh.com/2019/08/28/nestjs-pipe/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NestJs学习之旅(8)——管道","name":"NestJs学习之旅(8)——管道","description":"本文是NestJs学习之旅的第八篇，讲解管道。\n管道 熟悉Linux命令的伙伴应该对“管道运算符”不陌生。\nls -la | grep demo \u0026ldquo;|\u0026rdquo; 就是管道运算符，它把左边命令的输出作为输入传递给右边的命令，支持级联，如此一来，便可以通过管道运算符进行复杂命令的交替运算。\nNestJs中的管道有着类似的功能，也可以级联处理数据。NestJs管道通过**@Injectable()装饰器装饰，需要实现PipeTransform**接口。\nNestJs中管道的主要职责如下：\n数据转换 将输入数据转换为所需的输出 数据验证 接收客户端提交的参数，如果通过验证则继续传递，如果验证未通过则提示错误 执行顺序 在前面的文章中我们讨论了中间件、控制器、路由守卫，结合本问讨论的管道，可能有些读者会对这些组件的执行顺序提出疑问：这些东西执行的顺序到底是怎样的？\n执行顺序也不用找资料，自己在这些组件执行时加上日志即可，我得出的结论如下：\n客户端请求 -\u0026gt; 中间件 -\u0026gt; 路由守卫 -\u0026gt; 管道 -\u0026gt; 控制器方法\n开发管道 数据转换类的管道就不详细解释了：\n给你一个value和元数据，你的return值就是转换后的值。\nNestJs内置了ValidationPipe、ParseIntPipe和ParseUUIDPipe。为了更好地理解它们的工作原理，我们以ValidationPipe（验证器管道）为例来演示管道的使用。\nPipeTransform 这是管道必须实现的接口，该接口定义如下：\nexport interface PipeTransform\u0026lt;T = any, R = any\u0026gt; { transform(value: T, metadata: ArgumentMetadata): R; } value 输入参数，T为输入参数类型 metadata \u0010 value的元数据，包括参数来源，参数类型等等 输出参数，R为输出参数类型 ArgumentMetadata 用来描述当前处理value的元数据接口，接口定义如下：\nexport interface ArgumentMetadata { readonly type: \u0026#39;body\u0026#39; | \u0026#39;query\u0026#39; | \u0026#39;param\u0026#39; | \u0026#39;custom\u0026#39;; readonly metatype?","keywords":["nestjs"],"articleBody":"本文是NestJs学习之旅的第八篇，讲解管道。\n管道 熟悉Linux命令的伙伴应该对“管道运算符”不陌生。\nls -la | grep demo “|” 就是管道运算符，它把左边命令的输出作为输入传递给右边的命令，支持级联，如此一来，便可以通过管道运算符进行复杂命令的交替运算。\nNestJs中的管道有着类似的功能，也可以级联处理数据。NestJs管道通过**@Injectable()装饰器装饰，需要实现PipeTransform**接口。\nNestJs中管道的主要职责如下：\n数据转换 将输入数据转换为所需的输出 数据验证 接收客户端提交的参数，如果通过验证则继续传递，如果验证未通过则提示错误 执行顺序 在前面的文章中我们讨论了中间件、控制器、路由守卫，结合本问讨论的管道，可能有些读者会对这些组件的执行顺序提出疑问：这些东西执行的顺序到底是怎样的？\n执行顺序也不用找资料，自己在这些组件执行时加上日志即可，我得出的结论如下：\n客户端请求 -\u003e 中间件 -\u003e 路由守卫 -\u003e 管道 -\u003e 控制器方法\n开发管道 数据转换类的管道就不详细解释了：\n给你一个value和元数据，你的return值就是转换后的值。\nNestJs内置了ValidationPipe、ParseIntPipe和ParseUUIDPipe。为了更好地理解它们的工作原理，我们以ValidationPipe（验证器管道）为例来演示管道的使用。\nPipeTransform 这是管道必须实现的接口，该接口定义如下：\nexport interface PipeTransform\u003cT = any, R = any\u003e { transform(value: T, metadata: ArgumentMetadata): R; } value 输入参数，T为输入参数类型 metadata \u0010 value的元数据，包括参数来源，参数类型等等 输出参数，R为输出参数类型 ArgumentMetadata 用来描述当前处理value的元数据接口，接口定义如下：\nexport interface ArgumentMetadata { readonly type: 'body' | 'query' | 'param' | 'custom'; readonly metatype?: Type\u003cany\u003e; readonly data?: string; } 这个接口大家可能看不明白，没关系，等下会有具体示例来进行解读。\ntype 输入数据的来源 metatype ","wordCount":"387","inLanguage":"en","datePublished":"2019-08-28T14:47:48Z","dateModified":"2019-08-28T14:47:48Z","author":{"@type":"Person","name":"Lei Xia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ddhigh.com/2019/08/28/nestjs-pipe/"},"publisher":{"@type":"Organization","name":"Lei Xia","logo":{"@type":"ImageObject","url":"https://www.ddhigh.com/favicon.ico"}}}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.ff1bc260fafbfb440e10194d7d06d57eb5e85eed11d12d06255581262664204e.css integrity="sha256-/xvCYPr7+0QOEBlNfQbVfrXoXu0R0S0GJVWBJiZkIE4=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/books>Books</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>Guestbook</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>NestJs学习之旅(8)——管道</h1></header><p><small>August 28, 2019&nbsp;· 387 words&nbsp;· 2 min</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#管道>管道</a></li><li><a href=#执行顺序>执行顺序</a></li><li><a href=#开发管道>开发管道</a><ul><li><a href=#pipetransform>PipeTransform</a></li><li><a href=#argumentmetadata>ArgumentMetadata</a></li></ul></li><li><a href=#验证器示例>验证器示例</a><ul><li><a href=#dto定义>DTO定义</a></li><li><a href=#管道定义>管道定义</a></li><li><a href=#控制器定义>控制器定义</a></li><li><a href=#运行项目>运行项目</a></li><li><a href=#注意事项>注意事项</a></li></ul></li><li><a href=#结尾>结尾</a></li></ul></nav></div><section class=blog-content><p>本文是NestJs学习之旅的第八篇，讲解管道。</p><h2 id=管道>管道</h2><p>熟悉Linux命令的伙伴应该对“管道运算符”不陌生。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls -la | grep demo
</span></span></code></pre></div><p>&ldquo;|&rdquo; 就是管道运算符，它把左边命令的输出作为输入传递给右边的命令，支持级联，如此一来，便可以通过管道运算符进行复杂命令的交替运算。</p><p><img alt=img src=https://static.ddhigh.com/blog/2019-08-28-054610.png></p><p>NestJs中的管道有着类似的功能，也可以级联处理数据。NestJs管道通过**@Injectable()<strong>装饰器装饰，需要实现</strong>PipeTransform**接口。</p><p>NestJs中管道的主要职责如下：</p><ul><li><strong>数据转换</strong> 将输入数据转换为所需的输出</li><li><strong>数据验证</strong> 接收客户端提交的参数，如果通过验证则继续传递，如果验证未通过则提示错误</li></ul><h2 id=执行顺序>执行顺序</h2><p>在前面的文章中我们讨论了<strong>中间件</strong>、<strong>控制器</strong>、<strong>路由守卫</strong>，结合本问讨论的<strong>管道</strong>，可能有些读者会对这些组件的执行顺序提出疑问：这些东西执行的顺序到底是怎样的？</p><p>执行顺序也不用找资料，自己在这些组件执行时加上日志即可，我得出的结论如下：</p><blockquote><p>客户端请求 -> 中间件 -> 路由守卫 -> 管道 -> 控制器方法</p></blockquote><h2 id=开发管道>开发管道</h2><p>数据转换类的管道就不详细解释了：</p><blockquote><p>给你一个value和元数据，你的return值就是转换后的值。</p></blockquote><p>NestJs内置了ValidationPipe、ParseIntPipe和ParseUUIDPipe。为了更好地理解它们的工作原理，我们以ValidationPipe（验证器管道）为例来演示管道的使用。</p><h3 id=pipetransform>PipeTransform</h3><p>这是管道必须实现的接口，该接口定义如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>PipeTransform</span>&lt;<span style=color:#f92672>T</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#a6e22e>any</span><span style=color:#960050;background-color:#1e0010>,</span> <span style=color:#a6e22e>R </span><span style=color:#f92672>=</span> <span style=color:#a6e22e>any</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>transform</span>(<span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>T</span>, <span style=color:#a6e22e>metadata</span>: <span style=color:#66d9ef>ArgumentMetadata</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>R</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>value 输入参数，T为输入参数类型</li><li>metadata  value的元数据，包括参数来源，参数类型等等</li><li>输出参数，R为输出参数类型</li></ul><h3 id=argumentmetadata>ArgumentMetadata</h3><p>用来描述当前处理value的元数据接口，接口定义如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ArgumentMetadata</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>readonly</span> <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;body&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;query&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;param&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;custom&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>metatype?</span>: <span style=color:#66d9ef>Type</span>&lt;<span style=color:#f92672>any</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>data?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>这个接口大家可能看不明白，没关系，等下会有具体示例来进行解读。</p><ul><li>type 输入数据的来源</li><li>metatype &lt;Type> 注入数据的类型</li><li>data &lt;string|undefined>传递给装饰器的数据类型</li></ul><p>例如如下控制器方法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>@Post</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>login</span>(<span style=color:#66d9ef>@Query</span>(<span style=color:#e6db74>&#39;type&#39;</span>) <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span>) { <span style=color:#75715e>// type 为登录类型参数，类似手机号登录为1，账号登录为2的例子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>上述例子的元数据如下：</p><ul><li>type query @Query装饰器是读取GET参数</li><li>metatype Number type的类型符号</li><li>data type 传递给@Query装饰器的参数为“type”</li></ul><h2 id=验证器示例>验证器示例</h2><p>下面以用户登录时校验账号密码来说明验证器管道的使用，规则如下：</p><ul><li>账号必须是字符串，长度6-20</li><li>密码不能为空</li></ul><h3 id=dto定义>DTO定义</h3><p>DTO在Java中是Data Transfer Object，简单来说就是对数据的一层包装。咱们NestJs中用这个东西一般是为了防止非法字段的提交和IDE自动提示（偷笑）。</p><p>使用规则装饰器需要安装class-validator和class-transformer：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm i --save class-validator class-transformer
</span></span></code></pre></div><p>登录表单定义如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// userLogin.dto.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UserLoginDto</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>@IsString</span>()
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>@Length</span>(<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>20</span>, { <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;长度不合法&#39;</span> })
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>username</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>@Length</span>(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>password</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=管道定义>管道定义</h3><p>由于咱们的管道是通用的，也就是验证什么内容是由外部决定的，管道只负责“你给我数据和规则，我来校验”。所以咱们需要使用到装饰器元数据。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// validate.pipe.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ArgumentMetadata</span>, <span style=color:#a6e22e>BadRequestException</span>, <span style=color:#a6e22e>Injectable</span>, <span style=color:#a6e22e>PipeTransform</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@nestjs/common&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>plainToClass</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;class-transformer&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>validate</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;class-validator&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Injectable</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ValidatePipe</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>PipeTransform</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>transform</span>(<span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>any</span>, { <span style=color:#a6e22e>metatype</span> }<span style=color:#f92672>:</span> <span style=color:#a6e22e>ArgumentMetadata</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>any</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>metatype</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>toValidate</span>(<span style=color:#a6e22e>metatype</span>)) { <span style=color:#75715e>// 如果不是注入的数据且不需要验证，直接跳过处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 数据格式转换
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>object</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>plainToClass</span>(<span style=color:#a6e22e>metatype</span>, <span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 调用验证
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>errors</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>validate</span>(<span style=color:#66d9ef>object</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 如果错误长度大于0，证明出错，需要抛出400错误
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>BadRequestException</span>(<span style=color:#a6e22e>errors</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * 需要验证的数据类型
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * @param metatype
</span></span></span><span style=display:flex><span><span style=color:#75715e>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>toValidate</span>(<span style=color:#a6e22e>metatype</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>types</span> <span style=color:#f92672>=</span> [String, Boolean, Number, Array, Object];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>types</span>.<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>metatype</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=控制器定义>控制器定义</h3><p>今天的主角是管道，所以控制器层就不写逻辑了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// user.controller.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@Post</span>(<span style=color:#e6db74>&#39;login&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>@UsePipes</span>(<span style=color:#a6e22e>ValidatePipe</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>login</span>(<span style=color:#66d9ef>@Body</span>() <span style=color:#a6e22e>userLoginDto</span>: <span style=color:#66d9ef>UserLoginDTO</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {<span style=color:#a6e22e>errcode</span>:<span style=color:#66d9ef>0</span>, <span style=color:#a6e22e>errmsg</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ok&#39;</span>};
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=运行项目>运行项目</h3><p>项目根目录执行以下命令即可运行NestJs项目：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm run start
</span></span></code></pre></div><p>项目运行后可以使用Postman来验证一下：</p><p>请求数据1</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>响应数据1</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;statusCode&#34;</span>: <span style=color:#ae81ff>400</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;error&#34;</span>: <span style=color:#e6db74>&#34;Bad Request&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;message&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;target&#34;</span>: {},
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;property&#34;</span>: <span style=color:#e6db74>&#34;username&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;children&#34;</span>: [],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;constraints&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;length&#34;</span>: <span style=color:#e6db74>&#34;长度不合法&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;isString&#34;</span>: <span style=color:#e6db74>&#34;username must be a string&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;target&#34;</span>: {},
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;property&#34;</span>: <span style=color:#e6db74>&#34;password&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;children&#34;</span>: [],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;constraints&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;length&#34;</span>: <span style=color:#e6db74>&#34;password must be longer than or equal to 1 characters&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>请求数据2</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;username&#34;</span>:<span style=color:#e6db74>&#34;xialeistudio&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>响应数据2</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;statusCode&#34;</span>: <span style=color:#ae81ff>400</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;error&#34;</span>: <span style=color:#e6db74>&#34;Bad Request&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;message&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;target&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;username&#34;</span>: <span style=color:#e6db74>&#34;xialeistudio&#34;</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;property&#34;</span>: <span style=color:#e6db74>&#34;password&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;children&#34;</span>: [],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;constraints&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;length&#34;</span>: <span style=color:#e6db74>&#34;password must be longer than or equal to 1 characters&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>请求数据3</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;username&#34;</span>:<span style=color:#e6db74>&#34;xialeistudio&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;password&#34;</span>:<span style=color:#e6db74>&#34;111111&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>响应数据3</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[]
</span></span></code></pre></div><h3 id=注意事项>注意事项</h3><p>上文演示了ValidatePipe的实现，生产环境直接使用NestJs提供的ValidationPipe即可。我们可以在main.ts中使用全局管道。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bootstrap() {</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>NestFactory</span>.<span style=color:#a6e22e>create</span>(<span style=color:#a6e22e>AppModule</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>useGlobalPipes</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ValidationPipe</span>());
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>3000</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>bootstrap</span>();
</span></span></code></pre></div><h2 id=结尾>结尾</h2><p>和笔者使用的SpringBoot中验证框架对比一下之后发现，NestJs验证管道所实现的功能还真不比SpringBoot差，看来官方说的“下一代Node.js全栈开发框架”确实不是盖的！</p><p>如果您想交流关于NestJs更多的知识，欢迎加群讨论！</p><p><img alt=20190827145318 src=https://static.ddhigh.com/blog/2019-08-27-065355.jpg?imageView2/2/h/200></p></section><div class=paginator><a class=prev href=https://www.ddhigh.com/2019/09/10/nestjs-interceptor/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>NestJs学习之旅(9)——拦截器</span></a>
<a class=next href=https://www.ddhigh.com/2019/08/27/nestjs-guard/><span>NestJs学习之旅(7)——路由守卫</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","xialeistudio/discussion"),s.setAttribute("data-repo-id","R_kgDOKurTRA"),s.setAttribute("data-category","General"),s.setAttribute("data-category-id","DIC_kwDOKurTRM4CbCJt"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","en"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></div><footer class=footer><p>&copy; 2014 - 2024 <a href=https://www.ddhigh.com/>Lei Xia</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
<a href=https://umami-beta-peach.vercel.app/ target=_blank>Statistics</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>