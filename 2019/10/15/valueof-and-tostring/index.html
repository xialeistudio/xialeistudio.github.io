<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>聊一聊valueOf和toString</title>
<meta charset=utf-8><meta name=description content='Ladder@valueOf和toString是Object.prototype的方法。一般很少直接调用，但是在使用对象参与运算的时候就会调用这两个方法了。我想大部分人都存在以下疑问：
valueOf和toString哪个优先级较高? 是不是所有场景都会调用valueOf和toString 概念解释 valueOf: 返回对象的原始值表示 toString: 返回对象的字符串表示 在介绍下面的内容之前先了解一下转换规则，下面的内容解释都是基于这个规则表来的：
valueOf转换规则 valueOf是Object.prototype的方法，由Object来的对象都会有该方法，但是很多内置对象会重写这个方法，以适合实际需要。
说到原始值就必须说到原始类型，JS规范中 原始类型 如下：
Boolean Null Undefined Number String 非原始值(也就是对象)重写规则如下：
对象 valueOf返回值 Array 数组本身 Boolean 布尔值 Date 返回毫秒形式的时间戳 Function 函数本身 Number 数字值 Object 对象本身 String 字符串值 以下规则是经过验证的，如果对验证过程不关心，可以只看转换规则。
建议看一下验证过程，这样可以加深理解
对象转换为布尔值 直接转换为true（包装类型也一样），不调用valueOf和toString 对象转换为数字 在预期会将对象用作数字使用时，比如参与算术运算等等操作，对象转换为数字会依次调用valueOf和toString方法，具体规则如下：
如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 转换失败，抛出TypeError 对象转换为字符串 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 转换失败，抛出TypeError toString转换规则 对象 toString返回值 Array 以逗号分割的字符串，如[1,2]的toString返回值为"1,2" Boolean &ldquo;True&rdquo; Date 可读的时间字符串，如"Tue Oct 15 2019 12:20:56 GMT+0800 (中国标准时间)" Function 声明函数的JS源代码字符串 Number &ldquo;数字值&rdquo; Object &ldquo;[object Object]&rdquo; String &ldquo;字符串&rdquo; 验证对象到原始值的转换 光看valueOf和toString没啥东西可说，日常开发中也很少直接调用，但是当我们将对象当做原始值来使用时会发生转换，而且转换过程还略微有点迷糊。'><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/2019/10/15/valueof-and-tostring/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com//index.xml title="Lei Xia"><meta property="og:title" content="聊一聊valueOf和toString"><meta property="og:description" content='valueOf和toString是Object.prototype的方法。一般很少直接调用，但是在使用对象参与运算的时候就会调用这两个方法了。我想大部分人都存在以下疑问：
valueOf和toString哪个优先级较高? 是不是所有场景都会调用valueOf和toString 概念解释 valueOf: 返回对象的原始值表示 toString: 返回对象的字符串表示 在介绍下面的内容之前先了解一下转换规则，下面的内容解释都是基于这个规则表来的：
valueOf转换规则 valueOf是Object.prototype的方法，由Object来的对象都会有该方法，但是很多内置对象会重写这个方法，以适合实际需要。
说到原始值就必须说到原始类型，JS规范中 原始类型 如下：
Boolean Null Undefined Number String 非原始值(也就是对象)重写规则如下：
对象 valueOf返回值 Array 数组本身 Boolean 布尔值 Date 返回毫秒形式的时间戳 Function 函数本身 Number 数字值 Object 对象本身 String 字符串值 以下规则是经过验证的，如果对验证过程不关心，可以只看转换规则。
建议看一下验证过程，这样可以加深理解
对象转换为布尔值 直接转换为true（包装类型也一样），不调用valueOf和toString 对象转换为数字 在预期会将对象用作数字使用时，比如参与算术运算等等操作，对象转换为数字会依次调用valueOf和toString方法，具体规则如下：
如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 转换失败，抛出TypeError 对象转换为字符串 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 转换失败，抛出TypeError toString转换规则 对象 toString返回值 Array 以逗号分割的字符串，如[1,2]的toString返回值为"1,2" Boolean &ldquo;True&rdquo; Date 可读的时间字符串，如"Tue Oct 15 2019 12:20:56 GMT+0800 (中国标准时间)" Function 声明函数的JS源代码字符串 Number &ldquo;数字值&rdquo; Object &ldquo;[object Object]&rdquo; String &ldquo;字符串&rdquo; 验证对象到原始值的转换 光看valueOf和toString没啥东西可说，日常开发中也很少直接调用，但是当我们将对象当做原始值来使用时会发生转换，而且转换过程还略微有点迷糊。'><meta property="og:type" content="article"><meta property="og:url" content="https://www.ddhigh.com/2019/10/15/valueof-and-tostring/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-15T12:00:00+00:00"><meta property="article:modified_time" content="2019-10-15T12:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="聊一聊valueOf和toString"><meta name=twitter:description content='valueOf和toString是Object.prototype的方法。一般很少直接调用，但是在使用对象参与运算的时候就会调用这两个方法了。我想大部分人都存在以下疑问：
valueOf和toString哪个优先级较高? 是不是所有场景都会调用valueOf和toString 概念解释 valueOf: 返回对象的原始值表示 toString: 返回对象的字符串表示 在介绍下面的内容之前先了解一下转换规则，下面的内容解释都是基于这个规则表来的：
valueOf转换规则 valueOf是Object.prototype的方法，由Object来的对象都会有该方法，但是很多内置对象会重写这个方法，以适合实际需要。
说到原始值就必须说到原始类型，JS规范中 原始类型 如下：
Boolean Null Undefined Number String 非原始值(也就是对象)重写规则如下：
对象 valueOf返回值 Array 数组本身 Boolean 布尔值 Date 返回毫秒形式的时间戳 Function 函数本身 Number 数字值 Object 对象本身 String 字符串值 以下规则是经过验证的，如果对验证过程不关心，可以只看转换规则。
建议看一下验证过程，这样可以加深理解
对象转换为布尔值 直接转换为true（包装类型也一样），不调用valueOf和toString 对象转换为数字 在预期会将对象用作数字使用时，比如参与算术运算等等操作，对象转换为数字会依次调用valueOf和toString方法，具体规则如下：
如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 转换失败，抛出TypeError 对象转换为字符串 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 转换失败，抛出TypeError toString转换规则 对象 toString返回值 Array 以逗号分割的字符串，如[1,2]的toString返回值为"1,2" Boolean &ldquo;True&rdquo; Date 可读的时间字符串，如"Tue Oct 15 2019 12:20:56 GMT+0800 (中国标准时间)" Function 声明函数的JS源代码字符串 Number &ldquo;数字值&rdquo; Object &ldquo;[object Object]&rdquo; String &ldquo;字符串&rdquo; 验证对象到原始值的转换 光看valueOf和toString没啥东西可说，日常开发中也很少直接调用，但是当我们将对象当做原始值来使用时会发生转换，而且转换过程还略微有点迷糊。'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.ddhigh.com/posts/"},{"@type":"ListItem","position":2,"name":"聊一聊valueOf和toString","item":"https://www.ddhigh.com/2019/10/15/valueof-and-tostring/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"聊一聊valueOf和toString","name":"聊一聊valueOf和toString","description":"valueOf和toString是Object.prototype的方法。一般很少直接调用，但是在使用对象参与运算的时候就会调用这两个方法了。我想大部分人都存在以下疑问：\nvalueOf和toString哪个优先级较高? 是不是所有场景都会调用valueOf和toString 概念解释 valueOf: 返回对象的原始值表示 toString: 返回对象的字符串表示 在介绍下面的内容之前先了解一下转换规则，下面的内容解释都是基于这个规则表来的：\nvalueOf转换规则 valueOf是Object.prototype的方法，由Object来的对象都会有该方法，但是很多内置对象会重写这个方法，以适合实际需要。\n说到原始值就必须说到原始类型，JS规范中 原始类型 如下：\nBoolean Null Undefined Number String 非原始值(也就是对象)重写规则如下：\n对象 valueOf返回值 Array 数组本身 Boolean 布尔值 Date 返回毫秒形式的时间戳 Function 函数本身 Number 数字值 Object 对象本身 String 字符串值 以下规则是经过验证的，如果对验证过程不关心，可以只看转换规则。\n建议看一下验证过程，这样可以加深理解\n对象转换为布尔值 直接转换为true（包装类型也一样），不调用valueOf和toString 对象转换为数字 在预期会将对象用作数字使用时，比如参与算术运算等等操作，对象转换为数字会依次调用valueOf和toString方法，具体规则如下：\n如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 转换失败，抛出TypeError 对象转换为字符串 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 转换失败，抛出TypeError toString转换规则 对象 toString返回值 Array 以逗号分割的字符串，如[1,2]的toString返回值为\u0026quot;1,2\u0026quot; Boolean \u0026ldquo;True\u0026rdquo; Date 可读的时间字符串，如\u0026quot;Tue Oct 15 2019 12:20:56 GMT+0800 (中国标准时间)\u0026quot; Function 声明函数的JS源代码字符串 Number \u0026ldquo;数字值\u0026rdquo; Object \u0026ldquo;[object Object]\u0026rdquo; String \u0026ldquo;字符串\u0026rdquo; 验证对象到原始值的转换 光看valueOf和toString没啥东西可说，日常开发中也很少直接调用，但是当我们将对象当做原始值来使用时会发生转换，而且转换过程还略微有点迷糊。","keywords":[],"articleBody":"valueOf和toString是Object.prototype的方法。一般很少直接调用，但是在使用对象参与运算的时候就会调用这两个方法了。我想大部分人都存在以下疑问：\nvalueOf和toString哪个优先级较高? 是不是所有场景都会调用valueOf和toString 概念解释 valueOf: 返回对象的原始值表示 toString: 返回对象的字符串表示 在介绍下面的内容之前先了解一下转换规则，下面的内容解释都是基于这个规则表来的：\nvalueOf转换规则 valueOf是Object.prototype的方法，由Object来的对象都会有该方法，但是很多内置对象会重写这个方法，以适合实际需要。\n说到原始值就必须说到原始类型，JS规范中 原始类型 如下：\nBoolean Null Undefined Number String 非原始值(也就是对象)重写规则如下：\n对象 valueOf返回值 Array 数组本身 Boolean 布尔值 Date 返回毫秒形式的时间戳 Function 函数本身 Number 数字值 Object 对象本身 String 字符串值 以下规则是经过验证的，如果对验证过程不关心，可以只看转换规则。\n建议看一下验证过程，这样可以加深理解\n对象转换为布尔值 直接转换为true（包装类型也一样），不调用valueOf和toString 对象转换为数字 在预期会将对象用作数字使用时，比如参与算术运算等等操作，对象转换为数字会依次调用valueOf和toString方法，具体规则如下：\n如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字 转换失败，抛出TypeError 对象转换为字符串 如果对象具有toString方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 如果对象具有valueOf方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串 转换失败，抛出TypeError toString转换规则 对象 toString返回值 Array 以逗号分割的字符串，如[1,2]的toString返回值为\"1,2\" Boolean “True” Date 可读的时间字符串，如\"Tue Oct 15 2019 12:20:56 GMT+0800 (中国标准时间)\" Function 声明函数的JS源代码字符串 Number “数字值” Object “[object Object]” String “字符串” 验证对象到原始值的转换 光看valueOf和toString没啥东西可说，日常开发中也很少直接调用，但是当我们将对象当做原始值来使用时会发生转换，而且转换过程还略微有点迷糊。\n对象转换为Boolean 为了能够直观的看到JS内部的转换过程，我把valueOf和toString都简单重写了，加了日志。\n// 保存原始的valueOf var valueOf = Object.prototype.valueOf; var toString = Object.prototype.toString; // 添加valueOf日志 Object.prototype.valueOf = function () { console.log('valueOf'); return valueOf.call(this); }; // 添加toString日志 Object.prototype.toString = function () { console.log('toString'); return toString.call(this); }; var a = {}; var b = new Boolean(false); if (a) { console.log(1); } if(b) { console.log(2); } 以上例子的输出如下：\n1 2 未调用valueOf和toString，符合[对象到布尔值]的转换规则\n对象转换为Number 例子1 // 保存原始的valueOf var valueOf = Object.prototype.valueOf; var toString = Object.prototype.toString; // 添加valueOf日志 Object.prototype.valueOf = function() { console.log('valueOf'); return valueOf.call(this); }; // 添加toString日志 Object.prototype.toString = function() { console.log('toString'); return toString.call(this); }; var a = {}; console.log(++a); 输出如下：\nvalueOf toString NaN 分析 valueOf方法返回的是对象本身，不是原始值，继续执行 toString方法返回的是\"[object Object]\"，是原始值(字符串)，将字符串转换为数字NaN 例子2 // 保存原始的valueOf var valueOf = Object.prototype.valueOf; var toString = Object.prototype.toString; // 添加valueOf日志 Object.prototype.valueOf = function () { console.log('valueOf'); return \"1\"; // 强制返回原始值 }; // 添加toString日志 Object.prototype.toString = function () { console.log('toString'); return toString.call(this); }; var a = {}; console.log(++a); 输出如下：\nvalueOf 2 分析 valueOf返回原始值(字符串)，直接将该字符串转换为数字，得到1 对象转换为字符串 在预期会将对象用作字符串时，比如一个字符串拼接了字符串，传入了一个对象，此时会发生转换。\n// 保存原始的valueOf var valueOf = Object.prototype.valueOf; var toString = Object.prototype.toString; // 添加valueOf日志 Object.prototype.valueOf = function () { console.log('valueOf'); return valueOf.call(this); }; // 添加toString日志 Object.prototype.toString = function () { console.log('toString'); return toString.call(this); }; var a = {}; alert(a); 输出如下：\ntoString // 弹出[object Object] 分析 调用toString方法，返回了字符串\"[object Object]\"，对象最终转换为该字符串 例子2 // 保存原始的valueOf var valueOf = Object.prototype.valueOf; var toString = Object.prototype.toString; // 添加valueOf日志 Object.prototype.valueOf = function () { console.log('valueOf'); return valueOf.call(this); }; // 添加toString日志 Object.prototype.toString = function () { console.log('toString'); return this; }; var a = {}; alert(a); 输出如下：\ntoString valueOf Uncaught TypeError: Cannot convert object to primitive value at 1.js:16 分析 调用toString方法，返回的不是原始值，继续执行 调用valueOf方法，返回的不是原始值，继续执行 抛出TypeError ##【番外】使用加号运算符连接字符串和对象时的处理\n在测试对象到字符串转换时发现如下代码的表现和预期并不一致：\n// 保存原始的valueOf var valueOf = Object.prototype.valueOf; var toString = Object.prototype.toString; // 添加valueOf日志 Object.prototype.valueOf = function () { console.log('valueOf'); return valueOf.call(this); }; // 添加toString日志 Object.prototype.toString = function () { console.log('toString'); return toString.call(this); }; console.log(\"a\" + {}); 输出如下：\nvalueOf toString a[object Object] 疑问 \"a\"+ {} 应该是预期把{}当做字符串使用，应该先调用toString方法的，实际情况却不是这样。\n结论 通过查找资料得到的结论如下：\n如果有一个是对象，则遵循对象对原始值的转换过程(Date对象直接调用toString完成转换，其他对象通过valueOf转化，如果转换不成功则调用toString) 如果两个都是对象，两个对象都遵循步骤1转换到字符串 两个数字，进行算数运算 两个字符串，直接拼接 一个字符串一个数字，直接拼接为字符串 面试题 var a = {}; var b = {}; var c = {}; c[a] = 1; c[b] = 2; console.log(c[a]); console.log(c[b]); 题解 由于对象的key是字符串，所以c[a]和c[b]中的a和b会执行[对象到字符串]的转换。\n根据转换规则, a和b都转换为了[object Object]，所以c[a]和c[b]操作的是同一个键。\n答案是输出两个2，c对象的最终结构如下：\n{ '[object Object]':2 } ","wordCount":"407","inLanguage":"en","datePublished":"2019-10-15T12:00:00Z","dateModified":"2019-10-15T12:00:00Z","author":{"@type":"Person","name":"Lei Xia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ddhigh.com/2019/10/15/valueof-and-tostring/"},"publisher":{"@type":"Organization","name":"Lei Xia","logo":{"@type":"ImageObject","url":"https://www.ddhigh.com/favicon.ico"}}}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.5dd042a107aa191c819948e5648b04844bec5bdd365fdcf2b880177ce3d89b79.css integrity="sha256-XdBCoQeqGRyBmUjlZIsEhEvsW902X9zyuIAXfOPYm3k=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>$darkModeInit.Content|safeJS</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EC3XLVSGKV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EC3XLVSGKV")</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/books>Books</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>Guestbook</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>聊一聊valueOf和toString</h1></header><p><small>October 15, 2019&nbsp;· 407 words&nbsp;· 2 min</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#概念解释>概念解释</a><ul><li><a href=#valueof转换规则>valueOf转换规则</a></li><li><a href=#tostring转换规则>toString转换规则</a></li></ul></li><li><a href=#验证对象到原始值的转换>验证对象到原始值的转换</a><ul><li><a href=#对象转换为boolean>对象转换为Boolean</a></li><li><a href=#对象转换为number>对象转换为Number</a></li><li><a href=#对象转换为字符串-1>对象转换为字符串</a></li><li><a href=#疑问>疑问</a></li><li><a href=#结论>结论</a></li></ul></li><li><a href=#面试题>面试题</a><ul><li><a href=#题解>题解</a></li></ul></li></ul></nav></div><section class=blog-content><p>valueOf和toString是Object.prototype的方法。一般很少直接调用，但是在使用对象参与运算的时候就会调用这两个方法了。我想大部分人都存在以下疑问：</p><ul><li>valueOf和toString哪个优先级较高?</li><li>是不是所有场景都会调用valueOf和toString</li></ul><h2 id=概念解释>概念解释</h2><ul><li>valueOf: 返回对象的原始值表示</li><li>toString: 返回对象的字符串表示</li></ul><p>在介绍下面的内容之前先了解一下转换规则，下面的内容解释都是基于这个规则表来的：</p><h3 id=valueof转换规则>valueOf转换规则</h3><p>valueOf是Object.prototype的方法，由Object来的对象都会有该方法，但是很多内置对象会重写这个方法，以适合实际需要。</p><p>说到原始值就必须说到原始类型，JS规范中 <strong>原始类型</strong> 如下：</p><ul><li>Boolean</li><li>Null</li><li>Undefined</li><li>Number</li><li>String</li></ul><p>非原始值(也就是对象)重写规则如下：</p><table><thead><tr><th>对象</th><th>valueOf返回值</th></tr></thead><tbody><tr><td>Array</td><td>数组本身</td></tr><tr><td>Boolean</td><td>布尔值</td></tr><tr><td>Date</td><td>返回毫秒形式的时间戳</td></tr><tr><td>Function</td><td>函数本身</td></tr><tr><td>Number</td><td>数字值</td></tr><tr><td>Object</td><td>对象本身</td></tr><tr><td>String</td><td>字符串值</td></tr></tbody></table><blockquote><p>以下规则是经过验证的，如果对验证过程不关心，可以只看转换规则。</p><p>建议看一下验证过程，这样可以加深理解</p></blockquote><h4 id=对象转换为布尔值>对象转换为布尔值</h4><ol><li>直接转换为true（包装类型也一样），不调用valueOf和toString</li></ol><h4 id=对象转换为数字>对象转换为数字</h4><p>在预期会将对象用作数字使用时，比如参与算术运算等等操作，对象转换为数字会依次调用valueOf和toString方法，具体规则如下：</p><ol><li>如果对象具有<code>valueOf</code>方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字</li><li>如果对象具有<code>toString</code>方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为数字(转换失败会返回NaN)，并返回这个数字</li><li>转换失败，抛出TypeError</li></ol><h4 id=对象转换为字符串>对象转换为字符串</h4><ol><li>如果对象具有<code>toString</code>方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串</li><li>如果对象具有<code>valueOf</code>方法且返回原始值(string、number、boolean、undefined、null)，则将该原始值转换为字符串，并返回该字符串</li><li>转换失败，抛出TypeError</li></ol><h3 id=tostring转换规则>toString转换规则</h3><table><thead><tr><th>对象</th><th>toString返回值</th></tr></thead><tbody><tr><td>Array</td><td>以逗号分割的字符串，如[1,2]的toString返回值为"1,2"</td></tr><tr><td>Boolean</td><td>&ldquo;True&rdquo;</td></tr><tr><td>Date</td><td>可读的时间字符串，如"Tue Oct 15 2019 12:20:56 GMT+0800 (中国标准时间)"</td></tr><tr><td>Function</td><td>声明函数的JS源代码字符串</td></tr><tr><td>Number</td><td>&ldquo;数字值&rdquo;</td></tr><tr><td>Object</td><td>&ldquo;[object Object]&rdquo;</td></tr><tr><td>String</td><td>&ldquo;字符串&rdquo;</td></tr></tbody></table><h2 id=验证对象到原始值的转换>验证对象到原始值的转换</h2><p>光看valueOf和toString没啥东西可说，日常开发中也很少直接调用，但是当我们将对象当做原始值来使用时会发生转换，而且转换过程还略微有点迷糊。</p><h3 id=对象转换为boolean>对象转换为Boolean</h3><p>为了能够直观的看到JS内部的转换过程，我把valueOf和toString都简单重写了，加了日志。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 保存原始的valueOf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加valueOf日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;valueOf&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>valueOf</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加toString日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;toString&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>toString</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Boolean(<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>a</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>b</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>以上例子的输出如下：</p><pre tabindex=0><code>1
2
</code></pre><blockquote><p>未调用valueOf和toString，符合[对象到布尔值]的转换规则</p></blockquote><h3 id=对象转换为number>对象转换为Number</h3><h4 id=例子1>例子1</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 保存原始的valueOf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加valueOf日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;valueOf&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>valueOf</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加toString日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;toString&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>toString</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#f92672>++</span><span style=color:#a6e22e>a</span>);
</span></span></code></pre></div><p>输出如下：</p><pre tabindex=0><code>valueOf
toString
NaN
</code></pre><h4 id=分析>分析</h4><ol><li>valueOf方法返回的是对象本身，不是原始值，继续执行</li><li>toString方法返回的是"[object Object]"，是原始值(字符串)，将字符串转换为数字NaN</li></ol><h4 id=例子2>例子2</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 保存原始的valueOf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加valueOf日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;valueOf&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;1&#34;</span>; <span style=color:#75715e>// 强制返回原始值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加toString日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;toString&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>toString</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#f92672>++</span><span style=color:#a6e22e>a</span>);
</span></span></code></pre></div><p>输出如下：</p><pre tabindex=0><code>valueOf
2
</code></pre><h4 id=分析-1>分析</h4><ol><li>valueOf返回原始值(字符串)，直接将该字符串转换为数字，得到1</li></ol><h3 id=对象转换为字符串-1>对象转换为字符串</h3><p>在预期会将对象用作字符串时，比如一个字符串拼接了字符串，传入了一个对象，此时会发生转换。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 保存原始的valueOf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加valueOf日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;valueOf&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>valueOf</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加toString日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;toString&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>toString</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>a</span>);
</span></span></code></pre></div><p>输出如下：</p><pre tabindex=0><code>toString
// 弹出[object Object]
</code></pre><h4 id=分析-2>分析</h4><ol><li>调用toString方法，返回了字符串"[object Object]"，对象最终转换为该字符串</li></ol><h4 id=例子2-1>例子2</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 保存原始的valueOf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加valueOf日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;valueOf&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>valueOf</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加toString日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;toString&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>a</span>);
</span></span></code></pre></div><p>输出如下：</p><pre tabindex=0><code>toString
valueOf
Uncaught TypeError: Cannot convert object to primitive value
    at 1.js:16
</code></pre><h4 id=分析-3>分析</h4><ol><li>调用toString方法，返回的不是原始值，继续执行</li><li>调用valueOf方法，返回的不是原始值，继续执行</li><li>抛出TypeError</li></ol><p>##【番外】使用加号运算符连接字符串和对象时的处理</p><p>在测试对象到字符串转换时发现如下代码的表现和预期并不一致：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 保存原始的valueOf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加valueOf日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>valueOf</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;valueOf&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>valueOf</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#75715e>// 添加toString日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;toString&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>toString</span>.<span style=color:#a6e22e>call</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;a&#34;</span> <span style=color:#f92672>+</span> {});
</span></span></code></pre></div><p>输出如下：</p><pre tabindex=0><code>valueOf
toString
a[object Object]
</code></pre><h3 id=疑问>疑问</h3><p><code>"a"+ {}</code> 应该是预期把<code>{}</code>当做字符串使用，应该先调用toString方法的，实际情况却不是这样。</p><h3 id=结论>结论</h3><p>通过查找资料得到的结论如下：</p><ol><li>如果有一个是对象，则遵循对象对原始值的转换过程(Date对象直接调用toString完成转换，其他对象通过valueOf转化，如果转换不成功则调用toString)</li><li>如果两个都是对象，两个对象都遵循步骤1转换到字符串</li><li>两个数字，进行算数运算</li><li>两个字符串，直接拼接</li><li>一个字符串一个数字，直接拼接为字符串</li></ol><h2 id=面试题>面试题</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#a6e22e>c</span>[<span style=color:#a6e22e>a</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>c</span>[<span style=color:#a6e22e>b</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>c</span>[<span style=color:#a6e22e>a</span>]);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>c</span>[<span style=color:#a6e22e>b</span>]);
</span></span></code></pre></div><h3 id=题解>题解</h3><p>由于对象的key是字符串，所以<code>c[a]</code>和<code>c[b]</code>中的<code>a</code>和<code>b</code>会执行[对象到字符串]的转换。</p><p>根据转换规则, <code>a</code>和<code>b</code>都转换为了<code>[object Object]</code>，所以<code>c[a]</code>和<code>c[b]</code>操作的是同一个键。</p><p>答案是<code>输出两个2</code>，c对象的最终结构如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;[object Object]&#39;</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><img alt=0.jpeg src=https://static.ddhigh.com/blog/2019-10-15-093620.jpg></p><p><img alt=image-20210225113209566 src=https://static.ddhigh.com/blog/2021-02-25-113209-2.png></p></section><div class=paginator><a class=prev href=https://www.ddhigh.com/2019/10/22/let-and-const/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>不只是块级作用域，你不知道的let和const</span></a>
<a class=next href=https://www.ddhigh.com/2019/10/14/js-closure/><span>搞懂JS闭包</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","xialeistudio/discussion"),s.setAttribute("data-repo-id","R_kgDOKurTRA"),s.setAttribute("data-category","General"),s.setAttribute("data-category-id","DIC_kwDOKurTRM4CbCJt"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","en"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></div><footer class=footer><p>&copy; 2014 - 2024 <a href=https://www.ddhigh.com/>Lei Xia</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>