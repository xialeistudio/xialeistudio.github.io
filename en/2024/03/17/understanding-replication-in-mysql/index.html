<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Understanding Replication In MySQL</title>
<meta charset=utf-8><meta name=google-adsense-account content="ca-pub-2871082647721658"><meta content="Web ,Java ,Go ,Node.js ,PHP ,Koa ,MySQL ,Redis ,front-end ,back-end ,database" name=keywords><meta name=description content="MySQL Replication is a process where data from one MySQL database known as the master is copied over to one or more other databases called replicas or slaves. In this article, we&rsquo;ll learn what replication is, how to enable replication,  replication modes and replication forms."><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/en/2024/03/17/understanding-replication-in-mysql/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com//index.xml title=每天进步一点点><script async defer data-website-id=52f8f0f9-d93d-466b-8ef5-508aae8c4ed4 src=https://analysis.ddhigh.com/script.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EC3XLVSGKV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EC3XLVSGKV")</script><meta property="og:url" content="https://www.ddhigh.com/en/2024/03/17/understanding-replication-in-mysql/"><meta property="og:site_name" content="每天进步一点点"><meta property="og:title" content="Understanding Replication In MySQL"><meta property="og:description" content="MySQL Replication is a process where data from one MySQL database known as the master is copied over to one or more other databases called replicas or slaves. In this article, we’ll learn what replication is, how to enable replication, replication modes and replication forms."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-17T12:26:50+08:00"><meta property="article:modified_time" content="2024-03-17T12:26:50+08:00"><meta property="article:tag" content="Mysql"><meta property="og:see_also" content="https://www.ddhigh.com/en/2024/03/09/understanding-mvcc-in-mysql-innodb/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Understanding Replication In MySQL"><meta name=twitter:description content="MySQL Replication is a process where data from one MySQL database known as the master is copied over to one or more other databases called replicas or slaves. In this article, we&rsquo;ll learn what replication is, how to enable replication,  replication modes and replication forms."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.ddhigh.com/en/posts/"},{"@type":"ListItem","position":2,"name":"Understanding Replication In MySQL","item":"https://www.ddhigh.com/en/2024/03/17/understanding-replication-in-mysql/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Understanding Replication In MySQL","name":"Understanding Replication In MySQL","description":"MySQL Replication is a process where data from one MySQL database known as the master is copied over to one or more other databases called replicas or slaves. In this article, we\u0026rsquo;ll learn what replication is, how to enable replication, replication modes and replication forms.\n","keywords":["mysql"],"articleBody":"MySQL Replication is a process where data from one MySQL database known as the master is copied over to one or more other databases called replicas or slaves. In this article, we’ll learn what replication is, how to enable replication, replication modes and replication forms.\nWhat is replication in MySQL? MySQL replication refers to the transfer of data from one MySQL server (master) to another MySQL server or multiple MySQL servers through the network by logs, and then replay the transferred logs on the slave to achieve the purpose of synchronization with the master data.\nThe working principle of replication is quite simple. Let’s take a look.\nIn order to enable replication, it is necessary for the MySQL master to enable the binlog feature.\nOn the slave server, the change master to command needs to be executed along with relevant context information such as the binlog filename and offset.\nThe slave server consists of two threads: the I/O thread and the SQL thread.\nThe I/O thread is responsible for establishing a connection with the master server and receiving the binlog data. Once the I/O thread successfully connects to the master, the master server initiates a “dump thread” which retrieves the requested binlog data. The I/O thread then copies and saves this binlog data to its own relay log.\nThe SQL thread is responsible for reading and replaying the data stored in the relay log. It processes the data and writes it to the slave server’s own database.\nReplication Forms Typically, there are the following forms in replication, each form has its scenes to be used.\nMaster to slave Master to master Cascading Master to slave Master-slave replication is the most commonly used replication mode. As shown in the figure, we have 1 master server and 3 slave servers. The slave servers are responsible for sharing the read load, data analysis and data backup functions of the master server.\nMaster to master MySQL Master-Master Replication is a database replication mode in which two or more MySQL servers can act as master servers and slave servers for each other to achieve two-way synchronization of data.\nCascading Cascading replication is the master server, which only synchronizes data to one slave server, and then the slave server synchronizes data to all slave servers in the backend, reducing the write pressure of the master server and the network IO of copying data.\nReplication Modes There are 3 replication modes in MySQL:\nAsynchronous replication Semi-synchronous replication Synchronous replication Asynchronous replication Asynchronous replication is the default mode in MySQL.The integrity of the data depends on the binlog of the master database. As long as the binlog of the main database is not lost, even if the master database is down, we can still manually synchronize the lost part of the data to the slave database through binlog.\nIn asynchronous replication mode, the master generates binlog and synchronizes it to all slaves, and then directly commits the transaction. Asynchronous replication has the highest performance, but if the master server crashes before receiving the binlog from the slave server, data will be lost.\nSemi-synchronous replication After the master completes the transaction submitted by the client, it must wait for at least one slave to receive the binlog and write the data to the relay log before returning a successful result to the client. The semi-synchronous replication mode improves data availability compared to the asynchronous mode, but it also produces a certain performance delay, which requires at least the round-trip time of a TCP/IP connection.\nSynchronous replication After the master completes a transaction, all slaves are required to complete the transaction before the processing results can be returned to the client. Therefore, although the data consistency of fully synchronous replication is guaranteed, the master needs to wait for all slaves to complete a transaction, and the performance will be relatively low.\nHow to enable MySQL replication? Modify the configuration of master:\n#Main database ID number server_id = 1 #Enable binary log log-bin = mysql-bin Restart the master and create a replication account:\ngrant replication slave on *.* to 'ACCOUNT_NAME'@'SLAVE_HOST' identified by 'ACCOUNT_PASSWORD'; flush privileges; Check the status of master:\nshow master status\\G; ***************** 1. row **************** File: mysql-bin.00001 Position: 10000 Modify the configuration of slave:\nserver_id = 2 # choose a different server_id to master log-bin = mysql-bin Initialize replication on slave:\nchange master to master_host='MASTER_HOST',master_user='ACCOUNT_NAME',master_password='ACCOUNT_PASSWORD',master_log_file='mysql-bin.00001',master_log_pos=10000; start slave; Check the status of slave:\nshow slave status\\G; *************************** 1. row *************************** Slave_IO_State: Waiting for master to send event Master_Host: Master_User: Master_Port: 3306 Connect_Retry: 60 Master_Log_File: mysql-bin.00001 Read_Master_Log_Pos: 10000 Relay_Log_File: db2-relay-bin.00002 Relay_Log_Pos: 10000 Relay_Master_Log_File: mysql-bin.00001 Slave_IO_Running: Yes Slave_SQL_Running: Yes Replicate_Do_DB: Replicate_Ignore_DB: When both Slave_IO_Running and Slave_SQL_Running are running, replication works normally, otherwise the cause needs to be investigated.\nCanal Sometimes, we need to synchronize mysql data to other data systems, such as ElasticSearch. The traditional way is to write business code in MySQL and ElasticSearch at the same time, which is intrusive to the business code. Alibaba’s open source Canal solves this problem. Canal is forged as a slave, uses the MySQL synchronization protocol to interact with the master, and sends the master’s data to message queues, such as Kafka, Pulsar, etc.\nNote: Canal requires master server uses the ROW binlog-format.\nbinlog-format MySQL supports three binlog formats:\nStatement: In this format, every SQL statement that modifies data is recorded in the binlog. Row: In Row format, only the data modifications are saved in the binlog, without recording the SQL statements. Mixed: Mixed format is a combination of Statement and Row formats. Statement Format\nIn Statement format, only the executed SQL statements are recorded in the binlog. It reduces the amount of binlog logs, minimizes IO operations, and improves system performance.\nHowever, a drawback of the Statement format is that it only records the SQL statements, not the actual changes made to the data. This can lead to inconsistencies if certain SQL statements contain functions or non-deterministic operations. For example, if the uuid() function is used, it generates a random string each time it is executed. As a result, the UUID recorded in the master may differ from the one generated when the statement is executed on the slave, causing data inconsistency.\nRow Format\nIn Row format, each row of data modifications is recorded in the binlog. This provides a more detailed and accurate representation of the changes made.\nHowever, the Row format has the drawback of generating a large amount of binlog data, especially for operations like batch updates, table-wide deletions, and alter table statements. Since every change in each row of data needs to be recorded, it can lead to a significant increase in log size and potential IO performance issues.\nMixed Format\nMixed format is a combination of Statement and Row formats. In Mixed mode, the system automatically determines whether to use Statement or Row format based on the type of operation. Generally, statement modifications use Statement format to save binlog, but for certain operations that cannot be accurately replicated using Statement format, Row format is used to ensure the accuracy of binlog.\nConclusion In conclusion, MySQL replication is a powerful feature that allows data to be transferred from one MySQL server to another, enabling synchronization between multiple databases. Replication can be configured in different forms, such as master-slave, master-master, and cascading, each with its own use cases and benefits.\nThere are also different replication modes available, including asynchronous, semi-synchronous, and synchronous replication. These modes provide varying levels of data consistency and performance, allowing users to choose the option that best suits their requirements.\nIn addition to native MySQL replication, tools like Canal can be used to synchronize MySQL data with other data systems, such as ElasticSearch. Canal acts as a slave and leverages the MySQL synchronization protocol to capture and send data changes to message queues.\nOverall, understanding MySQL replication and its various aspects, including forms, modes, configuration, and binlog formats, empowers database administrators and developers to design robust and scalable systems that meet their specific needs.\n","wordCount":"1328","inLanguage":"en","datePublished":"2024-03-17T12:26:50+08:00","dateModified":"2024-03-17T12:26:50+08:00","author":{"@type":"Person","name":"Lei Xia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ddhigh.com/en/2024/03/17/understanding-replication-in-mysql/"},"publisher":{"@type":"Organization","name":"每天进步一点点","logo":{"@type":"ImageObject","url":"https://www.ddhigh.com/favicon.ico"}}}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.d0df733b91ef046970ecd63de7aa626886fd263fd3fb2b8ff28b560e505831f7.css integrity="sha256-0N9zO5HvBGlw7NY956piaIb9Jj/T+yuP8otWDlBYMfc=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css integrity="sha512-ygEyjMC6rqnzJqWGjRTJUPYMEs9JUOm3i7OWUS9CgQ4XkBUvMsgCS1I8JqavidQ2ClHcREB7IbA2mN08+r9Elg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>$darkModeInit.Content|safeJS</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2871082647721658" crossorigin=anonymous></script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/en>DayDayUP
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/en/>Home</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/en/archives>Archives</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/en/books>Books</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/en/guestbook>Guestbook</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li><li class="navigation-item navigation-language"><a href=https://www.ddhigh.com/>中</a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>Understanding Replication In MySQL</h1></header><p><small>March 17, 2024&nbsp;· 1328 words&nbsp;· 7 min</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#what-is-replication-in-mysql>What is replication in MySQL?</a></li><li><a href=#replication-forms>Replication Forms</a><ul><li><a href=#master-to-slave>Master to slave</a></li><li><a href=#master-to-master>Master to master</a></li><li><a href=#cascading>Cascading</a></li></ul></li><li><a href=#replication-modes>Replication Modes</a><ul><li><a href=#asynchronous-replication>Asynchronous replication</a></li><li><a href=#semi-synchronous-replication>Semi-synchronous replication</a></li><li><a href=#synchronous-replication>Synchronous replication</a></li></ul></li><li><a href=#how-to-enable-mysql-replication>How to enable MySQL replication?</a></li><li><a href=#canal>Canal</a><ul><li><a href=#binlog-format>binlog-format</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><section class=blog-content><p>MySQL Replication is a process where data from one MySQL database known as the master is copied over to one or more other databases called replicas or slaves. In this article, we&rsquo;ll learn what replication is, how to enable replication, replication modes and replication forms.</p><h2 id=what-is-replication-in-mysql>What is replication in MySQL?</h2><p>MySQL replication refers to the transfer of data from one MySQL server (master) to another MySQL server or multiple MySQL servers through the network by logs, and then replay the transferred logs on the slave to achieve the purpose of synchronization with the master data.</p><p>The working principle of replication is quite simple. Let&rsquo;s take a look.</p><p><img alt=img src=https://raw.githubusercontent.com/xialeistudio/picture-bucket/main/blog/How-MySQL-replication-works.png></p><ol><li><p>In order to enable replication, it is necessary for the MySQL master to enable the binlog feature.</p></li><li><p>On the slave server, the <code>change master to</code> command needs to be executed along with relevant context information such as the binlog filename and offset.</p></li><li><p>The slave server consists of two threads: the I/O thread and the SQL thread.</p><ol><li><p>The I/O thread is responsible for establishing a connection with the master server and receiving the binlog data. Once the I/O thread successfully connects to the master, the master server initiates a &ldquo;dump thread&rdquo; which retrieves the requested binlog data. The I/O thread then copies and saves this binlog data to its own relay log.</p></li><li><p>The SQL thread is responsible for reading and replaying the data stored in the relay log. It processes the data and writes it to the slave server&rsquo;s own database.</p></li></ol></li></ol><h2 id=replication-forms>Replication Forms</h2><p>Typically, there are the following forms in replication, each form has its scenes to be used.</p><ol><li>Master to slave</li><li>Master to master</li><li>Cascading</li></ol><h3 id=master-to-slave>Master to slave</h3><p><img alt=image-20240317144844930 src=https://raw.githubusercontent.com/xialeistudio/picture-bucket/main/blog/image-20240317144844930.png></p><p>Master-slave replication is the most commonly used replication mode. As shown in the figure, we have 1 master server and 3 slave servers. The slave servers are responsible for sharing the read load, data analysis and data backup functions of the master server.</p><h3 id=master-to-master>Master to master</h3><p><img alt=image-20240317150446310 src=https://raw.githubusercontent.com/xialeistudio/picture-bucket/main/blog/image-20240317150446310.png></p><p>MySQL Master-Master Replication is a database replication mode in which two or more MySQL servers can act as master servers and slave servers for each other to achieve two-way synchronization of data.</p><h3 id=cascading>Cascading</h3><p><img alt=image-20240317151413253 src=https://raw.githubusercontent.com/xialeistudio/picture-bucket/main/blog/image-20240317151413253.png></p><p>Cascading replication is the master server, which only synchronizes data to one slave server, and then the slave server synchronizes data to all slave servers in the backend, reducing the write pressure of the master server and the network IO of copying data.</p><h2 id=replication-modes>Replication Modes</h2><p>There are 3 replication modes in MySQL:</p><ul><li>Asynchronous replication</li><li>Semi-synchronous replication</li><li>Synchronous replication</li></ul><h3 id=asynchronous-replication>Asynchronous replication</h3><p>Asynchronous replication is the default mode in MySQL.The integrity of the data depends on the binlog of the master database. As long as the binlog of the main database is not lost, even if the master database is down, we can still manually synchronize the lost part of the data to the slave database through binlog.</p><p><img alt=image-20240317153250136 src=https://raw.githubusercontent.com/xialeistudio/picture-bucket/main/blog/image-20240317153250136.png></p><p>In asynchronous replication mode, the master generates binlog and synchronizes it to all slaves, and then directly commits the transaction.
Asynchronous replication has the highest performance, but if the master server crashes before receiving the binlog from the slave server, data will be lost.</p><h3 id=semi-synchronous-replication>Semi-synchronous replication</h3><p><img alt=image-20240317153940888 src=https://raw.githubusercontent.com/xialeistudio/picture-bucket/main/blog/image-20240317153940888.png></p><p>After the master completes the transaction submitted by the client, it must wait for at least one slave to receive the binlog and write the data to the relay log before returning a successful result to the client. The semi-synchronous replication mode improves data availability compared to the asynchronous mode, but it also produces a certain performance delay, which requires at least the round-trip time of a TCP/IP connection.</p><h3 id=synchronous-replication>Synchronous replication</h3><p><img alt=image-20240317154302087 src=https://raw.githubusercontent.com/xialeistudio/picture-bucket/main/blog/image-20240317154302087.png></p><p>After the master completes a transaction, all slaves are required to complete the transaction before the processing results can be returned to the client. Therefore, although the data consistency of fully synchronous replication is guaranteed, the master needs to wait for all slaves to complete a transaction, and the performance will be relatively low.</p><h2 id=how-to-enable-mysql-replication>How to enable MySQL replication?</h2><ol><li><p>Modify the configuration of master:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#Main database ID number
</span></span><span style=display:flex><span>server_id = 1
</span></span><span style=display:flex><span>#Enable binary log
</span></span><span style=display:flex><span>log-bin = mysql-bin
</span></span></code></pre></div></li><li><p>Restart the master and create a replication account:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>grant</span> replication slave <span style=color:#66d9ef>on</span> <span style=color:#f92672>*</span>.<span style=color:#f92672>*</span> <span style=color:#66d9ef>to</span> <span style=color:#e6db74>&#39;ACCOUNT_NAME&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;SLAVE_HOST&#39;</span> identified <span style=color:#66d9ef>by</span> <span style=color:#e6db74>&#39;ACCOUNT_PASSWORD&#39;</span>;
</span></span><span style=display:flex><span>flush <span style=color:#66d9ef>privileges</span>;
</span></span></code></pre></div></li><li><p>Check the status of master:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>show</span> master status<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#66d9ef>G</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>*****************</span> <span style=color:#ae81ff>1</span>. <span style=color:#66d9ef>row</span> <span style=color:#f92672>****************</span>
</span></span><span style=display:flex><span>            File: mysql<span style=color:#f92672>-</span>bin.<span style=color:#ae81ff>00001</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Position</span>: <span style=color:#ae81ff>10000</span>
</span></span></code></pre></div></li><li><p>Modify the configuration of slave:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>server_id = 2 # choose a different server_id to master
</span></span><span style=display:flex><span>log-bin = mysql-bin
</span></span></code></pre></div></li><li><p>Initialize replication on slave:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>change master <span style=color:#66d9ef>to</span> master_host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;MASTER_HOST&#39;</span>,master_user<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ACCOUNT_NAME&#39;</span>,master_password<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ACCOUNT_PASSWORD&#39;</span>,master_log_file<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;mysql-bin.00001&#39;</span>,master_log_pos<span style=color:#f92672>=</span><span style=color:#ae81ff>10000</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>start</span> slave;
</span></span></code></pre></div></li><li><p>Check the status of slave:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>show</span> slave status<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#66d9ef>G</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>***************************</span> <span style=color:#ae81ff>1</span>. <span style=color:#66d9ef>row</span> <span style=color:#f92672>***************************</span>
</span></span><span style=display:flex><span>               Slave_IO_State: Waiting <span style=color:#66d9ef>for</span> master <span style=color:#66d9ef>to</span> send event
</span></span><span style=display:flex><span>                  Master_Host: 
</span></span><span style=display:flex><span>                  Master_User: 
</span></span><span style=display:flex><span>                  Master_Port: <span style=color:#ae81ff>3306</span>
</span></span><span style=display:flex><span>                Connect_Retry: <span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span>              Master_Log_File: mysql<span style=color:#f92672>-</span>bin.<span style=color:#ae81ff>00001</span>
</span></span><span style=display:flex><span>          Read_Master_Log_Pos: <span style=color:#ae81ff>10000</span>
</span></span><span style=display:flex><span>               Relay_Log_File: db2<span style=color:#f92672>-</span>relay<span style=color:#f92672>-</span>bin.<span style=color:#ae81ff>00002</span>
</span></span><span style=display:flex><span>                Relay_Log_Pos: <span style=color:#ae81ff>10000</span>
</span></span><span style=display:flex><span>        Relay_Master_Log_File: mysql<span style=color:#f92672>-</span>bin.<span style=color:#ae81ff>00001</span>
</span></span><span style=display:flex><span>             Slave_IO_Running: Yes
</span></span><span style=display:flex><span>            Slave_SQL_Running: Yes
</span></span><span style=display:flex><span>              Replicate_Do_DB:
</span></span><span style=display:flex><span>          Replicate_Ignore_DB:
</span></span></code></pre></div><p>When both Slave_IO_Running and Slave_SQL_Running are running, replication works normally, otherwise the cause needs to be investigated.</p></li></ol><h2 id=canal>Canal</h2><p>Sometimes, we need to synchronize mysql data to other data systems, such as ElasticSearch. The traditional way is to write business code in MySQL and ElasticSearch at the same time, which is intrusive to the business code.
Alibaba&rsquo;s open source Canal solves this problem. Canal is forged as a slave, uses the MySQL synchronization protocol to interact with the master, and sends the master&rsquo;s data to message queues, such as Kafka, Pulsar, etc.</p><p><em>Note: Canal requires master server uses the ROW binlog-format.</em></p><p><img alt=img src=https://raw.githubusercontent.com/xialeistudio/picture-bucket/main/blog/1412331-20200313004331754-32441425.png></p><h3 id=binlog-format>binlog-format</h3><p>MySQL supports three binlog formats:</p><ol><li>Statement: In this format, every SQL statement that modifies data is recorded in the binlog.</li><li>Row: In Row format, only the data modifications are saved in the binlog, without recording the SQL statements.</li><li>Mixed: Mixed format is a combination of Statement and Row formats.</li></ol><p><strong>Statement Format</strong></p><p>In Statement format, only the executed SQL statements are recorded in the binlog. It reduces the amount of binlog logs, minimizes IO operations, and improves system performance.</p><p>However, a drawback of the Statement format is that it only records the SQL statements, not the actual changes made to the data. This can lead to inconsistencies if certain SQL statements contain functions or non-deterministic operations. For example, if the <code>uuid()</code> function is used, it generates a random string each time it is executed. As a result, the UUID recorded in the master may differ from the one generated when the statement is executed on the slave, causing data inconsistency.</p><p><strong>Row Format</strong></p><p>In Row format, each row of data modifications is recorded in the binlog. This provides a more detailed and accurate representation of the changes made.</p><p>However, the Row format has the drawback of generating a large amount of binlog data, especially for operations like batch updates, table-wide deletions, and alter table statements. Since every change in each row of data needs to be recorded, it can lead to a significant increase in log size and potential IO performance issues.</p><p><strong>Mixed Format</strong></p><p>Mixed format is a combination of Statement and Row formats. In Mixed mode, the system automatically determines whether to use Statement or Row format based on the type of operation. Generally, statement modifications use Statement format to save binlog, but for certain operations that cannot be accurately replicated using Statement format, Row format is used to ensure the accuracy of binlog.</p><h2 id=conclusion>Conclusion</h2><p>In conclusion, MySQL replication is a powerful feature that allows data to be transferred from one MySQL server to another, enabling synchronization between multiple databases. Replication can be configured in different forms, such as master-slave, master-master, and cascading, each with its own use cases and benefits.</p><p>There are also different replication modes available, including asynchronous, semi-synchronous, and synchronous replication. These modes provide varying levels of data consistency and performance, allowing users to choose the option that best suits their requirements.</p><p>In addition to native MySQL replication, tools like Canal can be used to synchronize MySQL data with other data systems, such as ElasticSearch. Canal acts as a slave and leverages the MySQL synchronization protocol to capture and send data changes to message queues.</p><p>Overall, understanding MySQL replication and its various aspects, including forms, modes, configuration, and binlog formats, empowers database administrators and developers to design robust and scalable systems that meet their specific needs.</p><div class=blog-footer><div class=social-share></div><div class=copyright><ul><li style=margin-bottom:.5em>Author: <a href=https://ddhigh.com/ target=_blank style=color:#000;text-decoration:none>xialeistudio</a></li><li style=margin-bottom:.5em>Link: <a href=https://www.ddhigh.com/en/2024/03/17/understanding-replication-in-mysql/ target=_blank style=color:#000;text-decoration:none>Understanding Replication In MySQL</a></li><li>Copyright: <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank style=color:#000;text-decoration:none>「CC BY-NC 4.0 DEED」</a></li></ul></div></div></section><div class=paginator><a class=prev href=https://www.ddhigh.com/en/2024/04/24/beyond-gpt-3.5-llama3-personal-computer-local-deployment-tutorial./><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>Beyond GPT-3.5! Llama3 Personal Computer Local Deployment Tutorial.</span></a>
<a class=next href=https://www.ddhigh.com/en/2024/03/09/understanding-mvcc-in-mysql-innodb/><span>Understanding MVCC In MySQL InnoDB</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=related-resources></div><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","xialeistudio/discussion"),s.setAttribute("data-repo-id","R_kgDOKurTRA"),s.setAttribute("data-category","General"),s.setAttribute("data-category-id","DIC_kwDOKurTRM4CbCJt"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","en"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></div><footer class=footer><p>&copy; 2014 - 2024 <a href=https://www.ddhigh.com/>每天进步一点点</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script><script src=https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js integrity="sha512-9DNXrSjk17bU9MUbRp3IjwcWe46V8FaGA062PFbryPUAEQVRbz4jiZP6FW0AdbqEGtMYBDWnul3eiGBMJOQajA==" crossorigin=anonymous referrerpolicy=no-referrer></script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>