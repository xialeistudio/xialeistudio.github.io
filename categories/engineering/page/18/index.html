<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Engineering</title>
<meta charset=utf-8><meta name=description content="Ladder@Learning & Writing & Sharing"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/categories/engineering/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com/index.xml title="Lei Xia"><script async defer data-website-id=865c8529-0729-4cf5-88a9-448616abbcbb src=https://umami-beta-peach.vercel.app/xialeistudio></script><meta property="og:title" content="Engineering"><meta property="og:description" content="Learning & Writing & Sharing"><meta property="og:type" content="website"><meta property="og:url" content="https://www.ddhigh.com/categories/engineering/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Engineering"><meta name=twitter:description content="Learning & Writing & Sharing"><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.ff1bc260fafbfb440e10194d7d06d57eb5e85eed11d12d06255581262664204e.css integrity="sha256-/xvCYPr7+0QOEBlNfQbVfrXoXu0R0S0GJVWBJiZkIE4=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.894ca9c68afab956438c4926a0dc7f5293e04e08595bd27abdb123e94801f684.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/categories>Categories</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>Guestbook</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><div class=blog-wrapper><div><div class=blog-list><article><div class=blog-card><h3><a href=/2016/05/23/nginx-goddy-ssl/>nginx使用goddy ssl证书</a></h3><p><small>May 23, 2016&nbsp;· 65 words&nbsp;· One minute</small><p>随着人们对网络安全要求的提高，越来越多的http站点已经转换为了https站点，保证网站在传输过程中不被监听、恶意篡改，本文将使用goddy提供的ssl证书来升级HTTPS网站。
生成私钥和证书请求文件 终端执行
openssl req -new -newkey rsa:2048 -nodes -keyout domain.key -out domain.csr 生成过程会询问几个常见问题，比如City、Country等等。
最后会询问challenge password，输入的时候记住就可以了。
执行完以上命令后，当前目录会多出domain.key和domain.csr文件，前者为服务器私钥，后者为证书请求文件
Goddy证书 购买完SSL证书之后会有一个初始化过程，将第1步中的domain.csr文件所有内容填写到CSR输入框中，Goddy会检测配置等操作，操作完成之后会签发证书，点击下载即可，下载时服务器类型选择“其他”。
Nginx配置 下载证书的时候压缩包内容类似如下图
正常情况下nginx配置SSL需要key和crt文件即可。
这里有两个crt所以需要进行证书合并操作。
打开终端，执行以下命令：
cat 53f58e3ac2172cd5.crt gd_bundle-g2-g1.crt > domain.crt 证书合并完成，接下来打开Nginx的配置文件，笔者这里证书目录位于**/root/crt**
server { listen 443; server_name domain; index index.html index.htm default.html default.htm; root /home/wwwroot/domain; location = /favicon.ico { log_not_found off; access_log off; } ssl on; ssl_certificate /root/crt/domain.crt; ssl_certificate_key /root/crt/domain.key; access_log off; } 保存之后，终端执行
nginx -s reload</div></article><article><div class=blog-card><h3><a href=/2016/05/23/process-daemon-forever/>NodeJs进程守护工具forever使用</a></h3><p><small>May 23, 2016&nbsp;· 14 words&nbsp;· One minute</small><p>nodejs是单进程的，如果应用中发生未捕获的异常，进程就会退出，一个比较笨的办法在系统中使用计划任务检查进程是否存在，如果不存在启动该程序，但是该方式会造成系统资源的浪费，而且不是及时的。
好在NodeJs活跃的社区给开发者提供了一个选择forever，该包就是用来解决以上状况的。
安装 npm install forever -g 启动脚本 forever start app.js 查看目前监控任务 forever list</div></article><article><div class=blog-card><h3><a href=/2016/05/17/react-router-navigation-outside-of-components/>ReactRouter不在组件中进行导航</a></h3><p><small>May 17, 2016&nbsp;· 10 words&nbsp;· One minute</small><p>项目使用了Flux+React Router架构，有一些需要操作路由的地方是放在Action层的，比如登录之类，但是Action层不是React组件，需要操作路由的话有点麻烦。
当然最终还是有一个办法的，利用window.location.href=，但是既然用了react，再用这种导航模式未免不妥。
查看react router源码发现,hashHistory,browseHistory中有push方法，经过测试之后可行。
import {hashHistory} from 'react-router'; hashHistory.push('/login');</div></article><article><div class=blog-card><h3><a href=/2016/05/14/shell-install-nodejs/>安装nodejs的shell脚本</a></h3><p><small>May 14, 2016&nbsp;· 20 words&nbsp;· One minute</small><p>脚本定义 #!/bin/bash export NVM_NODEJS_ORG_MIRROR=https://npm.taobao.org/mirrors/node git clone https://github.com/creationix/nvm.git ~/.nvm source ~/.nvm/nvm.sh nvm install 4.4.2 脚本执行 chmod +x ./install.sh ./install.sh nodejs版本大家可以 根据实际需要进行选择</div></article><article><div class=blog-card><h3><a href=/2016/05/12/fix-wordpress-wpimageeditorimagick-bug/>wordpress WPImageEditorImagick 漏洞临时修复方案</a></h3><p><small>May 12, 2016&nbsp;· 25 words&nbsp;· One minute</small><p>4.5.1存在该漏洞，但是更新到4.5.2发现漏洞依旧存在。
临时修复方案如下：
文件路径：
/wp-includes/media.php的_wp_image_editor_choose 将
$implementations = apply_filters( 'wp_image_editors', array( 'WP_Image_Editor_Imagick' ,'WP_Image_Editor_GD' ) ); 改为
$implementations = apply_filters( 'wp_image_editors', array( 'WP_Image_Editor_GD', 'WP_Image_Editor_Imagick' ) ); 此方法为临时解决方案，请大家及时更新最新版本的wordpress</div></article><article><div class=blog-card><h3><a href=/2016/05/10/js-extract-chinese-words-number-of-string/>JS提取字符串中文英文数字</a></h3><p><small>May 10, 2016&nbsp;· 34 words&nbsp;· One minute</small><p>最近在做导出excel的时候，发现导出成功，文件大小也正常，但是Office 2013打不开，检查数据库发现，导出数据中有非中文字符导致Excel异常。
我们知道JS是支持unicode字符集的，符合导出规则的字符应该是"中文"、&ldquo;英文&rdquo;、&ldquo;数字&rdquo;。
正则表达式 /([\u4e00-\u9fa5\w]*)/ig 提取字符串 /** * 获得可打印字符 * @param str 需要提取的字符串 */ function getPrintableChars(str) { const matches = str.match(/([\u4e00-\u9fa5\w]*)/ig); let a = ''; matches.forEach(item=> item && (a += item)); return a; }</div></article><article><div class=blog-card><h3><a href=/2016/03/29/angularjs-display-html/>angularjs显示html文本</a></h3><p><small>March 29, 2016&nbsp;· 48 words&nbsp;· One minute</small><p>Angularjs中输出变量使用花括号或者ng-bind，但是如果变量中有html代码的话，angularjs为了xss安全，默认是不解析html，直接原样显示html代码。
如果需要显示解析后的html代码，需要使用angular-sanitize模块。
angular-sanitize一般会附带在angularjs中，如果没有附带，请前往官网下载对应版本的angular-sanitize模块。
模块代码 var demo = angular.module('demo',['ng-sanitize']); 控制器代码 demo.controller('Demo13Controller', [ '$scope', function($scope) { $scope.html = '&lt;span style="color: red">这是格式化的HTML文本&lt;/span>'; } ]); 视图代码 &lt;article class="demo13" ng-controller="Demo13Controller"> &lt;h2>&lt;a name="demo13">13.显示HTML文本&lt;/a>&lt;/h2> &lt;div class="demo13-content"> &lt;p>需要显示的文本：&lt;/p> &lt;p>Html格式化文本： &lt;span ng-bind-html="html|htmlContent">&lt;/span>&lt;/p> &lt;/div> &lt;/article> 过滤器代码 demo.filter('htmlContent',['$sce', function($sce) { return function(input) { return $sce.trustAsHtml(input); } }]); 总结 $sce过滤器+ng-bind-html就可以显示html文本了。</div></article><article><div class=blog-card><h3><a href=/2016/03/24/react-flux-es6-note-app/>React Flux ES6记事本应用</a></h3><p><small>March 24, 2016&nbsp;· 781 words&nbsp;· 4 min</small><p>项目地址 react-notepad-es6
React出来有很久了，与angularjs最大的不同在于React只是一个处理UI层面的库，可以认为是“V”，而angularjs则是一整套解决方案。
随着前端开发的组件化思想越来越浓烈，angularjs很多场合已经显得力不从心了。而这时候，核心为“模块化、组件化”的React可以派上永用场。真正用来开发项目的话，React肯定是不足的，缺少C和M模块。
Facebook官方推荐的Flux可以认为是一个简单的解决方案，Flux没什么特别含义，就是一个facebook随便找的一个词而已。至于什么是Flux，本文不做解释，本文以Flux来开发一个记事本应用。
项目目录 |----action Action Creator |---- NoteAction.js 记事本应用需要的动作 |----css 样式文件目录 |---- style.scss 样式文件 |----dispatcher 分发器目录 |---- AppDispatcher.js 分发器 |----store Store目录 |---- NoteStore.js 存储日记数据以及处理AppDispatcher派发事件 |----view 视图&组件目录 |---- Note.jsx 单条日记 |---- NoteBox.jsx 整个日记组件的父容器 |---- NoteForm.jsx 日记创建/编辑表单 |----NoteList.jsx 日记列表组件 |----entry.js webpack入口文件 |----index.html 项目页面 |----webpack.config.js webpack配置文件 项目思路 NoteList.jsx组件包含多个Note.jsx，NoteList.jsx的数据来源于NoteStore.js。 创建日记时，NoteForm.jsx需要调用NoteAction的add方法最终触发AppDispatcher.dispatch方法 NoteStore注册AppDispatcher的监听器实现对dispatch事件的监听 编辑日记时，Note.jsx调用NoteAction的setNote方法设置需要编辑的日记，通过AppDispatcher的调度之后最终将日记数据显示在NoteForm.jsx组件中。 项目实现 安装依赖 本文采用ES6语法进行开发， 所以需要安装babel编译器，打开终端执行以下命令：
npm init -y npm install webpack webpack-dev-server -g npm install flux microevent react react-dom --save npm install babel-loader css-loader jsx-loader sass-loader style-loader --save-dev npm instlal babel-preset-es2015 babel-preset-react --save-dev npm install microevent --save webpack.</div></article><article><div class=blog-card><h3><a href=/2016/03/02/android-pick-image-return-image-path/>android选择图片返回统一图片地址</a></h3><p><small>March 2, 2016&nbsp;· 224 words&nbsp;· 2 min</small><p>android从选择图片有两种方法，但是返回值确不同，本文将指导大家如何统一这两种方式的返回值。
//关键代码 @Event(R.id.btnPhoto) private void onBtnPhotoClicked(View view) { Intent intent = new Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI); startActivityForResult(intent, Config.Constants.CODE_PICK_IMAGE_FROM_PHOTO); } @Event(R.id.btnCamera) private void onBtnCameraClicked(View view) { Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE); startActivityForResult(intent, Config.Constants.CODE_PICK_IMAGE_FROM_CAMERA); } @Override protected void onActivityResult(int requestCode, int resultCode, Intent data) { switch (requestCode) { case Config.Constants.CODE_PICK_IMAGE_FROM_CAMERA: if (data != null && data.hasExtra("data")) { Bitmap bitmap = data.getParcelableExtra("data"); bitmap = BitmapUtil.scale(bitmap, 640.0f / bitmap.getWidth()); try { File path = new File(((MyApplication) getApplication()).</div></article><article><div class=blog-card><h3><a href=/2016/02/19/baidu-push-launch-app-with-params/>百度推送收到消息时带参数启动activity</a></h3><p><small>February 19, 2016&nbsp;· 39 words&nbsp;· One minute</small><p>一般来说，在BPushReceiver的onNotificationClicked或者onMessage方法收到推送消息后会去启动一个activity。此时整个应用有以下几种状态：
应用进程不存在 应用进程存在，但是不在前台 应用进程存在，在前台 在BPushReceiver的onNotificationClicked或者onMessage方法中使用Intent来启动activity：
Intent intent = new Intent(); intent.setClass(context.getApplicationContext(), MainActivity.class); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_SINGLE_TOP); if (url != null && !url.isEmpty()) { Bundle bundle = new Bundle(); bundle.putString("url", url); intent.putExtras(bundle); } Log.d(TAG, "start app"); context.getApplicationContext().startActivity(intent); 需要注意的是，针对不同的应用状态，MainActivity中触发的方法也不同：
应用进程不存在时,onCreate被调用 应用进程存在，不管是不是在前台，onNewIntent被调用 针对以上状态，合理的使用onCreate和onNewIntent就可以在任何时候呆参数启动APP了。</div></article></div><div class=paginator><a class=prev href=/categories/engineering/page/17/>&larr;&nbsp;&nbsp;Pre Page</a>
<a class=next href=/categories/engineering/page/19/>Next Page&nbsp;&nbsp;&rarr;</a></div></div></div></div><footer class=footer><p>&copy; 2014 - 2023 <a href=https://www.ddhigh.com>Lei Xia</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
<a href=https://umami-beta-peach.vercel.app/ target=_blank>Statistics</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg></a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>