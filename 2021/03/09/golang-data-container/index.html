<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Golang程序设计——数据容器</title>
<meta charset=utf-8><meta name=description content="Ladder@本文学习Go语言数据容器、包括数组、切片和映射。
数组 数组是一个数据集合，常用于存储用数字索引的同类型数据。Go语言的数组调用函数时使用的是值传递，因此形参会拷贝一份实参的值。
在Go语言中，声明数组需要同时指定长度和数据类型，数组长度是其类型的一部分，因此[5]int和[1]int是两种类型。
Go语言可以对数组进行写入、读取、删除、遍历等操作。
package main import &#34;fmt&#34; func main() { // 声明数组并指明长度，不初始化，因此a的5个元素为int类型的零值（0） var a [5]int // 声明数组并指明长度，并初始化4个元素，因此b的最后1个元素为int类型零值（0） var b = [5]int{1, 2, 3, 4} // 声明数组，不指明长度，编译器会根据值数量推导长度为4 var c = [...]int{1, 2, 3, 4} // 数组写入 a[0] = 0 a[1] = 1 // 数组读取 fmt.Printf(&#34;a[0]=%d\n&#34;, a[0]) // 数组删除（赋零值） a[0] = 0 // 数组的遍历 for index, value := range c { fmt.Printf(&#34;c[%d]=%d\n&#34;, index, value) } // 输出b fmt.Printf(&#34;b=%v\n&#34;, b) } 切片 使用切片 在Go语言中，数组是一个重要的类型，但是使用切片的情况更多。切片是底层数组中的一个连续片段，因此数组支持的特性切片也全部支持，必须顺序遍历、通过索引访问元素等等。"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/2021/03/09/golang-data-container/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com/index.xml title="Lei Xia"><script async defer data-website-id=865c8529-0729-4cf5-88a9-448616abbcbb src=https://umami-beta-peach.vercel.app/xialeistudio></script><meta property="og:title" content="Golang程序设计——数据容器"><meta property="og:description" content="本文学习Go语言数据容器、包括数组、切片和映射。
数组 数组是一个数据集合，常用于存储用数字索引的同类型数据。Go语言的数组调用函数时使用的是值传递，因此形参会拷贝一份实参的值。
在Go语言中，声明数组需要同时指定长度和数据类型，数组长度是其类型的一部分，因此[5]int和[1]int是两种类型。
Go语言可以对数组进行写入、读取、删除、遍历等操作。
package main import &#34;fmt&#34; func main() { // 声明数组并指明长度，不初始化，因此a的5个元素为int类型的零值（0） var a [5]int // 声明数组并指明长度，并初始化4个元素，因此b的最后1个元素为int类型零值（0） var b = [5]int{1, 2, 3, 4} // 声明数组，不指明长度，编译器会根据值数量推导长度为4 var c = [...]int{1, 2, 3, 4} // 数组写入 a[0] = 0 a[1] = 1 // 数组读取 fmt.Printf(&#34;a[0]=%d\n&#34;, a[0]) // 数组删除（赋零值） a[0] = 0 // 数组的遍历 for index, value := range c { fmt.Printf(&#34;c[%d]=%d\n&#34;, index, value) } // 输出b fmt.Printf(&#34;b=%v\n&#34;, b) } 切片 使用切片 在Go语言中，数组是一个重要的类型，但是使用切片的情况更多。切片是底层数组中的一个连续片段，因此数组支持的特性切片也全部支持，必须顺序遍历、通过索引访问元素等等。"><meta property="og:type" content="article"><meta property="og:url" content="https://www.ddhigh.com/2021/03/09/golang-data-container/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-03-09T16:21:34+00:00"><meta property="article:modified_time" content="2021-03-09T16:21:34+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Golang程序设计——数据容器"><meta name=twitter:description content="本文学习Go语言数据容器、包括数组、切片和映射。
数组 数组是一个数据集合，常用于存储用数字索引的同类型数据。Go语言的数组调用函数时使用的是值传递，因此形参会拷贝一份实参的值。
在Go语言中，声明数组需要同时指定长度和数据类型，数组长度是其类型的一部分，因此[5]int和[1]int是两种类型。
Go语言可以对数组进行写入、读取、删除、遍历等操作。
package main import &#34;fmt&#34; func main() { // 声明数组并指明长度，不初始化，因此a的5个元素为int类型的零值（0） var a [5]int // 声明数组并指明长度，并初始化4个元素，因此b的最后1个元素为int类型零值（0） var b = [5]int{1, 2, 3, 4} // 声明数组，不指明长度，编译器会根据值数量推导长度为4 var c = [...]int{1, 2, 3, 4} // 数组写入 a[0] = 0 a[1] = 1 // 数组读取 fmt.Printf(&#34;a[0]=%d\n&#34;, a[0]) // 数组删除（赋零值） a[0] = 0 // 数组的遍历 for index, value := range c { fmt.Printf(&#34;c[%d]=%d\n&#34;, index, value) } // 输出b fmt.Printf(&#34;b=%v\n&#34;, b) } 切片 使用切片 在Go语言中，数组是一个重要的类型，但是使用切片的情况更多。切片是底层数组中的一个连续片段，因此数组支持的特性切片也全部支持，必须顺序遍历、通过索引访问元素等等。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.ddhigh.com/posts/"},{"@type":"ListItem","position":3,"name":"Golang程序设计——数据容器","item":"https://www.ddhigh.com/2021/03/09/golang-data-container/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Golang程序设计——数据容器","name":"Golang程序设计——数据容器","description":"本文学习Go语言数据容器、包括数组、切片和映射。\n数组 数组是一个数据集合，常用于存储用数字索引的同类型数据。Go语言的数组调用函数时使用的是值传递，因此形参会拷贝一份实参的值。\n在Go语言中，声明数组需要同时指定长度和数据类型，数组长度是其类型的一部分，因此[5]int和[1]int是两种类型。\nGo语言可以对数组进行写入、读取、删除、遍历等操作。\npackage main import \u0026#34;fmt\u0026#34; func main() { // 声明数组并指明长度，不初始化，因此a的5个元素为int类型的零值（0） var a [5]int // 声明数组并指明长度，并初始化4个元素，因此b的最后1个元素为int类型零值（0） var b = [5]int{1, 2, 3, 4} // 声明数组，不指明长度，编译器会根据值数量推导长度为4 var c = [...]int{1, 2, 3, 4} // 数组写入 a[0] = 0 a[1] = 1 // 数组读取 fmt.Printf(\u0026#34;a[0]=%d\\n\u0026#34;, a[0]) // 数组删除（赋零值） a[0] = 0 // 数组的遍历 for index, value := range c { fmt.Printf(\u0026#34;c[%d]=%d\\n\u0026#34;, index, value) } // 输出b fmt.Printf(\u0026#34;b=%v\\n\u0026#34;, b) } 切片 使用切片 在Go语言中，数组是一个重要的类型，但是使用切片的情况更多。切片是底层数组中的一个连续片段，因此数组支持的特性切片也全部支持，必须顺序遍历、通过索引访问元素等等。","keywords":[],"articleBody":"本文学习Go语言数据容器、包括数组、切片和映射。\n数组 数组是一个数据集合，常用于存储用数字索引的同类型数据。Go语言的数组调用函数时使用的是值传递，因此形参会拷贝一份实参的值。\n在Go语言中，声明数组需要同时指定长度和数据类型，数组长度是其类型的一部分，因此[5]int和[1]int是两种类型。\nGo语言可以对数组进行写入、读取、删除、遍历等操作。\npackage main import \"fmt\" func main() { // 声明数组并指明长度，不初始化，因此a的5个元素为int类型的零值（0） var a [5]int // 声明数组并指明长度，并初始化4个元素，因此b的最后1个元素为int类型零值（0） var b = [5]int{1, 2, 3, 4} // 声明数组，不指明长度，编译器会根据值数量推导长度为4 var c = [...]int{1, 2, 3, 4} // 数组写入 a[0] = 0 a[1] = 1 // 数组读取 fmt.Printf(\"a[0]=%d\\n\", a[0]) // 数组删除（赋零值） a[0] = 0 // 数组的遍历 for index, value := range c { fmt.Printf(\"c[%d]=%d\\n\", index, value) } // 输出b fmt.Printf(\"b=%v\\n\", b) } 切片 使用切片 在Go语言中，数组是一个重要的类型，但是使用切片的情况更多。切片是底层数组中的一个连续片段，因此数组支持的特性切片也全部支持，必须顺序遍历、通过索引访问元素等等。\n为何使用切片的情况更多呢？主要是因为Go语言的数组不支持自动扩容，而且不支持删除元素，更重要的是Go语言数组是值类型，切片是引用类型，在向函数传参时切片拥有更好的性能。\npackage main import \"fmt\" func main() { // 声明一个大小为0的int类型切片 var a = make([]int, 0) // 添加三个元素 a = append(a, 1, 2, 3) fmt.Println(a) // 遍历元素 for index, value := range a { fmt.Printf(\"a[%d]=%d\\n\", index, value) } // 声明一个大小为4的切片 var b = make([]int, 4) // 将a的元素复制到b copy(b, a) // 删除指定下标的元素 a = append(a[:1], a[2:]...) fmt.Printf(\"a=%v\\n\", a) fmt.Printf(\"b=%v\\n\", b) // 使用值初始化切片 var c = []int{1, 2, 3, 4} fmt.Printf(\"c=%v\\n\", c) // 只定义，不初始化切片 var d []int d = append(d, 1, 2, 3) fmt.Printf(\"d=%v\\n\", d) } 声明切片可以不使用make初始化，append也不会报错。\n运行时结构 切片运行时结构如下：\ntype slice struct { array unsafe.Pointer len int cap int } array是底层数组\nlen是数组大小，可以通过len函数获取\ncap是数组容量，可以通过cap函数获取\nmake函数创建切片有两种写法：\nmake([]int, 0) // 1 make([]int, 0, 8) // 2 声明了一个长度为0的切片，此时len为0，cap也为0\n声明一个长度为0，容量为8的切片，此时len为0，cap为8\n追加元素 Go语言提供append函数追加元素到切片中，append会在必要时扩容底层数组。扩容规则如下：\n新容量小于1024时，每次扩容2倍。例如现有容量为2，扩容后为4\n新容量大于1024时，每次扩容1.25倍。例如现有容量为1024，扩容后为1280\npackage main import \"fmt\" func main() { // 直接使用值初始化切片 var a = []int{1, 2, 3, 4, 5} a = append(a, 6, 7) var b = []int{9, 10} // 追加b的全部元素到a a = append(a, b...) fmt.Printf(\"a=%v\\n\", a) fmt.Printf(\"b=%v\\n\", b) } 范围操作符 切片支持取范围操作，新切片和原切片共享底层数组，因此对切片的修改会同时影响两个切片。\n范围操作符语法如下：a[begin:end]，左闭右开区间。因此a[1:10]包含a切片索引为1~9的元素。\npackage main import \"fmt\" func main() { // 直接使用值初始化切片 var a = []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10} var b = a[1:10] fmt.Println(b) // 修改新切片元素 b[0] = 11 fmt.Println(a) fmt.Println(b) } 可以看到修改b索引为0的元素为11之后，a切片也同时受到影响。\n范围操作符的切片这一点在编程中要特别注意！\n删除元素 利用范围操作符和append函数可以删除指定的切片元素。\npackage main import \"fmt\" func main() { // 直接使用值初始化切片 var a = []int{1, 2, 3, 4, 5} // 删除第2个元素 a = append(a[:1], a[2:]...) fmt.Println(a) // 删除第2、3个元素 a = []int{1, 2, 3, 4, 5} a = append(a[:1], a[3:]...) fmt.Println(a) } 复制元素 通过copy函数可以复制切片的全部或部分元素。在复制切片之前，需要声明好目标切片并设置len。\nlen必须大于0*，否则将不会复制任何元素。*\npackage main import \"fmt\" func main() { // 直接使用值初始化切片 var a = []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10} var b = make([]int, 0, 8) copy(b, a) fmt.Println(b) var c = make([]int, 8) copy(c, a[9:10]) fmt.Println(c) } 程序输出如下：\n[] [10 0 0 0 0 0 0 0] 可以看到切片b没有任何值，切片c成功复制了a的最后一个元素。\n映射 映射也叫字典、哈希表，数组和切片是通过数字索引访问的顺序集合，而映射是通过键来访问的无序集合。映射在查找方面非常高效，有着O(1)的时间复杂度，是非常常用的数据结构。\n使用映射 映射必须初始化之后才能使用，这一点和切片不同。\npackage main import \"fmt\" func main() { // 使用make初始化映射 var a = make(map[string]int) a[\"zhangsan\"] = 18 a[\"lisi\"] = 28 fmt.Printf(\"a=%v\\n\", a) // 使用值初始化映射 var b = map[string]int{ \"zhangsan\": 18, \"lisi\": 28, } fmt.Printf(\"b=%v\\n\", b) // 遍历映射 for key, value := range b { fmt.Printf(\"%s=%d\\n\", key, value) } } 下面是未初始化映射的使用\npackage main import \"fmt\" func main() { var a map[string]int a[\"zhangsan\"] = 1 for k, v := range a { fmt.Printf(\"%s=%d\\n\", k, v) } } 该程序会产生运行时错误：\npanic: assignment to entry in nil map goroutine 1 [running]: main.main() /Users/example/go/src/go-microservice-inaction/src/2.1/main.go:7 +0x5d 运行时结构 映射的运行时结构如下：\ntype hmap struct { count int flags uint8 B uint8 noverflow uint16 hash0 uint32 buckets unsafe.Pointer oldbuckets unsafe.Pointer nevacuate uintptr extra *mapextra } 部分字段说明如下：\ncount是目前映射的键值对数量\nB是映射的容量，对数。例如B为8，则映射容量为28=256\nbuckets中存储具体的键值对\noldbuckets在扩容中会使用到\nnevacuate 扩容进度指示器\n当装载因子超过6.5时，映射将发生扩容操作。装载因子计算公式：count/2B。例如当前为为166，此时装载因子为166/28=0.6484375，继续插入元素时，装载因子变为167/28= 0.65234375，此时会触发自动扩容。\n每次扩容会增加1倍的空间，同时会对已存在的键值对进行渐进式迁移（一次迁移一小部分）。\n添加元素 Go语言映射添加元素和其他语言类似，使用[]语法即可。\nvar m = make(map[string]int) m[\"name\"] = 18 添加元素时运行时会自动处理扩容和键值对迁移，无需用户程序关心。\n删除元素 要从映射中删除元素，需要使用delete函数。\nvar m = map[string]int{ \"zhangsan\":18, } delete(m, \"zhangsan\") 小结 本章介绍了Go语言常用的数据容器，其中对切片和映射的底层原理进行了简单介绍。Go语言通过内置切片和映射解决了C语言需要手动实现这两种常用数据结构的问题，提高了开发效率。在下一章将介绍Go语言的函数。\n","wordCount":"511","inLanguage":"en","datePublished":"2021-03-09T16:21:34Z","dateModified":"2021-03-09T16:21:34Z","author":{"@type":"Person","name":"Lei Xia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ddhigh.com/2021/03/09/golang-data-container/"},"publisher":{"@type":"Organization","name":"Lei Xia","logo":{"@type":"ImageObject","url":"https://www.ddhigh.com/favicon.ico"}}}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.ff1bc260fafbfb440e10194d7d06d57eb5e85eed11d12d06255581262664204e.css integrity="sha256-/xvCYPr7+0QOEBlNfQbVfrXoXu0R0S0GJVWBJiZkIE4=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.894ca9c68afab956438c4926a0dc7f5293e04e08595bd27abdb123e94801f684.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>Guestbook</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>Golang程序设计——数据容器</h1></header><p><small>March 9, 2021&nbsp;· 511 words&nbsp;· 3 min</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#数组>数组</a></li><li><a href=#切片>切片</a><ul><li><a href=#使用切片>使用切片</a></li><li><a href=#运行时结构>运行时结构</a></li><li><a href=#追加元素>追加元素</a></li><li><a href=#范围操作符>范围操作符</a></li><li><a href=#删除元素>删除元素</a></li><li><a href=#复制元素>复制元素</a></li></ul></li><li><a href=#映射>映射</a><ul><li><a href=#使用映射>使用映射</a></li><li><a href=#运行时结构-1>运行时结构</a></li><li><a href=#添加元素>添加元素</a></li><li><a href=#删除元素-1>删除元素</a></li></ul></li><li><a href=#小结>小结</a></li></ul></nav></div><section class=blog-content><p>本文学习Go语言数据容器、包括数组、切片和映射。</p><h2 id=数组>数组</h2><p>数组是一个数据集合，常用于存储用数字索引的同类型数据。Go语言的数组调用函数时使用的是值传递，因此形参会拷贝一份实参的值。</p><p>在Go语言中，声明数组需要同时指定长度和数据类型，数组长度是其类型的一部分，因此<code>[5]int</code>和<code>[1]int</code>是两种类型。</p><p>Go语言可以对数组进行写入、读取、删除、遍历等操作。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 声明数组并指明长度，不初始化，因此a的5个元素为int类型的零值（0）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> [<span style=color:#ae81ff>5</span>]<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 声明数组并指明长度，并初始化4个元素，因此b的最后1个元素为int类型零值（0）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> = [<span style=color:#ae81ff>5</span>]<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>}
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 声明数组，不指明长度，编译器会根据值数量推导长度为4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>c</span> = [<span style=color:#f92672>...</span>]<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>}
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 数组写入
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>0</span>] = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>1</span>] = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 数组读取
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;a[0]=%d\n&#34;</span>, <span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 数组删除（赋零值）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>0</span>] = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 数组的遍历
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>index</span>, <span style=color:#a6e22e>value</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>c</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;c[%d]=%d\n&#34;</span>, <span style=color:#a6e22e>index</span>, <span style=color:#a6e22e>value</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 输出b
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;b=%v\n&#34;</span>, <span style=color:#a6e22e>b</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=切片>切片</h2><h3 id=使用切片>使用切片</h3><p>在Go语言中，数组是一个重要的类型，但是使用切片的情况更多。切片是底层数组中的一个连续片段，因此数组支持的特性切片也全部支持，必须顺序遍历、通过索引访问元素等等。</p><p>为何使用切片的情况更多呢？主要是因为Go语言的数组不支持自动扩容，而且不支持删除元素，更重要的是Go语言数组是值类型，切片是引用类型，在向函数传参时切片拥有更好的性能。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 声明一个大小为0的int类型切片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> = make([]<span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 添加三个元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>a</span> = append(<span style=color:#a6e22e>a</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 遍历元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>index</span>, <span style=color:#a6e22e>value</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>a</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;a[%d]=%d\n&#34;</span>, <span style=color:#a6e22e>index</span>, <span style=color:#a6e22e>value</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 声明一个大小为4的切片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> = make([]<span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 将a的元素复制到b
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	copy(<span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 删除指定下标的元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>a</span> = append(<span style=color:#a6e22e>a</span>[:<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;a=%v\n&#34;</span>, <span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;b=%v\n&#34;</span>, <span style=color:#a6e22e>b</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 使用值初始化切片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>c</span> = []<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;c=%v\n&#34;</span>, <span style=color:#a6e22e>c</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 只定义，不初始化切片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>d</span> []<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>d</span> = append(<span style=color:#a6e22e>d</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;d=%v\n&#34;</span>, <span style=color:#a6e22e>d</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>声明切片可以不使用make初始化，append也不会报错。</p><h3 id=运行时结构>运行时结构</h3><p>切片运行时结构如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>slice</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>array</span> <span style=color:#a6e22e>unsafe</span>.<span style=color:#a6e22e>Pointer</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>len</span>   <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>cap</span>   <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol><li><p>array是底层数组</p></li><li><p>len是数组大小，可以通过len函数获取</p></li><li><p>cap是数组容量，可以通过cap函数获取</p></li></ol><p>make函数创建切片有两种写法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>make([]<span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>0</span>) <span style=color:#75715e>// 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>make([]<span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>8</span>) <span style=color:#75715e>// 2
</span></span></span></code></pre></div><ol><li><p>声明了一个长度为0的切片，此时len为0，cap也为0</p></li><li><p>声明一个长度为0，容量为8的切片，此时len为0，cap为8</p></li></ol><h3 id=追加元素>追加元素</h3><p>Go语言提供append函数追加元素到切片中，append会在必要时扩容底层数组。扩容规则如下：</p><ol><li><p>新容量小于1024时，每次扩容2倍。例如现有容量为2，扩容后为4</p></li><li><p>新容量大于1024时，每次扩容1.25倍。例如现有容量为1024，扩容后为1280</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 直接使用值初始化切片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> = []<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>a</span> = append(<span style=color:#a6e22e>a</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> = []<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>10</span>}
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 追加b的全部元素到a
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>a</span> = append(<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span><span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;a=%v\n&#34;</span>, <span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;b=%v\n&#34;</span>, <span style=color:#a6e22e>b</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=范围操作符>范围操作符</h3><p>切片支持取范围操作，新切片和原切片共享底层数组，因此对切片的修改会同时影响两个切片。</p><p>范围操作符语法如下：a[begin:end]，左闭右开区间。因此a[1:10]包含a切片索引为1~9的元素。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 直接使用值初始化切片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> = []<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>10</span>}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> = <span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>1</span>:<span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>b</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 修改新切片元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>b</span>[<span style=color:#ae81ff>0</span>] = <span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>b</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>可以看到修改b索引为0的元素为11之后，a切片也同时受到影响。</p><p>范围操作符的切片这一点在编程中要特别注意！</p><h3 id=删除元素>删除元素</h3><p>利用范围操作符和append函数可以删除指定的切片元素。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 直接使用值初始化切片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> = []<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>}
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 删除第2个元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>a</span> = append(<span style=color:#a6e22e>a</span>[:<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 删除第2、3个元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>a</span> = []<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>a</span> = append(<span style=color:#a6e22e>a</span>[:<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>3</span>:]<span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=复制元素>复制元素</h3><p>通过copy函数可以复制切片的全部或部分元素。在复制切片之前，需要声明好目标切片并设置len。</p><p><em>len<strong>必须大于</strong>0</em>*，否则将不会复制任何元素。*</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 直接使用值初始化切片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> = []<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>10</span>}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> = make([]<span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>	copy(<span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>b</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>c</span> = make([]<span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>	copy(<span style=color:#a6e22e>c</span>, <span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>9</span>:<span style=color:#ae81ff>10</span>])
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>c</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>程序输出如下：</p><pre tabindex=0><code>[]
[10 0 0 0 0 0 0 0]
</code></pre><p>可以看到切片b没有任何值，切片c成功复制了a的最后一个元素。</p><h2 id=映射>映射</h2><p>映射也叫字典、哈希表，数组和切片是通过数字索引访问的顺序集合，而映射是通过键来访问的无序集合。映射在查找方面非常高效，有着O(1)的时间复杂度，是非常常用的数据结构。</p><h3 id=使用映射>使用映射</h3><p>映射必须初始化之后才能使用，这一点和切片不同。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 使用make初始化映射
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> = make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>a</span>[<span style=color:#e6db74>&#34;zhangsan&#34;</span>] = <span style=color:#ae81ff>18</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>a</span>[<span style=color:#e6db74>&#34;lisi&#34;</span>] = <span style=color:#ae81ff>28</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;a=%v\n&#34;</span>, <span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 使用值初始化映射
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> = <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>{
</span></span><span style=display:flex><span>		<span style=color:#e6db74>&#34;zhangsan&#34;</span>: <span style=color:#ae81ff>18</span>,
</span></span><span style=display:flex><span>		<span style=color:#e6db74>&#34;lisi&#34;</span>:     <span style=color:#ae81ff>28</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;b=%v\n&#34;</span>, <span style=color:#a6e22e>b</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 遍历映射
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>value</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>b</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s=%d\n&#34;</span>, <span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>value</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>下面是未初始化映射的使用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>a</span>[<span style=color:#e6db74>&#34;zhangsan&#34;</span>] = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>k</span>, <span style=color:#a6e22e>v</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>a</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s=%d\n&#34;</span>, <span style=color:#a6e22e>k</span>, <span style=color:#a6e22e>v</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>该程序会产生运行时错误：</p><pre tabindex=0><code>panic: assignment to entry in nil map
goroutine 1 [running]:
main.main()
/Users/example/go/src/go-microservice-inaction/src/2.1/main.go:7 +0x5d
</code></pre><h3 id=运行时结构-1>运行时结构</h3><p>映射的运行时结构如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>hmap</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>count</span>      <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flags</span>      <span style=color:#66d9ef>uint8</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>B</span>          <span style=color:#66d9ef>uint8</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>noverflow</span>  <span style=color:#66d9ef>uint16</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>hash0</span>      <span style=color:#66d9ef>uint32</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>buckets</span>    <span style=color:#a6e22e>unsafe</span>.<span style=color:#a6e22e>Pointer</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>oldbuckets</span> <span style=color:#a6e22e>unsafe</span>.<span style=color:#a6e22e>Pointer</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>nevacuate</span>  <span style=color:#66d9ef>uintptr</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>extra</span>      <span style=color:#f92672>*</span><span style=color:#a6e22e>mapextra</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>部分字段说明如下：</p><ol><li><p>count是目前映射的键值对数量</p></li><li><p>B是映射的容量，对数。例如B为8，则映射容量为28=256</p></li><li><p>buckets中存储具体的键值对</p></li><li><p>oldbuckets在扩容中会使用到</p></li><li><p>nevacuate 扩容进度指示器</p></li></ol><p>当装载因子超过6.5时，映射将发生扩容操作。装载因子计算公式：count/2B。例如当前为为166，此时装载因子为166/28=0.6484375，继续插入元素时，装载因子变为167/28= 0.65234375，此时会触发自动扩容。</p><p>每次扩容会增加1倍的空间，同时会对已存在的键值对进行渐进式迁移（一次迁移一小部分）。</p><h3 id=添加元素>添加元素</h3><p>Go语言映射添加元素和其他语言类似，使用[]语法即可。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>m</span> = make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>m</span>[<span style=color:#e6db74>&#34;name&#34;</span>] = <span style=color:#ae81ff>18</span>
</span></span></code></pre></div><p>添加元素时运行时会自动处理扩容和键值对迁移，无需用户程序关心。</p><h3 id=删除元素-1>删除元素</h3><p>要从映射中删除元素，需要使用delete函数。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>m</span> = <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;zhangsan&#34;</span>:<span style=color:#ae81ff>18</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>delete(<span style=color:#a6e22e>m</span>, <span style=color:#e6db74>&#34;zhangsan&#34;</span>) 
</span></span></code></pre></div><h2 id=小结>小结</h2><p>本章介绍了Go语言常用的数据容器，其中对切片和映射的底层原理进行了简单介绍。Go语言通过内置切片和映射解决了C语言需要手动实现这两种常用数据结构的问题，提高了开发效率。在下一章将介绍Go语言的函数。</p><p><img src=https://static.ddhigh.com/blog/2021-03-09-162926-2.png alt=img></p></section><div class=paginator><a class=prev href=https://www.ddhigh.com/2021/03/17/golang-function/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg><span>Golang程序设计——函数</span></a>
<a class=next href=https://www.ddhigh.com/2021/02/26/golang-basic/><span>Golang程序设计——基本语法</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","xialeistudio/discussion"),s.setAttribute("data-repo-id","R_kgDOKurTRA"),s.setAttribute("data-category","General"),s.setAttribute("data-category-id","DIC_kwDOKurTRM4CbCJt"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","en"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></div><footer class=footer><p>&copy; 2014 - 2023 <a href=https://www.ddhigh.com>Lei Xia</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
<a href=https://umami-beta-peach.vercel.app/ target=_blank>Statistics</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg></a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>