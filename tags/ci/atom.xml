<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ci on Lei Xia</title><link>https://www.ddhigh.com/tags/ci/</link><description>Recent content in ci on Lei Xia</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sun, 08 Apr 2018 17:40:37 +0000</lastBuildDate><atom:link href="https://www.ddhigh.com/tags/ci/atom.xml" rel="self" type="application/rss+xml"/><item><title>golang使用travis进行持续集成</title><link>https://www.ddhigh.com/2018/04/08/golang-travis-ci/</link><pubDate>Sun, 08 Apr 2018 17:40:37 +0000</pubDate><guid>https://www.ddhigh.com/2018/04/08/golang-travis-ci/</guid><description>&lt;p>虽然golang的工程工具已经非常完善了，比如测试、代码格式化等等。但是如果开发library开源到github的话，这些东西是可以使用自动化工具完成的，那就是 &lt;a href="https://www.travis-ci.org/">travis&lt;/a>&lt;/p>
&lt;h2 id="使用步骤">使用步骤&lt;/h2>
&lt;ol>
&lt;li>开发好需要集成的library以及测试用例&lt;/li>
&lt;li>在项目根目录新建&lt;code>.travis.yml&lt;/code>文件
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">language&lt;/span>: &lt;span style="color:#ae81ff">go&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">go&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#ae81ff">1.&lt;/span>&lt;span style="color:#ae81ff">x&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#e6db74">&amp;#39;1.8&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#e6db74">&amp;#39;1.9&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#ae81ff">1.10&lt;/span>&lt;span style="color:#ae81ff">.x&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#ae81ff">go test -v ./...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>提交到github&lt;/li>
&lt;li>打开&lt;a href="https://www.travis-ci.org/">https://www.travis-ci.org/&lt;/a>并使用github账号登录&lt;/li>
&lt;li>登录之后点击左边 &lt;strong>&amp;ldquo;My Repositories&amp;rdquo;&lt;/strong> 旁边的 &lt;strong>&amp;quot;+&amp;quot;&lt;/strong> 号添加项目（点击项目前面的滑块即可）&lt;/li>
&lt;li>更改项目文件，push一次到github，此时travis会自动运行测试脚本&lt;/li>
&lt;/ol>
&lt;h2 id="敏感数据加密">敏感数据加密&lt;/h2>
&lt;p>如果你的测试用例需要使用到敏感数据（如一些密钥等等），那需要用travis将你的敏感数据加密(以Mac为例)&lt;/p>
&lt;ol>
&lt;li>终端执行&lt;code>sudo gem install travis&lt;/code>&lt;/li>
&lt;li>在项目根目录打开终端执行&lt;code>travis encrypt AMAP_KEY=&amp;quot;xxxx&amp;quot; --add&lt;/code> &lt;strong>AMAP_KEY&lt;/strong>是环境变量名称，程序读取环境变量可以得到真实的key，&lt;strong>xxxx&lt;/strong>是敏感数据&lt;/li>
&lt;li>执行完毕后，&lt;strong>.travis.yml&lt;/strong> 会发生更改, 会添加如下内容(secure可能不一致)
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">env&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">global&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">secure&lt;/span>: &lt;span style="color:#ae81ff">kr5JHNTYsh/jezvk88qP91arb+UD/op/5CyOFY7uNYpJ6ZSsJY5fDKyZHjf0VSFmaYqJFMPl6uCASE9baiepeGvBFcy8aI9CNsbLzj2uBNjqqYPmvYGnBjpzp8yknVJKRTitF/kkWtzZcWImHnpvNGHuzXxp/EIBeJtNwjcCRoP/qfGhlZKbLsYFvlWkmRYb0dr8RM5mlmGXPZi8q7m+soVRO8Zjr4QQccybgmhonxlcUrHr6ro+yjjQefoJXRufqoRX0sGyecGYucC4nUpWl5hkDPkQE+Mekhz+rF657SwNsn8nXOFnnUuwsPXE26ak5xF1roEcFk2CpwGZuT7smJZPtw1inXFdIaW+4qllbyxMJkylvFZa5IcvLT3+/eKaQc8Fg6PoxJH0PF3RdtoQVB31cQiPWNm1SecQ6wC64WA/5qN4T5OoRfpt60BFDAITdS62dQGu5LSepcXMWXhxCdQPeDm5Qce6wjJXURubJMpBm0mPWwCNZhJyRw1G5TTyO25NckXQRlObrjltvwAd+7OEUcsYXqhdPtUTIVy6w3XOwT2eC/hP0Yi7qqUMMlJTHUW7Lb9zsEc4UB5BVwgeZ5Y9bVbknJfpt3ygcXAJeeDYxwV9g16KoS7HMFPzwrqlHbiBytIahqarBd4enwqR5RYQPEyetiIDLaJA4SyQ0cE=&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>上传到github&lt;/li>
&lt;/ol>
&lt;h2 id="接收测试结果通知">接收测试结果通知&lt;/h2>
&lt;p>如果你需要获取travis执行结果通知的话，可以添加邮箱配置，travis执行完毕后会通知到该邮箱。&lt;/p>
&lt;ol>
&lt;li>打开 &lt;strong>.travis.yml&lt;/strong>&lt;/li>
&lt;li>添加以下内容：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">notifications&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">email&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">recipients&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">邮箱地址&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">on_success&lt;/span>: &lt;span style="color:#ae81ff">change&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">on_failure&lt;/span>: &lt;span style="color:#ae81ff">always&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>提交到github&lt;/li>
&lt;/ol></description></item></channel></rss>