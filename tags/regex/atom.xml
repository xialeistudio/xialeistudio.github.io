<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>regex on Lei Xia</title><link>https://www.ddhigh.com/tags/regex/</link><description>Recent content in regex on Lei Xia</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 10 May 2016 17:06:28 +0800</lastBuildDate><atom:link href="https://www.ddhigh.com/tags/regex/atom.xml" rel="self" type="application/rss+xml"/><item><title>JS提取字符串中文英文数字</title><link>https://www.ddhigh.com/2016/05/10/js-extract-chinese-words-number-of-string/</link><pubDate>Tue, 10 May 2016 17:06:28 +0800</pubDate><guid>https://www.ddhigh.com/2016/05/10/js-extract-chinese-words-number-of-string/</guid><description>&lt;p>最近在做导出excel的时候，发现导出成功，文件大小也正常，但是Office 2013打不开，检查数据库发现，导出数据中有非中文字符导致Excel异常。&lt;/p>
&lt;p>我们知道JS是支持unicode字符集的，符合导出规则的字符应该是&amp;quot;中文&amp;quot;、&amp;ldquo;英文&amp;rdquo;、&amp;ldquo;数字&amp;rdquo;。&lt;/p>
&lt;h2 id="正则表达式">正则表达式&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">/([\u4e00-\u9fa5\w]*)/ig&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="提取字符串">提取字符串&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/**
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">* 获得可打印字符
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">* @param str 需要提取的字符串
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getPrintableChars&lt;/span>(&lt;span style="color:#a6e22e">str&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">matches&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">str&lt;/span>.&lt;span style="color:#a6e22e">match&lt;/span>(&lt;span style="color:#e6db74">/([\u4e00-\u9fa5\w]*)/ig&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">matches&lt;/span>.&lt;span style="color:#a6e22e">forEach&lt;/span>(&lt;span style="color:#a6e22e">item&lt;/span>=&amp;gt; &lt;span style="color:#a6e22e">item&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> (&lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#a6e22e">item&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">a&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>android 替换斜杠</title><link>https://www.ddhigh.com/2014/11/07/android-replace-slash/</link><pubDate>Fri, 07 Nov 2014 14:01:45 +0800</pubDate><guid>https://www.ddhigh.com/2014/11/07/android-replace-slash/</guid><description>&lt;h2 id="问题">问题&lt;/h2>
&lt;p>最近写安卓的时候服务端返回的数据会带上“\n”，但是在android这边不能换行，初次想到的解决方法是利用&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>String.&lt;span style="color:#a6e22e">replace&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>给替换掉，结果是不行的。之前记得java的反斜杠是需要转义的，就用&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>String.&lt;span style="color:#a6e22e">replaceAll&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;\\n&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>试了一下，结果依旧不行。后来去查了谷歌&amp;ndash;，发现要 \\n 才可以 匹配到 \n,这么多斜杠，头都晕了，一个个来解释：&lt;/p>
&lt;ul>
&lt;li>第一个和第二个反斜杠是一组，由于java的转义，实际为 &amp;ldquo;&amp;quot;&lt;/li>
&lt;li>第三个和第四个同理，&lt;/li>
&lt;/ul>
&lt;p>经过以上两步之后，\\n 实际上是 \n ，由于是正则的关系，\n 可以匹配到字符串的\n了。&lt;/p>
&lt;h2 id="解决方法">解决方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>String.&lt;span style="color:#a6e22e">replaceAll&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;\\n&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;\\n&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>第一个参数是正则，第二个是普通字符串。不得不吐槽下Java的正则表达式。。&lt;/p></description></item><item><title>PHP正则表达式匹配中文</title><link>https://www.ddhigh.com/2014/09/13/php-regex-chinese/</link><pubDate>Sat, 13 Sep 2014 11:20:26 +0800</pubDate><guid>https://www.ddhigh.com/2014/09/13/php-regex-chinese/</guid><description>&lt;p>正常的正则表达式匹配英文和数字以及一些常用字符还是很简单的，如&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">/^&lt;/span>&lt;span style="color:#a6e22e">\w&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>&lt;span style="color:#f92672">/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">/^&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>]&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>&lt;span style="color:#f92672">/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">/^&lt;/span>[&lt;span style="color:#a6e22e">\&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#a6e22e">\_&lt;/span>]&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>&lt;span style="color:#f92672">/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>等等，但是匹配中文的话就有些麻烦了。UTF-8的中文根据unicode编码，所以我们需要手动构造UTF-8字符串&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">/^&lt;/span>[&lt;span style="color:#a6e22e">\x&lt;/span>{&lt;span style="color:#ae81ff">4e00&lt;/span>}&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#a6e22e">\x&lt;/span>{&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#a6e22e">fa5&lt;/span>}]&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#a6e22e">u&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>请注意大括号，因为没有大括号PHP会报错&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Warning: preg_match&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#66d9ef">function&lt;/span>.preg-match&lt;span style="color:#f92672">]&lt;/span>: Compilation failed: PCRE does not support &lt;span style="color:#ae81ff">\L&lt;/span>, &lt;span style="color:#ae81ff">\l&lt;/span>, &lt;span style="color:#ae81ff">\N&lt;/span>, &lt;span style="color:#ae81ff">\U&lt;/span>, or &lt;span style="color:#ae81ff">\u&lt;/span> at offset &lt;span style="color:#ae81ff">3&lt;/span> in test.php on line &lt;span style="color:#ae81ff">3&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>因为\x是表示十六进制数的，所以需要用大括号括起来&lt;/p>
&lt;p>另外，需要增加 u 修饰符。&lt;/p>
&lt;p>此修正符启用了一个 PCRE 中与 Perl 不兼容的额外功能。模式字符串被当成 UTF-8。&lt;/p>
&lt;p>本修正符在 Unix 下自 PHP 4.1.0 起可用，在 win32 下自 PHP 4.2.3 起可用。&lt;/p>
&lt;p>很多时候google的作用确实比 X度 大，学会google吧！&lt;/p></description></item></channel></rss>