<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>regex</title>
<meta charset=utf-8><meta name=description content="Ladder@Learning & Writing & Sharing"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/tags/regex/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com/index.xml title="Lei Xia"><script async defer data-website-id=865c8529-0729-4cf5-88a9-448616abbcbb src=https://umami-beta-peach.vercel.app/xialeistudio></script><meta property="og:title" content="regex"><meta property="og:description" content="Learning & Writing & Sharing"><meta property="og:type" content="website"><meta property="og:url" content="https://www.ddhigh.com/tags/regex/"><meta name=twitter:card content="summary"><meta name=twitter:title content="regex"><meta name=twitter:description content="Learning & Writing & Sharing"><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.ff1bc260fafbfb440e10194d7d06d57eb5e85eed11d12d06255581262664204e.css integrity="sha256-/xvCYPr7+0QOEBlNfQbVfrXoXu0R0S0GJVWBJiZkIE4=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.894ca9c68afab956438c4926a0dc7f5293e04e08595bd27abdb123e94801f684.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>Guestbook</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><div class=blog-wrapper><div><div class=blog-list><article><div class=blog-card><h3><a href=/2016/11/13/nodejs-export-large-excel/>Nodejs导出大数据到Excel</a></h3><p><small>November 13, 2016&nbsp;· 121 words&nbsp;· One minute</small><p>在实际开发中，数据导出使用频率比数据导入高得多，而数据导出时来源一般是数据库，会有上万的数据导出，如果不做特殊处理的话，会导致NodeJs进程直接被killed。
今天要提到的npm包是 xlsx-writestream，话不多说，进入正题。
npm init -y npm install xlsx-writestream --save //编辑executor.js import Writer from 'xlsx-writestream'; import fs from 'fs'; export default class ExcelWriteExecutor{ /** * 构造方法 * @param path 路径 * @param options */ constructor(path, options = {}) { this.path = path; options.out = path; this.options = options; this.writer = new Writer(this.path, this.options); this.writer.getReadStream().pipe(fs.createWriteStream(this.path)); } addRow(row) { this.writer.addRow(row); } addRows(rows) { this.writer.addRows(rows); } /** * 输出 */ execute() { return new Promise((resolve)=> { this.</div></article><article><div class=blog-card><h3><a href=/2016/11/12/develop-nodejs-with-es6/>使用ES6开发Nodejs程序</a></h3><p><small>November 12, 2016&nbsp;· 65 words&nbsp;· One minute</small><p>ES6发布有一段时间了。但是Nodejs对此支持度还有待加强，就像前端可以使用babel+webpack构建基于ES6的工作流，其实Nodejs也是可以的（不需要手动编译）。当然，最终部署到生产服务器时要记得部署编译后的版本，否则运行时编译对性能是一种损失。
实践 npm init -y npm install babel-core babel-register babel-polyfill --save npm install babel-preset-es2015 babel-preset-stage-3 babel-plugin-transform-class-properties --save 有个需要注意的问题是，nodejs直接执行的那个js文件还是得用原生JS语法（具体取决于Nodejs支持ES6的程度），比如在Nodejs v4.2.6下，可以使用 const 关键字，这个是不需要babel的。
推荐目录结构如下：
|--bin |--a.js |--b.js |--bootstrap |--a.js |--b.js 在项目根目录添加 .babelrc 文件，代码如下：
{ "presets": [ "stage-3", "es2015" ], "plugins": [ "transform-class-properties" ] } bin 目录是真正的业务逻辑部分，可以使用ES6开发,bootstrap相当于一个启动脚本目录，示例代码如下（bootstrap/a.js）：
require('babel-register'); require('babel-polyfill'); require('../bin/a'); 单元测试 编写单元测试脚本也是可以使用ES6的，这里使用 mocha 为例，编写好测试用例后，在启动mocha命令时添加参数 &ndash;compilers，示例如下：
mocha --compilers=babel-register 代码编译 代码编译需要使用babel-cli，终端执行：
npm install babel-cli --save-dev babel bin -d lib 执行完毕后babel会自动生成lib目录，该目录为编译后的代码。</div></article><article><div class=blog-card><h3><a href=/2016/11/12/nodejs-read-large-excel/>Nodejs读取大excel</a></h3><p><small>November 12, 2016&nbsp;· 116 words&nbsp;· One minute</small><p>背景 Nodejs读取Excel时如果不使用stream处理的话，会导致内存溢出，毕竟要一次性加载excel的全部行数到内存中，而Nodejs单进程是有内存限制的，所以在读取超大excel的时候需要使用到stream，如果自己使用Nodejs自带的stream模块去解析excel的话，我想这个过程会很麻烦，本文使用npm提供的excel-stream，该模块使用stream+event方式读取excel，所以不用担心内存溢出问题。
使用 打开终端执行：
npm init -y npm install excel-stream --save 新建index.js
import excel from 'excel-stream'; import excel from 'excel-stream'; import events from 'events'; import fs from 'fs'; export default class ExcelReadExecutor extends events.EventEmitter{ static EVENT_DATA = 'data'; static EVENT_ERROR = 'error'; static EVENT_CLOSE = 'close'; /** * 构造方法 * @param path 路径 * @param options */ constructor(path, options = {}) { this.path = path; this.options = options; } /** * 读取 */ execute() { fs.</div></article><article><div class=blog-card><h3><a href=/2016/10/31/php-openssl-rsa-sign/>PHP利用openssl实现RSA非对称加密签名</a></h3><p><small>October 31, 2016&nbsp;· 48 words&nbsp;· One minute</small><p>阅读本文前请确认启用了php_openssl扩展
生成密钥 $res = openssl_pkey_new(); openssl_pkey_export_to_file($res,__DIR__.'/private.key'); $d = openssl_pkey_get_details($res); file_put_contents(__DIR__.'/public.key',$d['key']); 程序运行后会在当前目录生成 private.key 以及 public.key文件，你可以将你的public.key公开出去，请勿公开private.key
加密数据 $data = 'xialei'; $res = openssl_pkey_get_private(file_get_contents(__DIR__ . '/private.key')); if (openssl_sign($data, $out, $res)) { $data = base64_encode($out); echo $data; } 加密数据需要使用private.key
验证数据 $sig = base64_decode($data); $res = openssl_pkey_get_public(file_get_contents(__DIR__ . '/public.key')); var_dump(openssl_verify('xialei', $sig, $res)); 解密数据需要使用public.key，如果输出"int(1)&ldquo;证明解密成功，可以确认该数据由第1步中的private.key加密而来。</div></article><article><div class=blog-card><h3><a href=/2016/10/13/android_install_failed_uid_changed/>解决shareUserId导致的app无法升级的问题</a></h3><p><small>October 13, 2016&nbsp;· 10 words&nbsp;· One minute</small><p>老版本app版本号是2.0.13，Build是20160719。新版本app版本号是2.0.14，Build是2016101301。
初略看来应该是可以覆盖升级的，但是安装新版本的时候提示“应用未安装”。
网上找了一下，大致原因有以下几种：
签名冲突 手机空间不足 当前版本号小于已安装版本号 解决方案都是让用户卸载老版本，然后安装新版本，但是这肯定是可以安装的（测试通过）。 为了找出不能覆盖安装的问题，笔者还是将USB调试模式打开，直接使用IDE安装新版本app。
安装的时候提示INSTALL_FAILED_UID_CHANGED，从字面意思来看感觉是用户问题，定义app用户相关的代码只有AndroidManifest.xml文件中有。
打开AndroidManifest.xml发现定义了shareUserId，而老版本app是没有定义该属性的，删除之后，问题解决。</div></article><article><div class=blog-card><h3><a href=/2016/09/18/repeat-call-file-get-contents/>重复调用file_get_contents的问题</a></h3><p><small>September 18, 2016&nbsp;· 47 words&nbsp;· One minute</small><p>笔者在写Restful API的时候需要取得原始请求体，读了若干次输入流（将读取操作封装成了函数），发现就第一个参数有值，以后的读取都没有值。
起初以为是参数名写错导致读取失败，检查发现不是这个问题。
单步调试发现php://input只有第一次读取有值，以后的调用都是空。遇到这种问题往往需要查PHP的官方文档。
在文档中找到以下说明：
php://input 是个可以访问请求的原始数据的只读流。 POST 请求的情况下，最好使用 php://input 来代替 $HTTP_RAW_POST_DATA，因为它不依赖于特定的 php.ini 指令。 而且，这样的情况下 $HTTP_RAW_POST_DATA 默认没有填充， 比激活 always_populate_raw_post_data 潜在需要更少的内存。 enctype=&ldquo;multipart/form-data&rdquo; 的时候 php://input 是无效的。
还有一个特别说明:
在 PHP 5.6 之前 php://input 打开的数据流只能读取一次； 数据流不支持 seek 操作。 不过，依赖于 SAPI 的实现，请求体数据被保存的时候， 它可以打开另一个 php://input 数据流并重新读取。 通常情况下，这种情况只是针对 POST 请求，而不是其他请求方式，比如 PUT 或者 PROPFIND。
而笔者本地的PHP是5.5.25版本的，所以只能读第一次。</div></article><article><div class=blog-card><h3><a href=/2016/08/09/wechat-media-platform-nodejs-sdk/>微信公众平台开发NodeJs SDK</a></h3><p><small>August 9, 2016&nbsp;· 294 words&nbsp;· 2 min</small><p>本SDK要求NodeJs >= 4.x，欢迎大家在issues提问。
项目地址 wechat-nodejs
安装 npm install wechat-nodejs ---save 说明 使用所有sdk功能前需要初始化wechat句柄，初始化代码如下：
const Wechat = require('wechat-nodejs').Wechat; const wechat = new Wechat(appId,appSecret); SDK扩展了JS原始错误类，包含message,code属性，SDK中Promise抛出的错误code为微信返回的errcode，抛出一个自定义错误代码如下：
const AppError = require('wechat-nodejs').AppError; throw new AppError('参数错误',1); 功能列表 分组 初始化Group const Group = require('wechat-nodejs').Group; const group = new Group(wechat.getInstance()); 创建分组 group.create('测试分组').then((data)=>{ console.log(data); }).catch((e)=>{ console.error(e.message,e.code); }); 获取所有分组 group.getAll().then((data)=>{ console.log(data); }).catch((e)=>{ console.error(e.message,e.code); }); 获取用户所在分组 group.getIdByOpenid(openid).then((groupId)=>{ console.log(groupId); }).catch((e)=>{ console.error(e.message,e.code); }); 修改分组名称 group.update(100,'测试分组01').then((data)=>{ console.log(data); }).catch((e)=>{ console.error(e.message,e.code); }); 移动用户分组 group.moveUserToGroup('oA-yljrYgywqN3SCXS_3jZnIP6Yw',100).then((data)=>{ console.log(data); }).catch((e)=>{ console.error(e.message,e.code); }); 批量移动用户分组 group.</div></article><article><div class=blog-card><h3><a href=/2016/07/27/node-sass-install-mirror/>node-sass安装镜像</a></h3><p><small>July 27, 2016&nbsp;· 32 words&nbsp;· One minute</small><p>安装 npm安装node-sass模块的时候，会卡在 node scripts/install.js这里，因为要去github.com上下载源码，众所周知的原因，国内的网络上github.com速度太不稳定了，所以安装很慢。
这里推荐一种极速安装的方法，当然还是使用万能的淘宝镜像源。
打开~/.npmrc（windows用户打开 c:\Users\当前用户名.npmrc）增加一行
SASS_BINARY_SITE=https://npm.taobao.org/mirrors/node-sass/ 终端执行:
npm install node-sass 注意 如果使用了较高版本的nodejs或者node-sass，此时镜像可能还未同步完成，所以请大家前往此链接查看受支持的node-sass:
https://npm.taobao.org/mirrors/node-sass/ 该网页列出来的即为当前受支持的node-sass版本，开发的时候一般使用最新版本，本文写作时node-sass最新版本为v4.0.0，点击v4.0.0链接：
https://npm.taobao.org/mirrors/node-sass/v4.0.0/ 可以看到新网页中有一个文件列表，后缀为**.node**的文件即位编译好的，文件名格式如下:
[platform]-[architecture]-[nodejs version]_binding.node platform 操作系统平台 darwin为Mac OS X，linux为linux，win32为windows architecture 系统架构 目前有x64,ia32 nodejs version nodejs版本号，取全版本号的前两位，比如4.6.x为46，5.1.x为51 所以大家如果发现本网页没有出现你平台所需要的二进制文件，镜像也需要从github拉取数据，此时安装node-sass是不会加速的。</div></article><article><div class=blog-card><h3><a href=/2016/06/26/mybatis-generator-gui-tool/>mybatis-generator-gui工具</a></h3><p><small>June 26, 2016&nbsp;· 2 words&nbsp;· One minute</small><p>官方的mybatis-generator是个jar包只能写好xml配置后命令行生成，感觉略麻烦，这里用swing写了一个gui的开源版本，有需要的话可以去看看。
项目地址</div></article><article><div class=blog-card><h3><a href=/2016/06/23/android-asynctask-demo/>android AsyncTask示例</a></h3><p><small>June 23, 2016&nbsp;· 279 words&nbsp;· 2 min</small><p>android实现异步的方法有很多种，本文只介绍用的比较多的AsyncTask。从类名就可以看出来该类是专为异步而生，API也很简单。
AsyncTask接口原型 public abstract class AsyncTask&lt;Params, Progress, Result> { ... } 该类是个抽象类，有三个泛型参数，说明如下：
Params 任务参数类型，比如加载网络图片时，这里传入String Progress 更新进度时参数类型，一般传入Integer Result 执行结果类型，比如加载网络图片时，结果为Bitmap 该类的主要方法如下：
doInBackground(Params&mldr; params) 非主线程 执行异步任务，params为声明类时的泛型 onPreExecute 主线程 准备执行异步任务时调用 onPostExecute(Result result) 主线程 异步任务执行完毕时调用，result为声明类时的泛型 onProgressUpdate(Progress&mldr; values) 主线程 任务进度有更新时调用，values为声明类时的泛型 publishProgress(Progress&mldr; values) 非主线程 更新异步任务进度，此方法一般在doInBackground中调用 示例 本文将使用一个图片批量下载程序作为示例
根据需求可以确定，任务参数是String类型，进度是Integer类型，执行结果是List类型，项目代码如下：
布局文件 &lt;?xml version="1.0" encoding="utf-8"?> &lt;ScrollView xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent" android:layout_height="match_parent"> &lt;LinearLayout android:id="@+id/contentView" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical"> &lt;Button android:id="@+id/btnStart" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_gravity="center_horizontal" android:onClick="loadImage" android:text="@string/start" /> &lt;ProgressBar android:id="@+id/progressBar" style="?android:attr/progressBarStyleHorizontal" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:progress="0" android:visibility="gone" /> &lt;/LinearLayout> &lt;/ScrollView> MainActivity.</div></article></div><div class=paginator><a class=prev href=/tags/regex/page/19/>&larr;&nbsp;&nbsp;Pre Page</a>
<a class=next href=/tags/regex/page/21/>Next Page&nbsp;&nbsp;&rarr;</a></div></div></div></div><footer class=footer><p>&copy; 2014 - 2023 <a href=https://www.ddhigh.com>Lei Xia</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
<a href=https://umami-beta-peach.vercel.app/ target=_blank>Statistics</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg></a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>