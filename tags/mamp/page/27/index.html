<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>mamp</title>
<meta charset=utf-8><meta name=description content="Ladder@Learning & Writing & Sharing"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/tags/mamp/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com/index.xml title="Lei Xia"><script async defer data-website-id=865c8529-0729-4cf5-88a9-448616abbcbb src=https://umami-beta-peach.vercel.app/xialeistudio></script><meta property="og:title" content="mamp"><meta property="og:description" content="Learning & Writing & Sharing"><meta property="og:type" content="website"><meta property="og:url" content="https://www.ddhigh.com/tags/mamp/"><meta name=twitter:card content="summary"><meta name=twitter:title content="mamp"><meta name=twitter:description content="Learning & Writing & Sharing"><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.ff1bc260fafbfb440e10194d7d06d57eb5e85eed11d12d06255581262664204e.css integrity="sha256-/xvCYPr7+0QOEBlNfQbVfrXoXu0R0S0GJVWBJiZkIE4=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.894ca9c68afab956438c4926a0dc7f5293e04e08595bd27abdb123e94801f684.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>Guestbook</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><div class=blog-wrapper><div><div class=blog-list><article><div class=blog-card><h3><a href=/2014/12/16/css-center/>css水平居中和垂直居中</a></h3><p><small>December 16, 2014&nbsp;· 64 words&nbsp;· One minute</small><p>水平居中还是比较好弄的
{ margin-left: auto; margin-right: auto; } 但是垂直居中就比较麻烦，网上一大推文章都是什么display:table-cell,根本不管用。这里利用position属性可以达到这个目的。
效果图 HTML代码 &lt;html> &lt;head>&lt;/head> &lt;body> &lt;div class="container"> &lt;div class="inner">&lt;/div> &lt;/div> &lt;/body> &lt;/html> CSS代码 body{ background: #f1f1f1; } .container{ width: 400px; height: 400px; position: relative; margin: 100px auto; background: white; } .container .inner{ width: 100px; height: 100px; background: black; position: absolute; left: 50%; margin-left: -50px; top: 50%; margin-top: -50px; } 关键点 top属性和margin-top的组合，一般来说 top: 50%之后，加一个 margin-top: 容器的高度/2 就可以垂直居中了。</div></article><article><div class=blog-card><h3><a href=/2014/12/12/mysql-row-lock/>MySQL行锁的使用</a></h3><p><small>December 12, 2014&nbsp;· 26 words&nbsp;· One minute</small><p>大家可能都有这样一种感觉，Web程序在本地调试的时候一切正常，放到线上也基本是正常，但是偶尔会有数据错误的情况，这种情况在订单系统中特别常见，因为大部分的订单状态更新都是有两个路径（浏览器跳转和支付服务器的异步推送消息），当然，最终数据要以异步结果为准，但是问题是，浏览器跳转也需要更新订单状态，当这两种方式在很短的时间内同时到达数据库时（一般在一秒内），如果数据库没有加锁，那这个订单会被处理两次。
说到建立数据表时，涉及到支付的，都要用InnoDB引擎，该引擎支持行锁，支持事务，外键。
文章开始的解决办法就是采用InnoDB对要操作的数据行进行锁定。
数据表结构 订单ID(主键) 订单金额 订单状态 事务SQL BEGIN; SELECT * FROM `orders` WHERE `order_id`=100 FOR UPDATE; COMMIT; 释义 BEGIN 手动开启事务（行锁只对开启事务的查询起作用） FOR UPDATE 独占写（成功获得锁后，只有当前进程能够更新该纪录，其他进程如果需要更新该记录，则需进行“锁等待”） COMMIT 提交处理</div></article><article><div class=blog-card><h3><a href=/2014/12/06/android-circle-progressbar/>android实现圆形带进度条的ProgressBar</a></h3><p><small>December 6, 2014&nbsp;· 229 words&nbsp;· 2 min</small><p>android加载图片免不了使用加载进度显示，而android自带的progressBar有局限.
圆型的progressBar不能显示进度条，只能无限制转圈圈 水平的progressBar可以显示进度条，但是貌似不好看 解决办法是自己写一个view就可以了。
package com.ddhigh.library.widget; import android.content.Context; import android.graphics.Canvas; import android.graphics.Color; import android.graphics.Paint; import android.graphics.RectF; import android.util.AttributeSet; import android.view.View; public class CircleProgressBar extends View { private int maxProgress = 100; private int progress = 0; //画圆所在的距形区域 RectF oval; Paint paint; public CircleProgressBar(Context context, AttributeSet attrs) { super(context, attrs); oval = new RectF(); paint = new Paint(); } @Override protected void onDraw(Canvas canvas) { super.onDraw(canvas); int width = this.getWidth(); int height = this.</div></article><article><div class=blog-card><h3><a href=/2014/12/05/coding-yii1/>在coding上部署Yii1.x应用</a></h3><p><small>December 5, 2014&nbsp;· 90 words&nbsp;· One minute</small><p>总的来说，由于没有成熟的资料可以参考，部署过程话费了将近一个小时才成功，现在来分享一下经验。
目录配置 由于Paas禁止了本地写功能，所以，如果不加任何处理的话，Yii会尝试在 protected/runtime 目录下写私有文件，结果是肯定没权限的。
经过查找官方文档发现CApplication有个方法叫setRuntimePath，可以设置运行时目录，那么最重要的一点，这个目录的配置肯定要在入口文件中配置，更改之后的入口文件代码如下：
defined('YII_DEBUG') or define('YII_DEBUG',false); if(isset($_GET['_d'])) setcookie('_d',1,7*25*3600); // change the following paths if necessary $yii=dirname(__FILE__).'/framework/yii.php'; $config=dirname(__FILE__).'/protected/config/main.php'; // remove the following lines when in production mode // specify how many levels of call stack should be shown in each log message defined('YII_TRACE_LEVEL') or define('YII_TRACE_LEVEL',3); require_once($yii); $app = Yii::createWebApplication($config); $app->setRuntimePath('/home/vcap/fs/*****'); $app->run(); 可以看到，倒数一二行，重新设置了 runtimepath，所以，第一个问题解决。
数据库配置 数据库这边没什么好说的，自己更改下连接信息就可以了。
缓存配置 本地开发采用的缓存，默认是File的，如果你解决了上一个问题之后，在线上，缓存是没有问题了，这里探讨下服务器缓存的设置（Coding.NET提供的缓存为Redis的，PHP操作Redis需要扩展，这里先不探讨），本站现在的缓存驱动为DB方法，配置方法为:
'cache' => array( 'class' => 'system.caching.CDbCache', 'connectionID' => 'db', 'cacheTableName'=>'t_cache' ), 日志配置 默认情况下，日志是写入runtime path的，不过在Paas上，我们一般是没有本地文件权限的，就算写入了，查看起来比较麻烦，这里也采用数据库方法记录：</div></article><article><div class=blog-card><h3><a href=/2014/11/19/android-datepickertimepicker-display-inline/>android datepicker和timepicker显示在一行</a></h3><p><small>November 19, 2014&nbsp;· 221 words&nbsp;· 2 min</small><p>android默认的datepicker和默认的timepicker可以放在一行（Linelayout），但是timepicker右边会“挤出”屏幕，尝试设置layout_weight和layout_height对于布局有效，但是控件显示就不完整了。到这一步发现xml不局文件已经处理不了，所以自然想到应该利用java来处理了。
效果图 布局代码 &lt;LinearLayout android:orientation="horizontal" android:layout_width="fill_parent" android:layout_height="fill_parent" android:paddingLeft="10dp"> &lt;DatePicker android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/datePicker" android:calendarViewShown="false" /> &lt;TimePicker android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/timePicker" /> &lt;/LinearLayout> JAVA代码 UI.java public static void resizePicker(FrameLayout tp) { List&lt;NumberPicker> npList = findNumberPicker(tp); for (NumberPicker np : npList) { resizeNumberPicker(np); } } private static List&lt;NumberPicker> findNumberPicker(ViewGroup viewGroup) { List&lt;NumberPicker> npList = new ArrayList&lt;NumberPicker>(); View child = null; if (null != viewGroup) { for (int i = 0; i &lt; viewGroup.getChildCount(); i++) { child = viewGroup.</div></article><article><div class=blog-card><h3><a href=/2014/11/15/angularjs-empty-array/>Angularjs处理后端空数据</a></h3><p><small>November 15, 2014&nbsp;· 57 words&nbsp;· One minute</small><p>Yii1.x DAO中的queryAll方法查询，如果有结果，会返回一个数组，如果没有结果，会返回null。现在分两种情况：
返回空数组 $array = array( ); echo json_encode($array); 输出为
[] 返回null $array = null; echo json_encode($array); 输出为
null 那么问题来了，JS接收这两个的结果是不同的。
如果使用以下代码判断数据:
if(data.length == 0){ //当前评论为空 }else{ //当前评论不为空 } 如果返回 [] ，这段代码是生效的。但是如果返回 null ,这个就有问题了。
后来，使用
if(data == null){ //评论为空 }else{ //评论不为空 } 这个判断老是出问题，后端明明返回null了，判断还是错误的，这时候想到JS也是若类型语言，会不会是类型的问题。
console.log(typeof data) 返回的是**&ldquo;string&rdquo;**
那么问题就解决了，用以下代码就可以了
if(data.length == 0 || data == "null"){ //评论为空 }else{ //评论不为空 }</div></article><article><div class=blog-card><h3><a href=/2014/11/14/angularjs-traverse-empty-array/>angularjs遍历空数组&索引数组</a></h3><p><small>November 14, 2014&nbsp;· 34 words&nbsp;· One minute</small><p>今天做开发时发现控制老是报错，虽然不影响使用，但是作为有那么一点“强迫症”的我来说，无法忍受。通过调试发现是ng-repeat对一个空数组遍历出错，另外，[&lsquo;ab&rsquo;,&lsquo;cd&rsquo;,&lsquo;ad&rsquo;]这样只有值没有键的数组也会遍历出错。
解决办法 &lt;li class="media" ng-repeat="item in comments track by $index"> &lt;div class="media-body"> &lt;strong>&lt;/strong> &lt;p> &lt;br /> &lt;time>&lt;/time> &lt;br /> &lt;span ng-if="item.comment_author_url.length>0"> &lt;i class="fa fa-globe">&lt;/i> &lt;a href="" target="_blank">&lt;/a> &lt;/span> &lt;/p> &lt;/div> &lt;/li> 特别注意track by $index</div></article><article><div class=blog-card><h3><a href=/2014/11/13/illegalstateexception-can-not-perform-this-action-after-onsaveinstancestate/>IllegalStateException： Can not perform this action after onSaveInstanceState</a></h3><p><small>November 13, 2014&nbsp;· 13 words&nbsp;· One minute</small><p>今天使用Fragment的时候，出现了这个错误 IllegalStateException: Can not perform this action after onSaveInstanceState。查看一下控制台，发现是FragmentManager的commit()方法报错的，看字面意思应该是
onSaveInstanceState这个方法之后不能处理这个操作（指commit()）。
因为onSaveInstanceState 方法是在该Activity即将被销毁前调用，来保存Activity数据的，如果在保存完状态后再给它添加Fragment就会出错。解决办法就是把commit（）方法替换成 commitAllowingStateLoss()就行了，其效果是一样的。</div></article><article><div class=blog-card><h3><a href=/2014/11/11/android-cache-image-with-imageloader/>android使用ImageLoader缓存图片</a></h3><p><small>November 11, 2014&nbsp;· 61 words&nbsp;· One minute</small><p>缓存和异步是两个极大提升用户体验的好东西，android加载图片时的开销还是挺大的，要是不做缓存同步加载，网速不给力的情况下，等个十几秒是有可能的。
今天要说的是一个叫做ImageLoader的库
GITHUB:https://github.com/nostra13/Android-Universal-Image-Loader
使用这个库有以下几步：
导入libs目录 声明自己的MyApplication类（继承Application） 在onCreate()方法中 public void onCreate() { super.onCreate(); DisplayImageOptions options = new DisplayImageOptions.Builder() .cacheInMemory() //缓存在内存中 .cacheOnDisc() //磁盘缓存 .build(); ImageLoaderConfiguration config2 = new ImageLoaderConfiguration.Builder(this) .defaultDisplayImageOptions(options) .threadPriority(Thread.NORM_PRIORITY - 2) .denyCacheImageMultipleSizesInMemory() .discCacheFileNameGenerator(new Md5FileNameGenerator()) .tasksProcessingOrder(QueueProcessingType.LIFO) .build(); ImageLoader.getInstance().init(config2); } 在要加载图片的地方使用 DisplayImageOptions options = new DisplayImageOptions.Builder() .cacheInMemory() // 缓存用 .cacheOnDisc() .bitmapConfig(Bitmap.Config.RGB_565)//防止溢出 .displayer(new RoundedBitmapDisplayer(139)) // 图片圆角显示，值为整数 .build(); ImageLoader.getInstance().displayImage(url, avatar, options); 其中 url 是图片URL地址，avatar为ImageView,options为动态配置，这里加了一个防止溢出的参数。
好了，使用起来是不是很简单呢~我们压根不用操心异步和缓存的问题了</div></article><article><div class=blog-card><h3><a href=/2014/11/10/async-http-client-socket-timeout/>async http client socket超时问题</a></h3><p><small>November 10, 2014&nbsp;· 4 words&nbsp;· One minute</small><p>最近做的一个项目的HTTP模块使用了loopj的asynchttpclient (https://github.com/loopj/android-async-http）。
自动更新模块总是出现sockettimeout的exception,查来查去也不知道什么问题，为此还换了asynchttpclient的库版本。但是问题也没解决。
仔细看了一下，提示的是timeout，应该从这方面去看看，后面看到自己的HTTP工具类设置了全局超时时间为5000ms,普通请求当然没这么久，但是自动更新是下载，肯定不止5秒的，删掉超时设置就可以了。</div></article></div><div class=paginator><a class=prev href=/tags/mamp/page/26/>&larr;&nbsp;&nbsp;Pre Page</a>
<a class=next href=/tags/mamp/page/28/>Next Page&nbsp;&nbsp;&rarr;</a></div></div></div></div><footer class=footer><p>&copy; 2014 - 2023 <a href=https://www.ddhigh.com>Lei Xia</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
<a href=https://umami-beta-peach.vercel.app/ target=_blank>Statistics</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg></a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>