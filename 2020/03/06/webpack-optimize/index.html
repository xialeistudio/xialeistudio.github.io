<!doctype html><html lang=zh><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Webpack4不求人(3) ——性能优化</title>
<meta charset=utf-8><meta name=google-adsense-account content="ca-pub-2871082647721658"><meta content="Web开发 ,Java ,Go ,Node.js ,PHP ,Koa ,MySQL ,Redis ,前端 ,后端 ,数据库" name=keywords><meta name=description content="限定Webpack处理文件范围 项目比较小的情况下Webpack的性能问题几乎可以忽略，但是一旦项目复杂度上升，Webpack会有额外的性能损失需要我们进行优化。
通过前面内容的学习我们可以知道Webpack主要干下面这些事情：
通过entry指定的入口脚本进行依赖解析。 找到文件后通过配置的loader对其进行处理。 因此，我们可以从这方面入手进行优化，减少Webpack搜索文件的范围，减少不必要的处理。"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/2020/03/06/webpack-optimize/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com/index.xml title=每天进步一点点><script async src="https://www.googletagmanager.com/gtag/js?id=G-EC3XLVSGKV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EC3XLVSGKV")</script><meta property="og:title" content="Webpack4不求人(3) ——性能优化"><meta property="og:description" content="限定Webpack处理文件范围 项目比较小的情况下Webpack的性能问题几乎可以忽略，但是一旦项目复杂度上升，Webpack会有额外的性能损失需要我们进行优化。
通过前面内容的学习我们可以知道Webpack主要干下面这些事情：
通过entry指定的入口脚本进行依赖解析。 找到文件后通过配置的loader对其进行处理。 因此，我们可以从这方面入手进行优化，减少Webpack搜索文件的范围，减少不必要的处理。"><meta property="og:type" content="article"><meta property="og:url" content="https://www.ddhigh.com/2020/03/06/webpack-optimize/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-06T12:00:00+00:00"><meta property="article:modified_time" content="2020-03-06T12:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Webpack4不求人(3) ——性能优化"><meta name=twitter:description content="限定Webpack处理文件范围 项目比较小的情况下Webpack的性能问题几乎可以忽略，但是一旦项目复杂度上升，Webpack会有额外的性能损失需要我们进行优化。
通过前面内容的学习我们可以知道Webpack主要干下面这些事情：
通过entry指定的入口脚本进行依赖解析。 找到文件后通过配置的loader对其进行处理。 因此，我们可以从这方面入手进行优化，减少Webpack搜索文件的范围，减少不必要的处理。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.ddhigh.com/posts/"},{"@type":"ListItem","position":3,"name":"Webpack4不求人(3) ——性能优化","item":"https://www.ddhigh.com/2020/03/06/webpack-optimize/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Webpack4不求人(3) ——性能优化","name":"Webpack4不求人(3) ——性能优化","description":"限定Webpack处理文件范围 项目比较小的情况下Webpack的性能问题几乎可以忽略，但是一旦项目复杂度上升，Webpack会有额外的性能损失需要我们进行优化。\n通过前面内容的学习我们可以知道Webpack主要干下面这些事情：\n通过entry指定的入口脚本进行依赖解析。 找到文件后通过配置的loader对其进行处理。 因此，我们可以从这方面入手进行优化，减少Webpack搜索文件的范围，减少不必要的处理。","keywords":["webpack"],"articleBody":"限定Webpack处理文件范围 项目比较小的情况下Webpack的性能问题几乎可以忽略，但是一旦项目复杂度上升，Webpack会有额外的性能损失需要我们进行优化。\n通过前面内容的学习我们可以知道Webpack主要干下面这些事情：\n通过entry指定的入口脚本进行依赖解析。 找到文件后通过配置的loader对其进行处理。 因此，我们可以从这方面入手进行优化，减少Webpack搜索文件的范围，减少不必要的处理。\nloader配置 在之前的内容中介绍过loader可以使用test、include、exclude配置项来匹配需要Loader处理的文件，因此推荐给每个loader定义test之后还定义include或exclude。\nmodule.exports = { module:{ rules:[ { test:/\\.js$/, use:'babel-loader', include: path.resolve(__dirname, 'src'), // 只处理src目录下的js文件 } ] } }; resolve.extensions配置 导入未添加扩展名的模块时，Webpack会通过resolve.extensions后缀去检查文件是否存在。由于resolve.extensions是一个数组，如果数组项比较多，正确的后缀放置得越靠后，Webpack尝试次数就会越多，影响到性能。\n因此配置resolve.extensions时需要遵守以下规则：\n尽量减少后缀列表，不要将不可能存在的文件后缀配置进来 出现频率越高的后缀尽量写到前面，比如可以将.js写在第一个 业务代码中导入模块时，可以手动加上后缀导入，省去Webpack查找过程 module.noParse配置 module.noParse可以告诉Webpack忽略未采用模块系统文件的处理，可以有效地提高性能。比如常见的jQuery非常大，又没有采用模块系统，让Webpack解析这类型文件完全是浪费性能。\n因此我们可以配置如下的module.noParse:\nmodule.exports = { module:{ noParse:[/jQuery/] } }; IgnorePlugin 在导入模块时，IgnorePlugin可以忽略指定模块的生成。比如moment.js在导入时会自动导入本地化文件，一般情况下几乎不使用而且又比较大，此时可以通过IgnorePlugin忽略对本地化文件的生成，减小文件大小。\nmodule.exports = { plugins:[ new webpack.IgnorePlugin(/\\.\\/local/, /moment/) ] }; DllPlugin 使用过Windows操作系统的读者应该会经常看到以.dll扩展名的文件，这些文件叫做动态链接库，包含了其他程序或动态链接库的函数和数据。\nWebpack的DllPlugin的思想是类似的，先将公共模块打包为独立的Dll模块，然后在业务代码中直接引用这些模块。采用DllPlugin之后会大大提升Webpack构建速度，原因在于，包含大量复用模块的动态链接库只需要编译一次，之后的构建中会直接引用这些构建好的模块。\n在Webpack中使用动态链接库有以下两个步骤：\n通过webpack.DllPlugin插件打包出Dll库 通过webpack.DllReferencePlugin引用打包好的Dll库 下面以React项目为例进行说明。\nDll库需要单独构建，因此我们需要一份单独的配置Webpack文件。\n1.新建webpack.dll.config.js\nconst webpack = require('webpack'); module.exports = { entry:{ react: ['react', 'react-dom'] }, output:{ filename: '_dll_[name].js', // 输出的文件名 path: path.resolve(__dirname, 'dist'), // 输出到dist目录 library: '_dll_[name]' }, plugins: [ // name要等于output.library里的name new webpack.DllPlugin({ name: \"_dll_[name]\", path: path.resolve(__dirname, \"dist\", \"manifest.json\") // 清单文件路径 }) ] }; 2.编辑webpack.config.js\nconst webpack = require('webpack'); module.exports = { entry: './src/main', output:{ filename: '[name].js', // 输出的文件名 path: path.resolve(__dirname, 'dist'), // 输出到dist目录 }, plugins: [ // 传入manifest.json new webpack.DllReferencePlugin({ manifest: path.resolve(__dirname, \"dist\", \"manifest.json\") // 清单文件路径 }) ] }; 3.添加构建命令\n{ \"scripts\":{ \"build-dll\":\"webpack --config webpack.dll.config.js\", \"build\":\"webpack\" } } 4.构建Dll\nnpm run build-dll 5.构建应用\nnpm run build Dll需要先构建，否则应用将构建失败\nHappyPack Webpack默认情况下是单进程执行的，因此无法利用多核优势，通过HappyPack可以变成多进程构建，从而提升构建速度。下面我们一起来看看如何使用happypack来加速构建。\n1.安装happypack\nnpm isntall happypack 2.编辑配置文件，需要将Loader配置到HappyPack插件中，由HappyPack对Loader进行调用。\nconst HappyPackPlugin = require('happypack'); const path = require('path'); module.exports = { entry: './src/main', output:{ path: path.resolve(__dirname, 'build'), filename:'[name].js' }, module:{ rules:[ { test:/\\.js$/, use:'happypack/loader?id=js', // 配置id为js include:[ path.resolve(__dirname,'src') ] }, { test:/\\.scss$/, use:'happypack/loader?id=scss', // 配置id为scss include:[ path.resolve(__dirname,'src') ] }, { test:/\\.css$/, use:'happypack/loader?id=css', // 配置id为css include:[ path.resolve(__dirname,'src') ] } ] }, plugins:[ new HappyPackPlugin({ id:'js', // id为js的loader配置 use:[ { loader:'babel-loader', options:{ plugins:['@babel/transform-runtime'], presets:['@babel/env'] } } ] }), new HappyPackPlugin({ id:'scss', // id为scss的loader配置 use:['style-loader','css-loader','sass-loader'] }), new HappyPackPlugin({ id:'css', // id为css的loader配置 use:['style-loader','css-loader'] }), ] }; Tree-Shaking Tree-Shaking原始的本意是”摇动树“，这样就会将一些分支”摇掉“，从而减少主干大小。而Webpack中的Tree-Shaking是类似的，在Webpack项目中，有一个入口文件，相当于树的主干，入口文件又依赖了许多模块。实际开发中，虽然依赖了某个模块，但其实只使用了其中的部分代码，通过Tree-Shaking，可以将模块中未使用的代码剔除掉，从而减少构建结果的大小。\n注意：只有使用ES6模块系统的代码，在mode为production时，Tree-Shaking才会生效。因此，在编写代码时尽量使用import/export的方式。\n按需加载 在开发中，我们一般会将业务代码打包为app.js，其他第三方依赖打包为vendor.js。这样会有一个比较大的问题，如果依赖的第三方模块过多，vendor.js会越来越大，而在浏览器加载时需要完全加载完vendor.js才可以，这样就会造成无谓的等待，因为我们当前页面可能只使用了一部分代码。此时可以使用Webpack来实现按需加载，只有在真正用到这个模块时才会加载相应的js。\n比如基于echarts开发了一个数据可视化页面，可以在这个路由组件下面使用异步的方式加载echarts的代码：\nimport('echarts').then(modules =\u003e { const echarts = modules.default; const chart = echarts.init(document.querySelector('#chart')); }); 不过使用按需加载时，构建代码中会包含Promise调用，因此低版本浏览器需要注入Promise的polyfill实现。\n提取公共代码 Webpack4中可以将多个公共模块打包一份，减少代码冗余，Webpack4之前的版本是使用webpack内置的CommonsChunkPlugin实现的，Webpack4直接配置optimization即可。\nmodule.exports = { optimization:{ splitChunks:{ cacheGroups:{ common:{ // 应用代码中公共模块 chunks: 'all', // 最小公共模块引用次数 minChunks: 2 }, vendor:{ // node_modules中第三方模块 test: /node_modules/, chunks: 'all', minChunks: 1 } } } } }; 第三方库代码的变更一般比较少(通过package.json的版本可以指定依赖版本)，因此构建出来的vendor.js基本不会变就可以利用浏览器的缓存机制进行缓存。\n而应用代码的变更是比较频繁的，因此单独打包为common.js，浏览器可以单独缓存，如果应用代码发生变更，浏览器只用重新下载common.js文件，而不用重新下载vendor.js。\n热更新 HMR(Hot Module Replacement)是Webpack提供的常用功能之一，它允许在运行时对模块进行修改，而无需刷新整个页面(LiveReload需要刷新页面才能加载)，这样有以下优势：\n保留应用状态，比如使用Vue/React时如果使用LiveReload，组件状态全部丢失，而HMR不会 只更新变更的内容，节省开发时间 使用以下配置即可打开内置的HMR功能：\nconst webpack = require('webpack'); module.exports = { devServer: { hot: true, // 启用热加载 contentBase: './dist', }, plugins:[ new webpack.NamedModulesPlugin(), // 打印更新的模块路径 new webpack.HotModuleReplacementPlugin() // 热更新插件 ] }; 小结 本文我们对Webpack4最常用的性能优化技术进行了学习，这些优化方法对业务代码的侵入性非常小（只有按需加载优化会要求使用import()函数进行加载），在实际的开发中，可以结合这些技术进行针对性的优化，比如开发时编译慢，可能就需要使用HappyPack插件进行多进程编译以加快编译速度等等。\n","wordCount":"335","inLanguage":"zh","datePublished":"2020-03-06T12:00:00Z","dateModified":"2020-03-06T12:00:00Z","author":{"@type":"Person","name":"Lei Xia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ddhigh.com/2020/03/06/webpack-optimize/"},"publisher":{"@type":"Organization","name":"每天进步一点点","logo":{"@type":"ImageObject","url":"https://www.ddhigh.com/favicon.ico"}}}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link href=/titilliumweb/titilliumweb.css rel=stylesheet><link rel=stylesheet href=/css/main.min.0eb4160ba4a2d63122fe8ae83f1560951a87ab510d5dab0615973b5206555759.css integrity="sha256-DrQWC6Si1jEi/oroPxVglRqHq1ENXasGFZc7UgZVV1k=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css integrity="sha512-ygEyjMC6rqnzJqWGjRTJUPYMEs9JUOm3i7OWUS9CgQ4XkBUvMsgCS1I8JqavidQ2ClHcREB7IbA2mN08+r9Elg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.894ca9c68afab956438c4926a0dc7f5293e04e08595bd27abdb123e94801f684.js></script><script>hljs.highlightAll()</script><script>$darkModeInit.Content|safeJS</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2871082647721658" crossorigin=anonymous></script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>每天进步一点点
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/>首页</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/books>出版物</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>留言板</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li><li class="navigation-item navigation-language"><a href=https://www.ddhigh.com/en/>EN</a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>Webpack4不求人(3) ——性能优化</h1></header><p><small>2020年3月6日&nbsp;· 335 字&nbsp;· 2 分钟</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#限定webpack处理文件范围>限定Webpack处理文件范围</a><ul><li><a href=#loader配置>loader配置</a></li><li><a href=#resolveextensions配置>resolve.extensions配置</a></li><li><a href=#modulenoparse配置>module.noParse配置</a></li></ul></li><li><a href=#ignoreplugin>IgnorePlugin</a></li><li><a href=#dllplugin>DllPlugin</a></li><li><a href=#happypack>HappyPack</a></li><li><a href=#tree-shaking>Tree-Shaking</a></li><li><a href=#按需加载>按需加载</a></li><li><a href=#提取公共代码>提取公共代码</a></li><li><a href=#热更新>热更新</a></li><li><a href=#小结>小结</a></li></ul></nav></div><section class=blog-content><h2 id=限定webpack处理文件范围>限定Webpack处理文件范围</h2><p>项目比较小的情况下Webpack的性能问题几乎可以忽略，但是一旦项目复杂度上升，Webpack会有额外的性能损失需要我们进行优化。</p><p>通过前面内容的学习我们可以知道Webpack主要干下面这些事情：</p><ol><li>通过entry指定的入口脚本进行依赖解析。</li><li>找到文件后通过配置的loader对其进行处理。</li></ol><p>因此，我们可以从这方面入手进行优化，减少Webpack搜索文件的范围，减少不必要的处理。</p><h3 id=loader配置>loader配置</h3><p>在之前的内容中介绍过loader可以使用test、include、exclude配置项来匹配需要Loader处理的文件，因此推荐给每个loader定义test之后还定义include或exclude。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>  	<span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.js$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;babel-loader&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>include</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;src&#39;</span>), <span style=color:#75715e>// 只处理src目录下的js文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h3 id=resolveextensions配置>resolve.extensions配置</h3><p>导入未添加扩展名的模块时，Webpack会通过resolve.extensions后缀去检查文件是否存在。由于resolve.extensions是一个数组，如果数组项比较多，正确的后缀放置得越靠后，Webpack尝试次数就会越多，影响到性能。</p><p>因此配置resolve.extensions时需要遵守以下规则：</p><ul><li>尽量减少后缀列表，不要将不可能存在的文件后缀配置进来</li><li>出现频率越高的后缀尽量写到前面，比如可以将.js写在第一个</li><li>业务代码中导入模块时，可以手动加上后缀导入，省去Webpack查找过程</li></ul><h3 id=modulenoparse配置>module.noParse配置</h3><p>module.noParse可以告诉Webpack忽略未采用模块系统文件的处理，可以有效地提高性能。比如常见的jQuery非常大，又没有采用模块系统，让Webpack解析这类型文件完全是浪费性能。</p><p>因此我们可以配置如下的module.noParse:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>  	<span style=color:#a6e22e>noParse</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>/jQuery/</span>]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=ignoreplugin>IgnorePlugin</h2><p>在导入模块时，IgnorePlugin可以忽略指定模块的生成。比如moment.js在导入时会自动导入本地化文件，一般情况下几乎不使用而且又比较大，此时可以通过IgnorePlugin忽略对本地化文件的生成，减小文件大小。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>webpack</span>.<span style=color:#a6e22e>IgnorePlugin</span>(<span style=color:#e6db74>/\.\/local/</span>, <span style=color:#e6db74>/moment/</span>)
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=dllplugin>DllPlugin</h2><p>使用过Windows操作系统的读者应该会经常看到以.dll扩展名的文件，这些文件叫做动态链接库，包含了其他程序或动态链接库的函数和数据。</p><p>Webpack的DllPlugin的思想是类似的，先将公共模块打包为独立的Dll模块，然后在业务代码中直接引用这些模块。采用DllPlugin之后会大大提升Webpack构建速度，原因在于，包含大量复用模块的动态链接库只需要编译一次，之后的构建中会直接引用这些构建好的模块。</p><p>在Webpack中使用动态链接库有以下两个步骤：</p><ol><li>通过webpack.DllPlugin插件打包出Dll库</li><li>通过webpack.DllReferencePlugin引用打包好的Dll库</li></ol><p>下面以React项目为例进行说明。</p><p>Dll库需要单独构建，因此我们需要一份单独的配置Webpack文件。</p><p>1.新建webpack.dll.config.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>webpack</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;webpack&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>  	<span style=color:#a6e22e>react</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;react&#39;</span>, <span style=color:#e6db74>&#39;react-dom&#39;</span>]
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_dll_[name].js&#39;</span>, <span style=color:#75715e>// 输出的文件名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;dist&#39;</span>), <span style=color:#75715e>// 输出到dist目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>library</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_dll_[name]&#39;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#75715e>// name要等于output.library里的name
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>webpack</span>.<span style=color:#a6e22e>DllPlugin</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;_dll_[name]&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#34;dist&#34;</span>, <span style=color:#e6db74>&#34;manifest.json&#34;</span>) <span style=color:#75715e>// 清单文件路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    })
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>2.编辑webpack.config.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>webpack</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;webpack&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/main&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;[name].js&#39;</span>, <span style=color:#75715e>// 输出的文件名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;dist&#39;</span>), <span style=color:#75715e>// 输出到dist目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 传入manifest.json
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>webpack</span>.<span style=color:#a6e22e>DllReferencePlugin</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>manifest</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#34;dist&#34;</span>, <span style=color:#e6db74>&#34;manifest.json&#34;</span>) <span style=color:#75715e>// 清单文件路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    })
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>3.添加构建命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;scripts&#34;</span>:{
</span></span><span style=display:flex><span> 		<span style=color:#f92672>&#34;build-dll&#34;</span>:<span style=color:#e6db74>&#34;webpack --config webpack.dll.config.js&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;build&#34;</span>:<span style=color:#e6db74>&#34;webpack&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>4.构建Dll</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm run build-dll
</span></span></code></pre></div><p>5.构建应用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm run build
</span></span></code></pre></div><blockquote><p>Dll需要先构建，否则应用将构建失败</p></blockquote><h2 id=happypack>HappyPack</h2><p>Webpack默认情况下是单进程执行的，因此无法利用多核优势，通过HappyPack可以变成多进程构建，从而提升构建速度。下面我们一起来看看如何使用happypack来加速构建。</p><p>1.安装happypack</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm isntall happypack
</span></span></code></pre></div><p>2.编辑配置文件，需要将Loader配置到HappyPack插件中，由HappyPack对Loader进行调用。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>HappyPackPlugin</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;happypack&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>path</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;path&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/main&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;build&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;[name].js&#39;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.js$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;happypack/loader?id=js&#39;</span>, <span style=color:#75715e>// 配置id为js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>include</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>,<span style=color:#e6db74>&#39;src&#39;</span>)
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.scss$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;happypack/loader?id=scss&#39;</span>, <span style=color:#75715e>// 配置id为scss
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>include</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>,<span style=color:#e6db74>&#39;src&#39;</span>)
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.css$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;happypack/loader?id=css&#39;</span>, <span style=color:#75715e>// 配置id为css
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>include</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>,<span style=color:#e6db74>&#39;src&#39;</span>)
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>HappyPackPlugin</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;js&#39;</span>, <span style=color:#75715e>// id为js的loader配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;babel-loader&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;@babel/transform-runtime&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>presets</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;@babel/env&#39;</span>]
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>    }),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>HappyPackPlugin</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;scss&#39;</span>, <span style=color:#75715e>// id为scss的loader配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;style-loader&#39;</span>,<span style=color:#e6db74>&#39;css-loader&#39;</span>,<span style=color:#e6db74>&#39;sass-loader&#39;</span>]
</span></span><span style=display:flex><span>    }),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>HappyPackPlugin</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;css&#39;</span>, <span style=color:#75715e>// id为css的loader配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;style-loader&#39;</span>,<span style=color:#e6db74>&#39;css-loader&#39;</span>]
</span></span><span style=display:flex><span>    }),
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=tree-shaking>Tree-Shaking</h2><p>Tree-Shaking原始的本意是”摇动树“，这样就会将一些分支”摇掉“，从而减少主干大小。而Webpack中的Tree-Shaking是类似的，在Webpack项目中，有一个入口文件，相当于树的主干，入口文件又依赖了许多模块。实际开发中，虽然依赖了某个模块，但其实只使用了其中的部分代码，通过Tree-Shaking，可以将模块中未使用的代码剔除掉，从而减少构建结果的大小。</p><blockquote><p>注意：只有使用ES6模块系统的代码，在mode为production时，Tree-Shaking才会生效。因此，在编写代码时尽量使用import/export的方式。</p></blockquote><h2 id=按需加载>按需加载</h2><p>在开发中，我们一般会将业务代码打包为app.js，其他第三方依赖打包为vendor.js。这样会有一个比较大的问题，如果依赖的第三方模块过多，vendor.js会越来越大，而在浏览器加载时需要完全加载完vendor.js才可以，这样就会造成无谓的等待，因为我们当前页面可能只使用了一部分代码。此时可以使用Webpack来实现按需加载，只有在真正用到这个模块时才会加载相应的js。</p><p>比如基于echarts开发了一个数据可视化页面，可以在这个路由组件下面使用异步的方式加载echarts的代码：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>import</span>(<span style=color:#e6db74>&#39;echarts&#39;</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>modules</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>echarts</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>modules</span>.<span style=color:#66d9ef>default</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>chart</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>echarts</span>.<span style=color:#a6e22e>init</span>(document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;#chart&#39;</span>));
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>不过使用按需加载时，构建代码中会包含Promise调用，因此低版本浏览器需要注入Promise的polyfill实现。</p><h2 id=提取公共代码>提取公共代码</h2><p>Webpack4中可以将多个公共模块打包一份，减少代码冗余，Webpack4之前的版本是使用webpack内置的CommonsChunkPlugin实现的，Webpack4直接配置<code>optimization</code>即可。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>optimization</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>splitChunks</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>cacheGroups</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>common</span><span style=color:#f92672>:</span>{ <span style=color:#75715e>// 应用代码中公共模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>chunks</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;all&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 最小公共模块引用次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>minChunks</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vendor</span><span style=color:#f92672>:</span>{ <span style=color:#75715e>// node_modules中第三方模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>					<span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/node_modules/</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>chunks</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;all&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>minChunks</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>第三方库代码的变更一般比较少(通过package.json的版本可以指定依赖版本)，因此构建出来的vendor.js基本不会变就可以利用浏览器的缓存机制进行缓存。</p><p>而应用代码的变更是比较频繁的，因此单独打包为common.js，浏览器可以单独缓存，如果应用代码发生变更，浏览器只用重新下载common.js文件，而不用重新下载vendor.js。</p><h2 id=热更新>热更新</h2><p>HMR(Hot Module Replacement)是Webpack提供的常用功能之一，它允许在运行时对模块进行修改，而无需刷新整个页面(LiveReload需要刷新页面才能加载)，这样有以下优势：</p><ul><li>保留应用状态，比如使用Vue/React时如果使用LiveReload，组件状态全部丢失，而HMR不会</li><li>只更新变更的内容，节省开发时间</li></ul><p>使用以下配置即可打开内置的HMR功能：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>webpack</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;webpack&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>devServer</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>hot</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 启用热加载
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>contentBase</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./dist&#39;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>webpack</span>.<span style=color:#a6e22e>NamedModulesPlugin</span>(), <span style=color:#75715e>// 打印更新的模块路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>webpack</span>.<span style=color:#a6e22e>HotModuleReplacementPlugin</span>() <span style=color:#75715e>// 热更新插件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  ]
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=小结>小结</h2><p>本文我们对Webpack4最常用的性能优化技术进行了学习，这些优化方法对业务代码的侵入性非常小（只有按需加载优化会要求使用import()函数进行加载），在实际的开发中，可以结合这些技术进行针对性的优化，比如开发时编译慢，可能就需要使用HappyPack插件进行多进程编译以加快编译速度等等。</p><p><img src=https://static.ddhigh.com/blog/2019-10-22-102654.jpg alt=0.jpeg></p><div class=blog-footer><div class=social-share></div><div class=copyright><ul><li style=margin-bottom:.5em>本文作者: <a href=https://ddhigh.com/ target=_blank style=color:#000;text-decoration:none>xialeistudio</a></li><li style=margin-bottom:.5em>本文链接: <a href=https://www.ddhigh.com/2020/03/06/webpack-optimize/ target=_blank style=color:#000;text-decoration:none>Webpack4不求人(3) ——性能优化</a></li><li>版权声明: <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank style=color:#000;text-decoration:none>「署名-非商业性使用-相同方式共享 4.0 国际」</a></li></ul></div><div style=margin-top:2rem><img src=/img/mp.png alt=qrcode></div></div></section><div class=paginator><a class=prev href=https://www.ddhigh.com/2020/03/11/webpack-loader-development/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg><span>Webpack4不求人(4)——编写自定义Loader</span></a>
<a class=next href=https://www.ddhigh.com/2020/03/02/react-ssr-example/><span>Webpack4不求人(2) ——手把手搭建TypeScript+React16+ReactRouter5同构应用脚手架</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","xialeistudio/discussion"),s.setAttribute("data-repo-id","R_kgDOKurTRA"),s.setAttribute("data-category","General"),s.setAttribute("data-category-id","DIC_kwDOKurTRM4CbCJt"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","en"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></div><footer class=footer><p>&copy; 2014 - 2025 <a href=https://www.ddhigh.com>每天进步一点点</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg></a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script><script src=https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js integrity="sha512-9DNXrSjk17bU9MUbRp3IjwcWe46V8FaGA062PFbryPUAEQVRbz4jiZP6FW0AdbqEGtMYBDWnul3eiGBMJOQajA==" crossorigin=anonymous referrerpolicy=no-referrer></script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>