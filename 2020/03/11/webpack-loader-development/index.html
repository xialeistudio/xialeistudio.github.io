<!doctype html><html lang=zh><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Webpack4不求人(4)——编写自定义Loader</title>
<meta charset=utf-8><meta content="Web开发 ,Java ,Go ,Node.js ,PHP ,Koa ,MySQL ,Redis ,前端 ,后端 ,数据库" name=keywords><meta name=description content="在前面的内容中，我们学习了Webpack的基本知识、常用脚手架和性能优化，虽然说大部分的开发场景社区已经又成熟的模块给我们使用，但是遇到特殊情况还是需要自己有独立开发的能力，因此今天我们一起来学习如何编写自定义Loader。
基本Loader Webpack中loader是一个CommonJs风格的函数，接收输入的源码，通过同步或异步的方式替换源码后进行输出。
module.exports = function(source, sourceMap, meta) { } source是输入的内容 sourceMap是可选的 meta是模块的元数据，也是可选的 需要注意的是，该导出函数必须使用function，不能使用箭头函数，因为loader编写过程中会经常使用到this访问选项和其他方法。"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/2020/03/11/webpack-loader-development/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com//index.xml title=每天进步一点点><script async defer data-website-id=52f8f0f9-d93d-466b-8ef5-508aae8c4ed4 src=https://analysis.ddhigh.com/script.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EC3XLVSGKV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EC3XLVSGKV")</script><meta property="og:url" content="https://www.ddhigh.com/2020/03/11/webpack-loader-development/"><meta property="og:site_name" content="每天进步一点点"><meta property="og:title" content="Webpack4不求人(4)——编写自定义Loader"><meta property="og:description" content="在前面的内容中，我们学习了Webpack的基本知识、常用脚手架和性能优化，虽然说大部分的开发场景社区已经又成熟的模块给我们使用，但是遇到特殊情况还是需要自己有独立开发的能力，因此今天我们一起来学习如何编写自定义Loader。
基本Loader Webpack中loader是一个CommonJs风格的函数，接收输入的源码，通过同步或异步的方式替换源码后进行输出。
module.exports = function(source, sourceMap, meta) { } source是输入的内容 sourceMap是可选的 meta是模块的元数据，也是可选的 需要注意的是，该导出函数必须使用function，不能使用箭头函数，因为loader编写过程中会经常使用到this访问选项和其他方法。"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-11T12:00:00+00:00"><meta property="article:modified_time" content="2020-03-11T12:00:00+00:00"><meta property="article:tag" content="Webpack"><meta name=twitter:card content="summary"><meta name=twitter:title content="Webpack4不求人(4)——编写自定义Loader"><meta name=twitter:description content="在前面的内容中，我们学习了Webpack的基本知识、常用脚手架和性能优化，虽然说大部分的开发场景社区已经又成熟的模块给我们使用，但是遇到特殊情况还是需要自己有独立开发的能力，因此今天我们一起来学习如何编写自定义Loader。
基本Loader Webpack中loader是一个CommonJs风格的函数，接收输入的源码，通过同步或异步的方式替换源码后进行输出。
module.exports = function(source, sourceMap, meta) { } source是输入的内容 sourceMap是可选的 meta是模块的元数据，也是可选的 需要注意的是，该导出函数必须使用function，不能使用箭头函数，因为loader编写过程中会经常使用到this访问选项和其他方法。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.ddhigh.com/posts/"},{"@type":"ListItem","position":2,"name":"Webpack4不求人(4)——编写自定义Loader","item":"https://www.ddhigh.com/2020/03/11/webpack-loader-development/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Webpack4不求人(4)——编写自定义Loader","name":"Webpack4不求人(4)——编写自定义Loader","description":"在前面的内容中，我们学习了Webpack的基本知识、常用脚手架和性能优化，虽然说大部分的开发场景社区已经又成熟的模块给我们使用，但是遇到特殊情况还是需要自己有独立开发的能力，因此今天我们一起来学习如何编写自定义Loader。\n基本Loader Webpack中loader是一个CommonJs风格的函数，接收输入的源码，通过同步或异步的方式替换源码后进行输出。\nmodule.exports = function(source, sourceMap, meta) { } source是输入的内容 sourceMap是可选的 meta是模块的元数据，也是可选的 需要注意的是，该导出函数必须使用function，不能使用箭头函数，因为loader编写过程中会经常使用到this访问选项和其他方法。","keywords":["webpack"],"articleBody":"在前面的内容中，我们学习了Webpack的基本知识、常用脚手架和性能优化，虽然说大部分的开发场景社区已经又成熟的模块给我们使用，但是遇到特殊情况还是需要自己有独立开发的能力，因此今天我们一起来学习如何编写自定义Loader。\n基本Loader Webpack中loader是一个CommonJs风格的函数，接收输入的源码，通过同步或异步的方式替换源码后进行输出。\nmodule.exports = function(source, sourceMap, meta) { } source是输入的内容 sourceMap是可选的 meta是模块的元数据，也是可选的 需要注意的是，该导出函数必须使用function，不能使用箭头函数，因为loader编写过程中会经常使用到this访问选项和其他方法。\n我们先编写一个基本的Loader，完成的工作很简单，那就是把输出的字符串进行替换。\n1.新建loader-example目录，执行npm初始化，并安装webpack\nmkdir loader-example cd loadeer-example npm init -y npm install webpack webpack-cli 2.构建项目目录\n|----loader # loader目录 |----replace-loader.js # 替换字符串的Loader |----src # 应用源码 |----index.js # 首页 |----package.json |----webpack.config.js 3.编写loader/replace-loader.js\nmodule.exports = function(source) { return source.replace(/World/g, 'Loader'); }; 本例中我们Loader只是简单的将源码中的”World“替换成了”Loader“。\n4.编写src/index.js\nconsole.log('Hello World'); 5.编写webpack.config.js\nconst path = require('path'); module.exports = { entry: './src/index', target: 'node', // 我们编译为Node.js环境下的JS，等下直接使用Node.js执行编译完成的文件 output:{ path: path.resolve(__dirname, 'build'), filename: '[name].js' }, module:{ rules:[ { test:/\\.js$/, use: 'replace-loader' } ] }, resolveLoader: { modules: ['./node_modules', './loader'] // 配置loader的查找目录 } }; 6.编写package.json\n{ \"scripts\":{ \"build\":\"webpack\" } } 7.执行构建\nnpm run build 8.构建完成后，执行build/main.js\nnode build/main.js 此时终端输出如下，我们编写的Loader工作正常。\nHello Loader Loader选项 我们使用第三方loader时经常可以看到传递选项的情况：\n{ test:/\\.js$/, use:[ { loader:'babel-loader', options:{ plugins:['@babel/transform-runtime'], presets:['@babel/env'] } } ] } 在Loader编写时，Webpack中官方推荐通过loader-utils来读取配置选项，我们需要先安装。\nnpm install loader-utils 我们给刚才编写的replace-loader传递一个选项，允许自定义替换结果。\nconst loaderUtils = require('loader-utils'); module.exports = function(source) { const options = loaderUtils.getOptions(this); return source.replace(/World/g, options.text); }; 接下来编辑webpack.config.js，给replace-loader传递选项。\nmodule.exports = { module:{ rules:[ { test:/\\.js$/, use:[ { loader:'replace-loader', options:{ text: 'Webpack4' } } ] } ] }, resolveLoader:{ modules: ['./node_modules', './loader'] } }; 执行构建之后用Node.js执行build/main.js，可以看到输出的内容已经发生变化了。\nHello Webpack4 异步Loader 在Loader中，如果存在异步调用，那么就无法直接通过return返回构建后的结果了，此时需要使用到Webpack提供的回调函数将数据进行回调。\nWebpack4给Loader提供了this.async()函数，调用之后返回一个callback，callback的签名如下:\nfunction callback( err: Error|null, content: string|Buffer, sourceMap?:SourceMap, meta?: any ) 例如我们需要在loader中调用setTimeout进行等待，则相应的代码如下：\nmodule.exports = function(source) { const callback = this.async(); setTimeout(() =\u003e { const output = source.replace(/World/g, 'Webpack4'); callback(null, output); }, 1000); } 执行构建，Webpack会等待一秒，然后再输出构建内容，通过Node.js执行构建后的文件，输出如下\nHello Webpack4 “Raw” Loader 默认情况下，资源文件会被转化为 UTF-8 字符串，然后传给 loader。通过设置 raw，loader 可以接收原始的 Buffer。比如处理非文本文件时(如图片等等)。\nmodule.exports = function(source) { assert(source instanceof Buffer); return someSyncOperation(source); }; module.exports.raw = true; // 设置当前Loader为raw loader, webpack会将原始的Buffer对象传入 读取loader配置文件 babel-loader在使用时可以加载.babelrc配置文件来配置plugins和presets，减少了webpack.config.js的代码量，便于维护。接下来我们编写一个i18n-loader，通过读取语言配置文件完成语言转换。\n项目结构 |----loader |----i18n-loader.js # loader |----i18n |----zh.json # 中文语言包 |----src |----index.js # 入口文件 |----webpack.config.js i18n/zh.json\n{ \"hello\": \"你好\", \"today\": \"今天\" } loader/i18n-loader.js\nconst loaderUtils = require('loader-utils'); const path = require('path'); module.exports = function (source) { const options = loaderUtils.getOptions(this); const locale = options ? options.locale : null; // 读取语言配置文件 let json = null; if (locale) { const filename = path.resolve(__dirname, '..', 'i18n', `${locale}.json`); json = require(filename); } // 读取语言标记 {{}} const matches = source.match(/\\{\\{\\w+\\}\\}/g); for (const match of matches) { const name = match.match(/\\{\\{(\\w+)\\}\\}/)[1].toLowerCase(); if (json !== null \u0026\u0026 json[name] !== undefined) { source = source.replace(match, json[name]); } else { source = source.replace(match, name); } } return source; } src/index.js\nconsole.log('{{Hello}}, {{Today}} is a good day.'); webpack.config.js\nconst path = require('path'); module.exports = { entry: './src/index', output: { path: path.resolve(__dirname, 'build'), filename: '[name].js' }, target: 'node', module: { rules: [ { test: /\\.js$/, use: [ { loader: 'i18n-loader', options: { // 传递选项 locale: 'zh' } } ] } ] }, resolveLoader: { modules: ['./node_modules', './loader'] } }; package.json\n{ \"scripts\":{ \"build\":\"webpack\" } } 执行构建 npm run build 构建完毕后使用Node.js执行build/main.js输出如下：\n你好, 今天 is a good day. 可以看到i18n-loader成功读取了配置文件。\n小结 本文简要介绍了Webpack中如何编写一个自定义的loader，权当抛砖引玉，更多的用法等待读者在实际工作中去挖掘，要想掌握Webpack的高级知识，Loader是必不可少的技能，有时候如果社区找不到合适的Loader，大家可以根据需要自己进行开发。\n","wordCount":"427","inLanguage":"zh","datePublished":"2020-03-11T12:00:00Z","dateModified":"2020-03-11T12:00:00Z","author":{"@type":"Person","name":"Lei Xia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ddhigh.com/2020/03/11/webpack-loader-development/"},"publisher":{"@type":"Organization","name":"每天进步一点点","logo":{"@type":"ImageObject","url":"https://www.ddhigh.com/favicon.ico"}}}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.d0df733b91ef046970ecd63de7aa626886fd263fd3fb2b8ff28b560e505831f7.css integrity="sha256-0N9zO5HvBGlw7NY956piaIb9Jj/T+yuP8otWDlBYMfc=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css integrity="sha512-ygEyjMC6rqnzJqWGjRTJUPYMEs9JUOm3i7OWUS9CgQ4XkBUvMsgCS1I8JqavidQ2ClHcREB7IbA2mN08+r9Elg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>$darkModeInit.Content|safeJS</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>每天进步一点点
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/>首页</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/books>出版物</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>留言板</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li><li class="navigation-item navigation-language"><a href=https://www.ddhigh.com/en/>EN</a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>Webpack4不求人(4)——编写自定义Loader</h1></header><p><small>2020年3月11日&nbsp;· 427 字&nbsp;· 3 分钟</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#基本loader>基本Loader</a></li><li><a href=#loader选项>Loader选项</a></li><li><a href=#异步loader>异步Loader</a></li><li><a href=#raw-loader>&ldquo;Raw&rdquo; Loader</a></li><li><a href=#读取loader配置文件>读取loader配置文件</a><ul><li><a href=#项目结构>项目结构</a></li><li><a href=#执行构建>执行构建</a></li></ul></li><li><a href=#小结>小结</a></li></ul></nav></div><section class=blog-content><p>在前面的内容中，我们学习了Webpack的基本知识、常用脚手架和性能优化，虽然说大部分的开发场景社区已经又成熟的模块给我们使用，但是遇到特殊情况还是需要自己有独立开发的能力，因此今天我们一起来学习如何编写自定义Loader。</p><h2 id=基本loader>基本Loader</h2><p>Webpack中loader是一个CommonJs风格的函数，接收输入的源码，通过同步或异步的方式替换源码后进行输出。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>source</span>, <span style=color:#a6e22e>sourceMap</span>, <span style=color:#a6e22e>meta</span>) {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>source是输入的内容</li><li>sourceMap是可选的</li><li>meta是模块的元数据，也是可选的</li></ul><p>需要注意的是，该导出函数必须使用function，不能使用箭头函数，因为loader编写过程中会经常使用到<code>this</code>访问选项和其他方法。</p><p>我们先编写一个基本的Loader，完成的工作很简单，那就是把输出的字符串进行替换。</p><p>1.新建loader-example目录，执行npm初始化，并安装webpack</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir loader-example
</span></span><span style=display:flex><span>cd loadeer-example
</span></span><span style=display:flex><span>npm init -y
</span></span><span style=display:flex><span>npm install webpack webpack-cli
</span></span></code></pre></div><p>2.构建项目目录</p><pre tabindex=0><code>|----loader # loader目录
		|----replace-loader.js # 替换字符串的Loader
|----src   # 应用源码
		|----index.js # 首页
|----package.json
|----webpack.config.js
</code></pre><p>3.编写loader/replace-loader.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>source</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/World/g</span>, <span style=color:#e6db74>&#39;Loader&#39;</span>);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>本例中我们Loader只是简单的将源码中的”World“替换成了”Loader“。</p><p>4.编写src/index.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Hello World&#39;</span>);
</span></span></code></pre></div><p>5.编写webpack.config.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>path</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;path&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/index&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;node&#39;</span>, <span style=color:#75715e>// 我们编译为Node.js环境下的JS，等下直接使用Node.js执行编译完成的文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;build&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;[name].js&#39;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.js$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;replace-loader&#39;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolveLoader</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>  	<span style=color:#a6e22e>modules</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;./node_modules&#39;</span>, <span style=color:#e6db74>&#39;./loader&#39;</span>] <span style=color:#75715e>// 配置loader的查找目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>6.编写package.json</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;scripts&#34;</span>:{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;build&#34;</span>:<span style=color:#e6db74>&#34;webpack&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>7.执行构建</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm run build
</span></span></code></pre></div><p>8.构建完成后，执行build/main.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>node build/main.js
</span></span></code></pre></div><p>此时终端输出如下，我们编写的Loader工作正常。</p><pre tabindex=0><code>Hello Loader
</code></pre><h2 id=loader选项>Loader选项</h2><p>我们使用第三方loader时经常可以看到传递选项的情况：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.js$/</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;babel-loader&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;@babel/transform-runtime&#39;</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>presets</span><span style=color:#f92672>:</span>[<span style=color:#e6db74>&#39;@babel/env&#39;</span>]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在Loader编写时，Webpack中官方推荐通过loader-utils来读取配置选项，我们需要先安装。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install loader-utils
</span></span></code></pre></div><p>我们给刚才编写的replace-loader传递一个选项，允许自定义替换结果。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>loaderUtils</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;loader-utils&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>source</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>options</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loaderUtils</span>.<span style=color:#a6e22e>getOptions</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/World/g</span>, <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>text</span>);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>接下来编辑webpack.config.js，给replace-loader传递选项。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span><span style=color:#e6db74>/\.js$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span>[
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;replace-loader&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Webpack4&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolveLoader</span><span style=color:#f92672>:</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>modules</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;./node_modules&#39;</span>, <span style=color:#e6db74>&#39;./loader&#39;</span>]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>执行构建之后用Node.js执行build/main.js，可以看到输出的内容已经发生变化了。</p><pre tabindex=0><code>Hello Webpack4
</code></pre><h2 id=异步loader>异步Loader</h2><p>在Loader中，如果存在异步调用，那么就无法直接通过return返回构建后的结果了，此时需要使用到Webpack提供的回调函数将数据进行回调。</p><p>Webpack4给Loader提供了<code>this.async()</code>函数，调用之后返回一个callback，callback的签名如下:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>callback</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>err</span><span style=color:#f92672>:</span> Error<span style=color:#f92672>|</span><span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span><span style=color:#f92672>|</span><span style=color:#a6e22e>Buffer</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sourceMap</span><span style=color:#f92672>?:</span><span style=color:#a6e22e>SourceMap</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>meta</span><span style=color:#f92672>?:</span> <span style=color:#a6e22e>any</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>例如我们需要在loader中调用setTimeout进行等待，则相应的代码如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>source</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>callback</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#66d9ef>async</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setTimeout</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>output</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/World/g</span>, <span style=color:#e6db74>&#39;Webpack4&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>callback</span>(<span style=color:#66d9ef>null</span>, <span style=color:#a6e22e>output</span>);
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>执行构建，Webpack会等待一秒，然后再输出构建内容，通过Node.js执行构建后的文件，输出如下</p><pre tabindex=0><code>Hello Webpack4
</code></pre><h2 id=raw-loader>&ldquo;Raw&rdquo; Loader</h2><p>默认情况下，资源文件会被转化为 UTF-8 字符串，然后传给 loader。通过设置 <code>raw</code>，loader 可以接收原始的 <code>Buffer</code>。比如处理非文本文件时(如图片等等)。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>source</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>assert</span>(<span style=color:#a6e22e>source</span> <span style=color:#66d9ef>instanceof</span> <span style=color:#a6e22e>Buffer</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>someSyncOperation</span>(<span style=color:#a6e22e>source</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>raw</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置当前Loader为raw loader, webpack会将原始的Buffer对象传入
</span></span></span></code></pre></div><h2 id=读取loader配置文件>读取loader配置文件</h2><p>babel-loader在使用时可以加载.babelrc配置文件来配置plugins和presets，减少了webpack.config.js的代码量，便于维护。接下来我们编写一个i18n-loader，通过读取语言配置文件完成语言转换。</p><h3 id=项目结构>项目结构</h3><pre tabindex=0><code>|----loader
		|----i18n-loader.js # loader
|----i18n
		|----zh.json # 中文语言包
|----src
		|----index.js # 入口文件
|----webpack.config.js
</code></pre><p>i18n/zh.json</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;hello&#34;</span>: <span style=color:#e6db74>&#34;你好&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;today&#34;</span>: <span style=color:#e6db74>&#34;今天&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>loader/i18n-loader.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>loaderUtils</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;loader-utils&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>path</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;path&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>source</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>options</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loaderUtils</span>.<span style=color:#a6e22e>getOptions</span>(<span style=color:#66d9ef>this</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>locale</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>options</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>locale</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 读取语言配置文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>json</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>locale</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>filename</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;..&#39;</span>, <span style=color:#e6db74>&#39;i18n&#39;</span>, <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>locale</span><span style=color:#e6db74>}</span><span style=color:#e6db74>.json`</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>json</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#a6e22e>filename</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 读取语言标记 {{}}
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>matches</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>match</span>(<span style=color:#e6db74>/\{\{\w+\}\}/g</span>); 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>match</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>matches</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>match</span>.<span style=color:#a6e22e>match</span>(<span style=color:#e6db74>/\{\{(\w+)\}\}/</span>)[<span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>toLowerCase</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>json</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>json</span>[<span style=color:#a6e22e>name</span>] <span style=color:#f92672>!==</span> <span style=color:#66d9ef>undefined</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>source</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#a6e22e>match</span>, <span style=color:#a6e22e>json</span>[<span style=color:#a6e22e>name</span>]);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>source</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#a6e22e>match</span>, <span style=color:#a6e22e>name</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>source</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>src/index.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;{{Hello}}, {{Today}} is a good day.&#39;</span>);
</span></span></code></pre></div><p>webpack.config.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>path</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;path&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./src/index&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;build&#39;</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;[name].js&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;node&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.js$/</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i18n-loader&#39;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 传递选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                            <span style=color:#a6e22e>locale</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;zh&#39;</span>
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resolveLoader</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>modules</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;./node_modules&#39;</span>, <span style=color:#e6db74>&#39;./loader&#39;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>package.json</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;scripts&#34;</span>:{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;build&#34;</span>:<span style=color:#e6db74>&#34;webpack&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=执行构建>执行构建</h3><pre tabindex=0><code>npm run build
</code></pre><p>构建完毕后使用Node.js执行build/main.js输出如下：</p><pre tabindex=0><code>你好, 今天 is a good day.
</code></pre><p>可以看到i18n-loader成功读取了配置文件。</p><h2 id=小结>小结</h2><p>本文简要介绍了Webpack中如何编写一个自定义的loader，权当抛砖引玉，更多的用法等待读者在实际工作中去挖掘，要想掌握Webpack的高级知识，Loader是必不可少的技能，有时候如果社区找不到合适的Loader，大家可以根据需要自己进行开发。</p><p><img alt=0 src=https://static.ddhigh.com/blog/2020-03-11-060831.png></p><div class=blog-footer><div class=social-share></div><div class=copyright><ul><li style=margin-bottom:.5em>本文作者: <a href=https://ddhigh.com/ target=_blank style=color:#000;text-decoration:none>xialeistudio</a></li><li style=margin-bottom:.5em>本文链接: <a href=https://www.ddhigh.com/2020/03/11/webpack-loader-development/ target=_blank style=color:#000;text-decoration:none>Webpack4不求人(4)——编写自定义Loader</a></li><li>版权声明: <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank style=color:#000;text-decoration:none>「署名-非商业性使用-相同方式共享 4.0 国际」</a></li></ul></div><div style=margin-top:2rem><img src=/img/mp.png alt=qrcode></div></div></section><div class=paginator><a class=prev href=https://www.ddhigh.com/2020/03/18/webpack-plugin-development/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>Webpack4不求人(5)——编写自定义插件</span></a>
<a class=next href=https://www.ddhigh.com/2020/03/06/webpack-optimize/><span>Webpack4不求人(3) ——性能优化</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","xialeistudio/discussion"),s.setAttribute("data-repo-id","R_kgDOKurTRA"),s.setAttribute("data-category","General"),s.setAttribute("data-category-id","DIC_kwDOKurTRM4CbCJt"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","en"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></div><footer class=footer><p>&copy; 2014 - 2024 <a href=https://www.ddhigh.com/>每天进步一点点</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script><script src=https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js integrity="sha512-9DNXrSjk17bU9MUbRp3IjwcWe46V8FaGA062PFbryPUAEQVRbz4jiZP6FW0AdbqEGtMYBDWnul3eiGBMJOQajA==" crossorigin=anonymous referrerpolicy=no-referrer></script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>