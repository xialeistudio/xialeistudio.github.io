<!doctype html><html lang=zh><head><meta name=generator content="Hugo 0.124.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>Lei Xia</title>
<meta charset=utf-8><meta name=description content="Ladder@Learning & Writing & Sharing"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com//index.xml title="Lei Xia"><meta property="og:title" content="Lei Xia"><meta property="og:description" content="Learning & Writing & Sharing"><meta property="og:type" content="website"><meta property="og:url" content="https://www.ddhigh.com/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Lei Xia"><meta name=twitter:description content="Learning & Writing & Sharing"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Lei Xia","url":"https://www.ddhigh.com/","description":"Learning \u0026amp; Writing \u0026amp; Sharing","thumbnailUrl":"https://www.ddhigh.com/favicon.ico","sameAs":[]}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.bdcd9f7232970786bae2a6f540d0af8c6bb155414954e87f05e933eccd48f434.css integrity="sha256-vc2fcjKXB4a64qb1QNCvjGuxVUFJVOh/Bekz7M1I9DQ=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>$darkModeInit.Content|safeJS</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EC3XLVSGKV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EC3XLVSGKV")</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>标签</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/books>出版物</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>留言板</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li><li class="navigation-item navigation-language"><a href=https://www.ddhigh.com/en/>EN</a></li></ul></section></nav><div id=content><div class=home><div class=info><div class=intro><h1>Lei Xia</h1><small>Sr. Software Engineer | Solution Architect</small><p><p>抒写代码，尽享生活，筑就未来。</p><p><a href=/atom.xml target=_blank rel=noopener>订阅</a> ·
<a href=/sponsors target=_blank rel=noopener>赞赏</a></p></p></div></div></div><div class=blog-wrapper><div><div class=blog-list><article><div class=blog-card><h3><a href=/2015/02/05/angularjs-ueditor-directive/>angularjs ueditor指令</a></h3><p><small>2015年2月5日&nbsp;· 296 字&nbsp;· 2 分钟</small><p>一直以来，angularjs的富文本编辑器都比较难做，主要是第三方的编辑器很难集成进来，今天花时间研究了一下，发现ueditor主要加载两个js文件
ueditor.config.js ueditor.all.js 能不能把这两个文件异步加载呢？答案是肯定的。我们新建一个服务用来异步加载资源，并设置必要的回调方法。
Factory services.factory('Common', ['$http', '$q', function($http, $q) { return { loadScript: function(url, callback) { var head = document.getElementsByTagName("head")[0]; var script = document.createElement("script"); script.setAttribute("type", "text/javascript"); script.setAttribute("src", url); script.setAttribute("async", true); script.setAttribute("defer", true); head.appendChild(script); //fuck ie! duck type if (document.all) { script.onreadystatechange = function() { var state = this.readyState; if (state === 'loaded' || state === 'complete') { callback && callback(); } } } else { //firefox, chrome script.onload = function() { callback && callback(); } } }, loadCss: function(url) { var ele = document.</div></article><article><div class=blog-card><h3><a href=/2015/01/30/angularjs-online-music-player/>基于angularjs的在线音乐播放器</a></h3><p><small>2015年1月30日&nbsp;· 5 字&nbsp;· 1 分钟</small><p>项目地址 https://github.com/xialeistudio/angular-audio-player
在线demo http://ngdemo.sinaapp.com/audio/
效果图</div></article><article><div class=blog-card><h3><a href=/2015/01/29/android-hangup-call/>android直接挂断电话</a></h3><p><small>2015年1月29日&nbsp;· 1023 字&nbsp;· 5 分钟</small><p>最近在写一个用来发短信的机器人（android),当然需要屏蔽所有来电了。多的话不说了，直接看步骤。（IDE为android studio）： 1.在 src/main下新建 aidl 目录。
2.在src/main/aidl下新建包 com.android.internal.telephony。
3.在com.android.internal.telephony新建文件 ITelephony.aidl，内容如下:
/* * Copyright (C) 2007 The Android Open Source Project * * Licensed under the Apache License, Version 2.0 (the "License"); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div></article><article><div class=blog-card><h3><a href=/2015/01/28/php-qiniu-invalid-mutilpart-format/>七牛上传出现 invalid mutilpart format的解决方案</a></h3><p><small>2015年1月28日&nbsp;· 106 字&nbsp;· 1 分钟</small><p>今天用umeditor编辑文章上传图片的时候发现一直卡在"loading&mldr;"，打开控制台发现出现了500错误，进一步调试发现是七牛上传报错了。
整个上传流程是
浏览器=》业务服务器=》七牛服务器
在上传方法断点调试发现$_FILES数组正常，所以排除了浏览器到业务服务器上传问题，继续调试
通过查看七牛SDK源码发现在 http.php的第119行附近有这样的代码：
$options = array( CURLOPT_USERAGENT => $req->UA, CURLOPT_RETURNTRANSFER => true, CURLOPT_SSL_VERIFYPEER => false, CURLOPT_SSL_VERIFYHOST => false, CURLOPT_HEADER => true, CURLOPT_NOBODY => false, CURLOPT_CUSTOMREQUEST => 'POST', CURLOPT_URL => $url['path'], CURLOPT_SAFE_UPLOAD => false ); 请注意最后那个
CURLOPT_SAFE_UPLOAD => false 这里应该是跟上传有关的设置，很有可能是这里的问题，果然，GOOGLE发现PHP的CURL上传文件跟PHP版本的关系很大。
传统上，PHP的cURL支持通过在数组数据中，使用“@+文件全路径”的语法附加文件，供cURL读取上传。这与命令行直接调用cURL程序的语法是一致的：
curl_setopt(ch, CURLOPT_POSTFIELDS, array( 'file' => '@'.realpath('image.png'), )); 但PHP从5.5开始引入了新的CURLFile类用来指向文件。CURLFile类也可以详细定义MIME类型、文件名等可能出现在multipart/form-data数据中的附加信息。PHP推荐使用CURLFile替代旧的@语法：
curl_setopt(ch, CURLOPT_POSTFIELDS, [ 'file' => new CURLFile(realpath('image.png')), ]); PHP 5.5另外引入了CURL_SAFE_UPLOAD选项，可以强制PHP的cURL模块拒绝旧的@语法，仅接受CURLFile式的文件。5.5的默认值为false，5.6的默认值为true。
但是坑的一点在于：@语法在5.5就已经被打了deprecated，在5.6中就直接被删除了（会产生 ErorException: The usage of the @filename API for file uploading is deprecated.</div></article><article><div class=blog-card><h3><a href=/2015/01/24/baidu-map-custom-overlay/>百度地图添加自定义标注</a></h3><p><small>2015年1月24日&nbsp;· 107 字&nbsp;· 1 分钟</small><p>百度地图的默认标注是一个 红色 的地标，如果要做互动性强的地图应用，几乎没提供什么额外信息，本文教大家怎么添加自定义标注，如添加头像。
JS代码 var icon = new BMap.Icon('头像URL地址', new BMap.Size(33, 33), { offset: new BMap.Size(10, 25), imageOffset: new BMap.Size(0, 0) }); markers[i] = new BMap.Marker(new BMap.Point([经度], [纬度]), { icon: icon }); map.addOverlay(markers[i]); 由于百度地图的限制，我们不能获取标注的HTML，只能采取“特别”的方式对头像增加样式，比如圆角，边框等等。
var avatarRadiusCompleted = false; var avatarRadius = setInterval(function() { avatarRadius && clearInterval(avatarRadius); $('#map').find('img').each(function() { var src = $(this).attr('src'); if (src.indexOf('map') == -1) { $(this).addClass('xl-map-avatar'); //.xl-map-avatar 为自定义的CSS } }); avatarRadiusCompleted = true; }, 100); CSS代码 .xl-map-avatar { width: 32px; height: 32px; border: 1px solid white !</div></article><article><div class=blog-card><h3><a href=/2015/01/20/css3-loading/>css3打造炫酷loading</a></h3><p><small>2015年1月20日&nbsp;· 203 字&nbsp;· 1 分钟</small><p>css3的优点就不多说了，一个很重要的，节约了带宽，以往需要使用图片的地方很多时候都可以使用CSS3来实现。 本文将带来一个利用CSS3制作loading的教程，这里直接上代码了。
CSS代码 @keyframes spin { 0% { transform: rotate(0deg); -webkit-transform: rotate(0deg); } 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg); } } @-webkit-keyframes spin { 0% { transform: rotate(0deg); -webkit-transform: rotate(0deg); } 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg); } } @keyframes spinoff { 0% { transform: rotate(0deg); -webkit-transform: rotate(0deg); } 100% { transform: rotate(-360deg); -webkit-transform: rotate(-360deg); } } @-webkit-keyframes spinoff { 0% { transform: rotate(0deg); -webkit-transform: rotate(0deg); } 100% { transform: rotate(-360deg); -webkit-transform: rotate(-360deg); } } body { margin: 0; } .</div></article><article><div class=blog-card><h3><a href=/2015/01/12/php-location-by-ipgps-with-baidu-mapapi/>php利用百度地图API进行IP定位和GPS定位</a></h3><p><small>2015年1月12日&nbsp;· 271 字&nbsp;· 2 分钟</small><p>最近在做一个手机端的webapp地图应用，而核心内容当然是定位了，但是定位的话有几种方式，IP定位,GPS定位，基站定位（这个貌似webapp用不了），
那么剩下核心的gps定位和ip定位了，我们知道，html5有定位API，但是该API拿到的GPS数据是硬件坐标，无法直接显示在地图上。
后来上百度LBS云看到有地图IP定位API和GPS坐标转换API，地址：http://developer.baidu.com/map/
百度地图API的调用需要申请KEY，这里就不具体介绍了，直接贴上本人写了两个关键方法，为了方便前台调用，返回数据采用以下格式：
{ address: "北京市海淀区西二旗北路", province: "北京市", city: "北京市", street: "西二旗北路", street_number: "", city_code: 131, lng: 116.3207676804, lat: 40.064084055578 } PHP代码 &lt;?php /** * @author xialei &lt;xialeistudio@gmail.com> */ class map { private static $_instance; const REQ_GET = 1; const REQ_POST = 2; /** * 单例模式 * @return map */ public static function instance() { if (!self::$_instance instanceof self) { self::$_instance = new self; } return self::$_instance; } /** * 执行CURL请求 */ protected function async($api,array $params) { $ch = curl_init($api.</div></article><article><div class=blog-card><h3><a href=/2015/01/08/mobile-swipe/>移动端滑动的实现</a></h3><p><small>2015年1月8日&nbsp;· 35 字&nbsp;· 1 分钟</small><p>如果想在移动端判断用户的是否滑动以及滑动方向时，可以不使用第三方库，直接用touch事件处理即可，没必要增加不必要的代码，减轻移动端网络压力。
重点 移动端的touch事件有三个: touchstart、touchmove、touchend 分别代表 触摸开始，触摸移动，触摸结束
var _begin; var _end; document.querySelector('#target').addEventListener('touchstart', function(e) { _begin = e.changedTouches[0].pageX; }, false); document.querySelector('#target').addEventListener('touchend', function(e) { _end = e.changedTouches[0].pageX; if (_end > _begin) { console.log('从左向右') }else{ console.log('从右向左') } }, false);</div></article><article><div class=blog-card><h3><a href=/2014/12/29/svn-commit-error/>SVN命令行提交“--This line, and those below, will be ignored--”</a></h3><p><small>2014年12月29日&nbsp;· 49 字&nbsp;· 1 分钟</small><p>今天phpstorm突然抽风，导致svn不能用，无奈只好用svn命令来提交。
svn commit -m "init" 结果报错
--This line, and those below, will be ignored-- M webroot/thatyear/js/main.js ~ ~ ~ ~ ~ ~ ~ ~ ~ "svn-commit.2.tmp" 4L, 83C 直接保存发现会出现以下结果
Log message unchanged or not specified (a)bort, (c)ontinue, (e)dit: 输入c提交
*我这是设置了SVN提交默认编辑器的时候才会这样，默认是不会设置的。*按以下操作设置提交的编辑器
vi ~/.subversion/config 找到[helpers]下的 editor-cmd 节，更改为vi即可
[helpers] editor-cmd = /usr/bin/vi</div></article><article><div class=blog-card><h3><a href=/2014/12/28/wordpress-prettify/>wordpress使用prettify插件实现代码高亮</a></h3><p><small>2014年12月28日&nbsp;· 15 字&nbsp;· 1 分钟</small><p>最近百度感冒的太严重了，统计代码严重拖慢网页打开速度，不得已，只得暂时关闭JS统计代码。而另一个重灾区&ndash;ueditor也是太大了。我着实受不了。也关掉了。那么问题来了。之前用ueditor有配套的代码高亮插件，取消ueditor之后，代码不亮了。 别急，wordpress的插件多着呢!
步骤 1.插件->安装插件，搜索 &ldquo;prettify&rdquo; ，排名第一的插件就是他了，直接启用吧
2.wordpress这边就配置完了，以后写代码时，像这样
&lt;pre class="prettyprint linenums"> &lt;?php echo 1; &lt;/pre> 刷新一下页面，是不是发现已经变了呢~，这款插件效果确实挺赞的！</div></article></div><div class=paginator><a class=prev href=/page/24/>&larr;&nbsp;&nbsp;Pre Page</a>
<a class=next href=/page/26/>Next Page&nbsp;&nbsp;&rarr;</a></div></div></div></div><footer class=footer><p>&copy; 2014 - 2024 <a href=https://www.ddhigh.com/>Lei Xia</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>