<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.123.8"><meta name=viewport content="width=device-width,initial-scale=1"><title>Lei Xia</title>
<meta charset=utf-8><meta name=description content="Ladder@Learning & Writing & Sharing"><meta name=author content="Lei Xia"><link rel=canonical href=https://www.ddhigh.com/><link rel=alternate type=application/rss+xml href=https://www.ddhigh.com//index.xml title="Lei Xia"><meta property="og:title" content="Lei Xia"><meta property="og:description" content="Learning & Writing & Sharing"><meta property="og:type" content="website"><meta property="og:url" content="https://www.ddhigh.com/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Lei Xia"><meta name=twitter:description content="Learning & Writing & Sharing"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Lei Xia","url":"https://www.ddhigh.com/","description":"Learning \u0026amp; Writing \u0026amp; Sharing","thumbnailUrl":"https://www.ddhigh.com/favicon.ico","sameAs":[]}</script><link rel=icon href=/img/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/img/favicon.ico><link rel=manifest href=/img/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.5dd042a107aa191c819948e5648b04844bec5bdd365fdcf2b880177ce3d89b79.css integrity="sha256-XdBCoQeqGRyBmUjlZIsEhEvsW902X9zyuIAXfOPYm3k=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>$darkModeInit.Content|safeJS</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EC3XLVSGKV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EC3XLVSGKV")</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/books>Books</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/guestbook>Guestbook</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xialeistudio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><div class=home><div class=info><div class=intro><h1>Lei Xia</h1><small>Sr. Software Engineer | Solution Architect</small><p><p>Writing code, Enjoying life, Building future</p><p><a href=/atom.xml target=_blank rel=noopener>RSS</a> ·
<a href=/sponsors target=_blank rel=noopener>Sponsor</a></p></p></div></div></div><div class=blog-wrapper><div><div class=blog-list><article><div class=blog-card><h3><a href=/2014/11/15/angularjs-empty-array/>Angularjs处理后端空数据</a></h3><p><small>November 15, 2014&nbsp;· 57 words&nbsp;· One minute</small><p>Yii1.x DAO中的queryAll方法查询，如果有结果，会返回一个数组，如果没有结果，会返回null。现在分两种情况：
返回空数组 $array = array( ); echo json_encode($array); 输出为
[] 返回null $array = null; echo json_encode($array); 输出为
null 那么问题来了，JS接收这两个的结果是不同的。
如果使用以下代码判断数据:
if(data.length == 0){ //当前评论为空 }else{ //当前评论不为空 } 如果返回 [] ，这段代码是生效的。但是如果返回 null ,这个就有问题了。
后来，使用
if(data == null){ //评论为空 }else{ //评论不为空 } 这个判断老是出问题，后端明明返回null了，判断还是错误的，这时候想到JS也是若类型语言，会不会是类型的问题。
console.log(typeof data) 返回的是**&ldquo;string&rdquo;**
那么问题就解决了，用以下代码就可以了
if(data.length == 0 || data == "null"){ //评论为空 }else{ //评论不为空 }</div></article><article><div class=blog-card><h3><a href=/2014/11/14/angularjs-traverse-empty-array/>angularjs遍历空数组&索引数组</a></h3><p><small>November 14, 2014&nbsp;· 34 words&nbsp;· One minute</small><p>今天做开发时发现控制老是报错，虽然不影响使用，但是作为有那么一点“强迫症”的我来说，无法忍受。通过调试发现是ng-repeat对一个空数组遍历出错，另外，[&lsquo;ab&rsquo;,&lsquo;cd&rsquo;,&lsquo;ad&rsquo;]这样只有值没有键的数组也会遍历出错。
解决办法 &lt;li class="media" ng-repeat="item in comments track by $index"> &lt;div class="media-body"> &lt;strong>&lt;/strong> &lt;p> &lt;br /> &lt;time>&lt;/time> &lt;br /> &lt;span ng-if="item.comment_author_url.length>0"> &lt;i class="fa fa-globe">&lt;/i> &lt;a href="" target="_blank">&lt;/a> &lt;/span> &lt;/p> &lt;/div> &lt;/li> 特别注意track by $index</div></article><article><div class=blog-card><h3><a href=/2014/11/13/illegalstateexception-can-not-perform-this-action-after-onsaveinstancestate/>IllegalStateException： Can not perform this action after onSaveInstanceState</a></h3><p><small>November 13, 2014&nbsp;· 13 words&nbsp;· One minute</small><p>今天使用Fragment的时候，出现了这个错误 IllegalStateException: Can not perform this action after onSaveInstanceState。查看一下控制台，发现是FragmentManager的commit()方法报错的，看字面意思应该是
onSaveInstanceState这个方法之后不能处理这个操作（指commit()）。
因为onSaveInstanceState 方法是在该Activity即将被销毁前调用，来保存Activity数据的，如果在保存完状态后再给它添加Fragment就会出错。解决办法就是把commit（）方法替换成 commitAllowingStateLoss()就行了，其效果是一样的。</div></article><article><div class=blog-card><h3><a href=/2014/11/11/android-cache-image-with-imageloader/>android使用ImageLoader缓存图片</a></h3><p><small>November 11, 2014&nbsp;· 61 words&nbsp;· One minute</small><p>缓存和异步是两个极大提升用户体验的好东西，android加载图片时的开销还是挺大的，要是不做缓存同步加载，网速不给力的情况下，等个十几秒是有可能的。
今天要说的是一个叫做ImageLoader的库
GITHUB:https://github.com/nostra13/Android-Universal-Image-Loader
使用这个库有以下几步：
导入libs目录 声明自己的MyApplication类（继承Application） 在onCreate()方法中 public void onCreate() { super.onCreate(); DisplayImageOptions options = new DisplayImageOptions.Builder() .cacheInMemory() //缓存在内存中 .cacheOnDisc() //磁盘缓存 .build(); ImageLoaderConfiguration config2 = new ImageLoaderConfiguration.Builder(this) .defaultDisplayImageOptions(options) .threadPriority(Thread.NORM_PRIORITY - 2) .denyCacheImageMultipleSizesInMemory() .discCacheFileNameGenerator(new Md5FileNameGenerator()) .tasksProcessingOrder(QueueProcessingType.LIFO) .build(); ImageLoader.getInstance().init(config2); } 在要加载图片的地方使用 DisplayImageOptions options = new DisplayImageOptions.Builder() .cacheInMemory() // 缓存用 .cacheOnDisc() .bitmapConfig(Bitmap.Config.RGB_565)//防止溢出 .displayer(new RoundedBitmapDisplayer(139)) // 图片圆角显示，值为整数 .build(); ImageLoader.getInstance().displayImage(url, avatar, options); 其中 url 是图片URL地址，avatar为ImageView,options为动态配置，这里加了一个防止溢出的参数。
好了，使用起来是不是很简单呢~我们压根不用操心异步和缓存的问题了</div></article><article><div class=blog-card><h3><a href=/2014/11/10/async-http-client-socket-timeout/>async http client socket超时问题</a></h3><p><small>November 10, 2014&nbsp;· 4 words&nbsp;· One minute</small><p>最近做的一个项目的HTTP模块使用了loopj的asynchttpclient (https://github.com/loopj/android-async-http）。
自动更新模块总是出现sockettimeout的exception,查来查去也不知道什么问题，为此还换了asynchttpclient的库版本。但是问题也没解决。
仔细看了一下，提示的是timeout，应该从这方面去看看，后面看到自己的HTTP工具类设置了全局超时时间为5000ms,普通请求当然没这么久，但是自动更新是下载，肯定不止5秒的，删掉超时设置就可以了。</div></article><article><div class=blog-card><h3><a href=/2014/11/07/android-replace-slash/>android 替换斜杠</a></h3><p><small>November 7, 2014&nbsp;· 21 words&nbsp;· One minute</small><p>问题 最近写安卓的时候服务端返回的数据会带上“\n”，但是在android这边不能换行，初次想到的解决方法是利用
String.replace("\n","\n") 给替换掉，结果是不行的。之前记得java的反斜杠是需要转义的，就用
String.replaceAll("\n","\\n") 试了一下，结果依旧不行。后来去查了谷歌&ndash;，发现要 \\n 才可以 匹配到 \n,这么多斜杠，头都晕了，一个个来解释：
第一个和第二个反斜杠是一组，由于java的转义，实际为 &ldquo;" 第三个和第四个同理， 经过以上两步之后，\\n 实际上是 \n ，由于是正则的关系，\n 可以匹配到字符串的\n了。
解决方法 String.replaceAll("\\n","\\n") 第一个参数是正则，第二个是普通字符串。不得不吐槽下Java的正则表达式。。</div></article><article><div class=blog-card><h3><a href=/2014/11/01/mac-os-x-debug-android-with-eclipse/>mac os x 使用eclipse调试android</a></h3><p><small>November 1, 2014&nbsp;· 22 words&nbsp;· One minute</small><p>这两天心血来潮装了个mac os x 10.10系统，折腾的过程就不说了。
Mac OS X 10.10的环境下，Eclipse+ADT，进行真机调试时，会出现一个问题。
终端下输入 adb devices可以看到小米2S，但是Device Chooser对话框里不显示真机设备，只有重新插拔数据线才可以。
仔细看了下android run configure发现一个问题，默认显示的compatible devices（意思差不多是适配的设备）。
简单说下方法
右键项目>run as>run configurations>target>选中间那个>Active Devices 再次点击run就可以了。</div></article><article><div class=blog-card><h3><a href=/2014/11/01/wordpress-d8-theme-qiniu-cannot-comment/>解决wordpress d8主题使用七牛镜像插件后无法评论的问题</a></h3><p><small>November 1, 2014&nbsp;· 13 words&nbsp;· One minute</small><p>上午有热心的网友给我反映说评论功能出bug了，初步查看是七牛出了问题，利用chrome的开发者工具可以查看请求。 PS：这张图是今天截的，所以域名是正常的，昨天实际上请求的是 static.ddhigh.com (本站的CDN域名)。
查看HTTP请求发现整站就请求了一个jquery文件，但是这个文件比较大有140K，查看源代码发现评论的代码已经合并在里面了。
按照以上步骤可以查看到评论时执行的脚本，当然这里的域名已经修复了。
278行，昨天的是
url:window._deel.url+"/ajax/comment.php" 在控制台输入
console.log(_deel); 域名是CDN域名，所以ajax请求实际上被提交到七牛去了。
修正方法 利用ssh工具连接你的服务器（不是七牛），找到对应的jquery文件278行，改成你的站点域名（如本站的www.ddhigh.com）,更新下缓存即可。</div></article><article><div class=blog-card><h3><a href=/2014/10/31/ucenter-empty/>UCenter 后台应用通知列表空白</a></h3><p><small>October 31, 2014&nbsp;· 7 words&nbsp;· One minute</small><p>今天遇到了一个奇葩的问题UCenter后台通知列表空白并且500，通过xdebug调试发现是**uc_server/control/admin/note.php 第68行代码有问题!**IDE都报错了
原代码 $this->_format_notlist(&$notelist); 修正代码 $this->_format_notlist($notelist); 可能是由于PHP版本升级导致的问题。</div></article><article><div class=blog-card><h3><a href=/2014/10/30/angularjs-html5mode-404/>解决 angularjs html5Mode 404的问题</a></h3><p><small>October 30, 2014&nbsp;· 12 words&nbsp;· One minute</small><p>采用location的html5Mode之后，链接是正常的，但是刷新的时候会404，此时就需要后端服务器配置URL重写了。
nginx 配置 location / { try_files $uri $uri/ /index.html$is_args$args; } 这样子就可以将所有不是文件夹且不是文件的请求转发到index.html。</div></article></div><div class=paginator><a class=prev href=/page/27/>&larr;&nbsp;&nbsp;Pre Page</a>
<a class=next href=/page/29/>Next Page&nbsp;&nbsp;&rarr;</a></div></div></div></div><footer class=footer><p>&copy; 2014 - 2024 <a href=https://www.ddhigh.com/>Lei Xia</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>